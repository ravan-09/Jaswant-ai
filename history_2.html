<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>History Foundation - üòàPULYüåêSTARüòà</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 0;
            background: linear-gradient(45deg, #1a1a3d, #000033);
            color: #e6faff;
            overflow-x: hidden;
            position: relative;
            animation: bgPulse 5s infinite alternate, flicker 0.1s infinite alternate;
            cursor: url('https://www.pngall.com/wp-content/uploads/2016/05/Skull-PNG-Image.png'), auto;
        }
        @keyframes bgPulse {
            0% { background: linear-gradient(45deg, #1a1a3d, #000033); }
            100% { background: linear-gradient(45deg, #000033, #1a1a3d); }
        }
        @keyframes flicker {
            0% { opacity: 1; }
            100% { opacity: 0.95; }
        }
        #login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: url('https://i.ytimg.com/vi_webp/o1kEOHmAZ7Q/sddefault.webp') no-repeat center/cover;
            position: relative;
            z-index: 1;
        }
        #login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }
        #login-box {
            background: linear-gradient(135deg, #1a1a3d, #000033);
            padding: 30px;
            border: 2px solid #00ccff;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 204, 255, 0.7);
            text-align: center;
            width: 300px;
        }
        #login-box h2 {
            color: #00ccff;
            text-transform: uppercase;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-shadow: 0 0 10px #00ccff;
        }
        #login-box input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #000033;
            border: 1px solid #33ff33;
            color: #ffffff;
            font-family: 'Courier New', monospace;
            border-radius: 5px;
        }
        #login-box button {
            padding: 10px 20px;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            transition: transform 0.3s;
            box-shadow: 0 0 10px #33ff33;
        }
        #login-box button:hover {
            transform: scale(1.1);
        }
        #login-error {
            color: #ff3399;
            font-size: 0.9em;
            margin-top: 10px;
            text-shadow: 0 0 5px #ff3399;
        }
        #sound-prompt {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(#1a1a3d, #000033);
            padding: 20px;
            border: 2px solid #00ccff;
            border-radius: 10px;
            box-shadow: 0 0 20px #00ccff;
            z-index: 3000;
            text-align: center;
            color: #e6faff;
            display: none;
        }
        #sound-prompt p {
            color: #ff3399;
            text-shadow: 0 0 5px #ff3399;
        }
        #sound-prompt button {
            padding: 10px 20px;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            box-shadow: 0 0 10px #33ff33;
        }
        #sound-prompt button:hover {
            transform: scale(1.1);
        }
        #loading-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000033;
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        #loading-text {
            font-size: 2em;
            text-transform: uppercase;
            text-align: center;
            animation: pulse 1s infinite;
        }
        #loading-text span {
            text-shadow: 0 0 10px currentColor;
        }
        #loading-text span:nth-child(1) { color: #00ccff; }
        #loading-text span:nth-child(2) { color: #33ff33; }
        #loading-text span:nth-child(3) { color: #ff3399; }
        #loading-text span:nth-child(4) { color: #00ccff; }
        #loading-text span:nth-child(5) { color: #33ff33; }
        #loading-text span:nth-child(6) { color: #ff3399; }
        #loading-text span:nth-child(7) { color: #00ccff; }
        #loading-text span:nth-child(8) { color: #33ff33; }
        #loading-text span:nth-child(9) { color: #ff3399; }
        #loading-text span:nth-child(10) { color: #00ccff; }
        #loading-text span:nth-child(11) { color: #33ff33; }
        #loading-text span:nth-child(12) { color: #ff3399; }
        #loading-text span:nth-child(13) { color: #00ccff; }
        #loading-text span:nth-child(14) { color: #33ff33; }
        #loading-text span:nth-child(15) { color: #ff3399; }
        #loading-text span:nth-child(16) { color: #00ccff; }
        #loading-text span:nth-child(17) { color: #33ff33; }
        #loading-text span:nth-child(18) { color: #ff3399; }
        #loading-text span:nth-child(19) { color: #00ccff; }
        #loading-text span:nth-child(20) { color: #33ff33; }
        #loading-text span:nth-child(21) { color: #ff3399; }
        #loading-text span:nth-child(22) { color: #00ccff; }
        #loading-text span:nth-child(23) { color: #33ff33; }
        #loading-text span:nth-child(24) { color: #ff3399; }
        #loading-text span:nth-child(25) { color: #00ccff; }
        #loading-text span:nth-child(26) { color: #33ff33; }
        #loading-text span:nth-child(27) { color: #ff3399; }
        #loading-text span:nth-child(28) { color: #00ccff; }
        #loading-text span:nth-child(29) { color: #33ff33; }
        #loading-text span:nth-child(30) { color: #ff3399; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        #main-content {
            display: none;
            margin: 20px auto;
            max-width: 800px;
            background: linear-gradient(to bottom, #1a1a3d, #000033);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.7);
            text-align: center;
        }
        .header h1 {
            color: #00ccff;
            cursor: pointer;
            font-size: 2.2em;
            text-shadow: 0 0 15px #00ccff;
            animation: shake 0.3s infinite;
            white-space: nowrap;
        }
        @keyframes shake {
            0% { transform: translate(0, 0); }
            25% { transform: translate(-1px, 1px); }
            50% { transform: translate(1px, -1px); }
            75% { transform: translate(-1px, -1px); }
            100% { transform: translate(1px, 1px); }
        }
        .header h1:hover {
            text-decoration: underline;
        }
        .header h2 {
            color: #ff3399;
            font-size: 1.8em;
            text-shadow: 0 0 5px #ff3399;
        }
        .header img {
            max-width: 100%;
            border: 2px solid #33ff33;
            border-radius: 10px;
            box-shadow: 0 0 10px #33ff33;
        }
        .counts {
            color: #33ff33;
            font-size: 1.2em;
            margin: 10px 0;
            text-shadow: 0 0 10px #33ff33;
        }
        .tabs {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.3s;
            animation: shake 0.3s infinite;
            box-shadow: 0 0 10px #33ff33;
        }
        .tab.active {
            background: linear-gradient(#ff3399, #1a1a3d);
        }
        .tab:hover {
            transform: scale(1.1);
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .video-list .item, .notes-list .item {
            margin: 10px auto;
            padding: 10px;
            background: linear-gradient(135deg, #2a2a4d, #000033);
            border: 1px solid #00ccff;
            border-radius: 5px;
            max-width: 600px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 0 10px rgba(0, 204, 255, 0.3);
        }
        .video-list .item img, .notes-list .item img {
            width: 150px;
            height: 90px;
            border-radius: 5px;
            border: 1px solid #33ff33;
        }
        .video-list .item span, .notes-list .item span {
            font-size: 1.2em;
            color: #e6faff;
        }
        .video-list .item .credit, .notes-list .item .credit {
            font-size: 0.9em;
            color: #ff3399;
        }
        .notes-list .item .file-info {
            font-size: 0.9em;
            color: #33ff33;
        }
        .modal-player {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-player.active {
            display: flex;
        }
        .modal-player .player-content {
            background: linear-gradient(#1a1a3d, #000033);
            padding: 15px;
            border: 2px solid #00ccff;
            border-radius: 8px;
            max-width: 700px;
            width: 90%;
            box-shadow: 0 0 20px #00ccff;
        }
        .modal-player h3 {
            color: #00ccff;
            font-size: 1.5em;
            text-shadow: 0 0 5px #00ccff;
        }
        .modal-player .credit {
            color: #ff3399;
        }
        .modal-player .data-usage {
            color: #33ff33;
            font-size: 0.9em;
        }
        video {
            width: 100%;
            max-width: 600px;
            border: 2px solid #33ff33;
            border-radius: 5px;
        }
        .button-container {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
        }
        .download-btn, .play-btn, .copy-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            box-shadow: 0 0 10px #33ff33;
        }
        .yt-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #00ccff;
            cursor: pointer;
            box-shadow: 0 0 10px #00ccff;
            background: url('https://yt3.googleusercontent.com/BCD6wsUKh9xKG8XPxBO6K7l0W9xpQmXQ7TeI_zPr2n4-2J2wtm03-C8WqNM6l73r8zeBiu4Dtw=s160-c-k-c0x00ffffff-no-rj') center/cover;
        }
        .download-btn:hover, .play-btn:hover, .copy-btn:hover, .yt-btn:hover {
            transform: scale(1.1);
        }
        .quality-selector {
            display: flex;
            gap: 10px;
            padding: 10px;
            justify-content: center;
            overflow-x: auto;
        }
        .quality-option {
            padding: 8px 16px;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 0 10px #33ff33;
        }
        .quality-option:hover {
            transform: scale(1.1);
        }
        .quality-option.active {
            background: linear-gradient(#ff3399, #1a1a3d);
        }
        .loader {
            position: absolute;
            bottom: 5px;
            height: 3px;
            background: #00ccff;
            transition: all 0.3s ease;
        }
        .youtube-logo {
            position: fixed;
            bottom: 15px;
            left: 15px;
            z-index: 100;
            animation: fadeInOut 8s infinite;
        }
        .youtube-logo img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 2px solid #00ccff;
            box-shadow: 0 0 10px #00ccff;
        }
        .youtube-logo img:hover {
            transform: scale(1.1);
        }
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            20%, 80% { opacity: 1; }
        }
        #petals {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99;
        }
        .petal {
            position: absolute;
            width: 20px;
            height: 20px;
            background: url('https://www.pngall.com/wp-content/uploads/2016/04/Rose-Petal-PNG-Clipart.png') no-repeat center;
            background-size: cover;
            opacity: 0.7;
            animation: fall 5s linear;
        }
        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0.7; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        .code-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        .code-snippet {
            position: absolute;
            color: #33ff33;
            font-size: 0.8em;
            opacity: 0;
            animation: flashCode 3s infinite;
        }
        @keyframes flashCode {
            0% { opacity: 0; }
            10% { opacity: 0.9; }
            20% { opacity: 0; }
            100% { opacity: 0; }
        }
        .floating-username {
            position: fixed;
            color: #00ccff;
            font-size: 1.8em;
            text-shadow: 0 0 15px #00ccff;
            z-index: 100;
            font-weight: bold;
            pointer-events: none;
            animation: pulse 1s infinite;
        }
        #real-time-clock {
            position: fixed;
            bottom: 15px;
            right: 15px;
            color: #33ff33;
            font-size: 1em;
            text-shadow: 0 0 10px #33ff33;
            z-index: 100;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }
        #logout-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            background: linear-gradient(#33ff33, #00ccff);
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            z-index: 100;
            box-shadow: 0 0 10px #33ff33;
        }
        #logout-btn:hover {
            transform: scale(1.1);
        }
        .blood-drip {
            position: fixed;
            top: 0;
            width: 10px;
            height: 20px;
            background: #ff3399;
            border-radius: 0 0 5px 5px;
            animation: drip 2s infinite;
            z-index: 10;
        }
        @keyframes drip {
            0% { transform: translateY(-20px); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }
        .alert-message {
            position: fixed;
            color: #00ccff;
            font-size: 1.5em;
            text-shadow: 0 0 10px #00ccff;
            z-index: 100;
            animation: flash 1s infinite;
            pointer-events: none;
        }
        @keyframes flash {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <canvas id="matrix" class="matrix-rain"></canvas>
    <div class="code-overlay" id="code-overlay"></div>
    <div id="sound-prompt">
        <p>Unleash Horror Sounds for Full Experience! ‚ò†Ô∏è</p>
        <button onclick="enableSounds()">Unleash Horror ‚ò†Ô∏è</button>
    </div>
    <div id="login-container">
        <div id="login-box">
            <h2>üåê INFILTRATE KHAN GLOBAL STUDIES üåê</h2>
            <input type="text" id="username" placeholder="Codename üòà" autocomplete="off">
            <input type="password" id="password" placeholder="Access Key üîí" autocomplete="off">
            <button onclick="login()">BREACH SYSTEM ‚ö°</button>
            <div id="login-error"></div>
        </div>
    </div>
    <div id="loading-container">
        <div id="loading-text"></div>
    </div>
    <div id="main-content">
        <div id="petals"></div>
        <div class="floating-username" id="floating-username">Hacker: <span id="user-display"></span> üòàüåê</div>
        <button id="logout-btn" onclick="logout()">LOGOUT üîí</button>
        <div id="real-time-clock"></div>
        <div class="header">
            <h1 onclick="window.open('https://youtube.com/@starpranks09', '_blank')">üåê PULY‚ò†Ô∏èSTAR üåê</h1>
            <h2>üîí KHAN SIR HISTORY CLASSES üîí</h2>
            <div class="counts">
                <span id="video-count">üé•</span> | <span id="notes-count">üìù</span>
            </div>
            <img src="https://i.ytimg.com/vi_webp/o1kEOHmAZ7Q/sddefault.webp" alt="Khan Sir History Classes">
        </div>
        <div class="tabs">
            <div class="tab active" onclick="showSection('videos')">üé¨ Videos</div>
            <div class="tab" onclick="showSection('notes')">üìú Notes</div>
        </div>
        <div id="videos" class="section active">
            <div class="video-list"></div>
        </div>
        <div id="notes" class="section">
            <div class="notes-list"></div>
        </div>
        <div class="modal-player" id="modal-player">
            <div class="player-content">
                <h3 id="modal-player-title">History Lecture üé•</h3>
                <div class="credit">PULY STAR</div>
                <div class="data-usage" id="modal-player-data-usage"></div>
                <video id="modal-video" controls poster="https://i.ytimg.com/vi_webp/o1kEOHmAZ7Q/sddefault.webp"></video>
                <div class="quality-selector" id="quality-selector">
                    <div class="quality-option" data-quality="720">720 ‚ö°</div>
                    <div class="quality-option" data-quality="480">480 üòà</div>
                    <div class="quality-option" data-quality="360">360 üåê</div>
                    <div class="quality-option" data-quality="240">240 üîí</div>
                    <div class="quality-option" data-quality="144">144 üíÄ</div>
                    <div class="loader" id="quality-loader"></div>
                </div>
                <div class="button-container">
                    <button class="yt-btn" onclick="playDefault()"></button>
                    <a class="download-btn" href="#" id="modal-download-btn">DOWNLOAD üì•</a>
                    <button class="play-btn" onclick="playNow()">Play ‚ñ∂Ô∏è</button>
                    <button class="copy-btn" onclick="copyLink()">Copy Link üîó</button>
                </div>
            </div>
        </div>
        <a class="youtube-logo" href="https://youtube.com/@starpranks09" target="_blank">
            <img src="https://yt3.googleusercontent.com/BCD6wsUKh9xKG8XPxBO6K7l0W9xpQmXQ7TeI_zPr2n4-2J2wtm03-C8WqNM6l73r8zeBiu4Dtw=s160-c-k-c0x00ffffff-no-rj" alt="PULY STAR YouTube">
        </a>
    </div>
    <audio id="horror-sound" src="https://freesound.org/data/previews/416/416079_5121236-lq.mp3" preload="auto"></audio>
    <audio id="laugh-sound" src="https://freesound.org/data/previews/411/411087_5121236-lq.mp3" preload="auto"></audio>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        let soundEnabled = false;

        // Sound prompt for autoplay issues
        try {
            const horrorSound = document.getElementById('horror-sound');
            horrorSound.volume = 0.5;
            horrorSound.play().then(() => {
                soundEnabled = true;
            }).catch(e => {
                console.error('Horror sound failed:', e);
                document.getElementById('sound-prompt').style.display = 'block';
            });
        } catch (e) {
            console.error('Horror sound setup failed:', e);
            document.getElementById('sound-prompt').style.display = 'block';
        }

        function enableSounds() {
            try {
                soundEnabled = true;
                document.getElementById('sound-prompt').style.display = 'none';
                horrorSound.play().catch(e => console.error('Horror sound retry failed:', e));
            } catch (e) {
                console.error('Enable sounds failed:', e);
            }
        }

        // Play random laugh
        try {
            const laughSound = document.getElementById('laugh-sound');
            laughSound.volume = 0.3;
            function playRandomLaugh() {
                if (soundEnabled && Math.random() > 0.5) {
                    laughSound.play().catch(e => console.error('Laugh sound failed:', e));
                }
            }
            setInterval(playRandomLaugh, 20000);
        } catch (e) {
            console.error('Laugh sound setup failed:', e);
        }

        // Ensure login container is visible by default
        document.getElementById('login-container').style.display = 'flex';
        document.getElementById('main-content').style.display = 'none';
        document.getElementById('loading-container').style.display = 'none';

        // Matrix rain effect
        try {
            const canvas = document.getElementById('matrix');
            const ctx = canvas.getContext('2d');
            canvas.height = window.innerHeight;
            canvas.width = window.innerWidth;
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()üíÄüòàüî™üåêüîí';
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = [];
            for (let x = 0; x < columns; x++) drops[x] = 1;
            function drawMatrix() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#33ff33';
                ctx.font = fontSize + 'px monospace';
                for (let i = 0; i < drops.length; i++) {
                    const text = chars.charAt(Math.floor(Math.random() * chars.length));
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                    drops[i]++;
                }
            }
            setInterval(drawMatrix, 33);
        } catch (e) {
            console.error('Matrix rain failed:', e);
        }

        // Code overlay effect
        try {
            const codeSnippets = [
                'sudo rm -rf /system üíÄ',
                'nmap -sS 192.168.1.0/24 üòà',
                'curl -X POST http://hack.me ‚ö°',
                'while(true) { fork(); } üî™',
                'openssl enc -aes-256-cbc üåê',
                'whoami > /dev/null üîí'
            ];
            function createCodeSnippets() {
                const overlay = document.getElementById('code-overlay');
                for (let i = 0; i < 8; i++) {
                    const snippet = document.createElement('div');
                    snippet.className = 'code-snippet';
                    snippet.textContent = codeSnippets[Math.floor(Math.random() * codeSnippets.length)];
                    snippet.style.left = Math.random() * 100 + 'vw';
                    snippet.style.top = Math.random() * 100 + 'vh';
                    snippet.style.animationDelay = Math.random() * 2 + 's';
                    snippet.style.color = ['#00ccff', '#33ff33', '#ff3399'][Math.floor(Math.random() * 3)];
                    overlay.appendChild(snippet);
                    setTimeout(() => snippet.remove(), 3000);
                }
            }
            setInterval(createCodeSnippets, 1000);
        } catch (e) {
            console.error('Code snippets failed:', e);
        }

        // Blood drip effect
        try {
            function createBloodDrip() {
                const drip = document.createElement('div');
                drip.className = 'blood-drip';
                drip.style.left = Math.random() * 100 + 'vw';
                document.body.appendChild(drip);
                setTimeout(() => drip.remove(), 2000);
            }
            setInterval(createBloodDrip, 500);
        } catch (e) {
            console.error('Blood drip failed:', e);
        }

        // Random alert messages
        try {
            const alerts = [
                'SYSTEM BREACH DETECTED ‚ö°',
                'FIREWALL COMPROMISED üòà',
                'DATA LEAK IN PROGRESS üåê',
                'HACKER ACTIVITY DETECTED üîí'
            ];
            function showAlert() {
                const alert = document.createElement('div');
                alert.className = 'alert-message';
                alert.textContent = alerts[Math.floor(Math.random() * alerts.length)];
                alert.style.left = Math.random() * 80 + 10 + 'vw';
                alert.style.top = Math.random() * 80 + 10 + 'vh';
                document.body.appendChild(alert);
                setTimeout(() => alert.remove(), 2000);
            }
            setInterval(showAlert, 10000);
        } catch (e) {
            console.error('Alert messages failed:', e);
        }

        // Username roaming animation
        try {
            const usernameElement = document.getElementById('floating-username');
            function moveUsername() {
                const maxX = window.innerWidth - usernameElement.offsetWidth;
                const maxY = window.innerHeight - usernameElement.offsetHeight;
                const newX = Math.random() * maxX;
                const newY = Math.random() * maxY;
                usernameElement.style.transition = 'all 3s ease';
                usernameElement.style.transform = `translate(${newX}px, ${newY}px)`;
            }
            setInterval(moveUsername, 3000);
            moveUsername();
        } catch (e) {
            console.error('Username roaming failed:', e);
        }

        // Real-time clock
        try {
            function updateClock() {
                const now = new Date();
                const time = now.toLocaleTimeString('en-IN', { hour12: false });
                const date = now.toLocaleDateString('en-IN');
                document.getElementById('real-time-clock').textContent = `HACK TIME: ${time} | ${date} üåê`;
            }
            updateClock();
            setInterval(updateClock, 1000);
        } catch (e) {
            console.error('Clock failed:', e);
        }

        // Login and loading system
        let currentUsername = '';
        try {
            if (localStorage.getItem('isLoggedIn') === 'true' && localStorage.getItem('username')) {
                currentUsername = localStorage.getItem('username');
                document.getElementById('user-display').textContent = currentUsername;
                document.getElementById('login-container').style.display = 'none';
                document.getElementById('loading-container').style.display = 'flex';
                const message = 'KHAN SIR HISTORY BATCH ACCESSING PLEASE WAIT ‚ö°';
                const loadingText = document.getElementById('loading-text');
                loadingText.innerHTML = message.split('').map(char => `<span>${char}</span>`).join('');
                setTimeout(() => {
                    document.getElementById('loading-container').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                }, 2000);
            }
        } catch (e) {
            console.error('LocalStorage check failed:', e);
            document.getElementById('login-container').style.display = 'flex';
        }

        function login() {
            try {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const error = document.getElementById('login-error');
                if (password === 'PULY' && username.trim()) {
                    currentUsername = username;
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('username', username);
                    document.getElementById('user-display').textContent = username;
                    document.getElementById('login-container').style.display = 'none';
                    document.getElementById('loading-container').style.display = 'flex';
                    const message = 'KHAN SIR HISTORY BATCH ACCESSING PLEASE WAIT ‚ö°';
                    const loadingText = document.getElementById('loading-text');
                    loadingText.innerHTML = message.split('').map(char => `<span>${char}</span>`).join('');
                    // Speak username only if sound enabled
                    if (soundEnabled) {
                        try {
                            const utterance = new SpeechSynthesisUtterance(`Intruder Detected, ${username}!`);
                            utterance.rate = 0.7;
                            utterance.pitch = 0.4;
                            utterance.volume = 0.7;
                            speechSynthesis.speak(utterance);
                        } catch (e) {
                            console.error('Speech failed:', e);
                            alert(`INTRUDER DETECTED: ${username} ‚ò†Ô∏è`);
                        }
                    } else {
                        alert(`INTRUDER DETECTED: ${username} ‚ò†Ô∏è`);
                    }
                    // Flicker effect
                    document.body.style.animation = 'flicker 0.1s 5';
                    setTimeout(() => {
                        document.getElementById('loading-container').style.display = 'none';
                        document.getElementById('main-content').style.display = 'block';
                        document.body.style.animation = 'bgPulse 5s infinite alternate, flicker 0.1s infinite alternate';
                    }, 2000);
                } else {
                    error.textContent = 'SYSTEM LOCKOUT: Invalid credentials üòà';
                }
            } catch (e) {
                console.error('Login failed:', e);
                document.getElementById('login-error').textContent = 'ERROR: System failure, try again ‚ö†Ô∏è';
            }
        }

        function logout() {
            try {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('username');
                location.reload();
            } catch (e) {
                console.error('Logout failed:', e);
            }
        }

        // Video and notes data
        const videoCount = 126;
        const pdfLinks = {
            1: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-1/history-test-01.pdf', title: 'History Test 01 üìù', date: '' },
            2: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-2/ancient-history01.pdf', title: 'Ancient History 01 üèõÔ∏è', date: '' },
            3: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-3/baudh-and-jain-dharm.pdf', title: 'Baudh and Jain dharm ‚ò∏Ô∏è', date: '' },
            4: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-4/indian-religion-mahajanpad-morya-vansh.pdf', title: 'Indian Religion+Mahajanpad+Morya Vansh üïâÔ∏è', date: '' },
            5: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-5/ispk.pdf', title: '‡§Æ‡•ã‡§∞‡•ç‡§Ø‡•ã‡§§‡•ç‡§§‡§∞ ‡§ï‡§æ‡§≤ (ISPK) üè∫', date: '' },
            6: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-6/mauryotar-kal.pdf', title: 'Mauryotar kal ‚öîÔ∏è', date: '' },
            7: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-7/sangam-kal.pdf', title: 'Sangam Kal üìú', date: '' },
            8: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-8/dakshin-bharat-khan-sir-history.pdf', title: 'Dakshin Bharat Khan Sir History üó∫Ô∏è', date: '' },
            9: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-9/medieval-history.pdf', title: 'Medieval History üè∞', date: '' },
            10: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-10/vijay-nagar-bkhakti-kaal-mughal.pdf', title: 'Vijay Nagar+Bkhakti kaal+Mughal üïå', date: '' },
            11: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-11/medievle-history-test.pdf', title: 'Medievle History Test üìù', date: '' },
            12: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-12/maratha-samrajya.pdf', title: 'Maratha Samrajya ‚öîÔ∏è', date: '' },
            13: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-13/major-small-states.pdf', title: '‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§õ‡•ã‡§ü‡•á ‡§∞‡§æ‡§ú‡•ç‡§Ø üè∞', date: '' },
            14: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-14/revolution-of-1857.pdf', title: 'Revolution of 1857 üí•', date: '' },
            15: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-15/1857-ki-kranti-2.pdf', title: '1857 ki kranti (2) üî´', date: '' },
            16: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-16/bhartiya-rashtriya-congress.pdf', title: 'Bhartiya Rashtriya Congress üáÆüá≥', date: '' },
            17: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-17/social-reform-organisation.pdf', title: 'Social Reform Organisation üåç', date: '' },
            18: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-18/gandhi-era.pdf', title: '‡§ó‡§æ‡§Ç‡§ß‡•Ä ‡§Ø‡•Å‡§ó ‚úä', date: '' },
            19: { url: 'https://kgs-v1.akamaized.net/kgs-test/Notes/history-recorded/note-19/crisp-prastav.pdf', title: 'Crisp Prastav üìú', date: '' },
            20: { url: 'https://kgs-v2.akamaized.net/kgs-test/Notes/history-recorded/note-20/delhi-darbar.pdf', title: 'Delhi Darbar üëë', date: '' },
            21: { url: 'https://kgs-v2.akamaized.net/kgs/do/pdfs/96d0b883-fade-44c7-93ce-0db05cd5c3fa.pdf', title: 'History Complete Notes üìö', date: '04 Jul 2024' },
            22: { url: 'https://kgs.nyc3.digitaloceanspaces.com/pdfs/a453294c-4ccf-4922-9f25-f2c906ed9fb7.pdf', title: 'Indian Congress Session üáÆüá≥', date: '19 Dec 2024' },
            23: { url: 'https://kgs.nyc3.digitaloceanspaces.com/pdfs/12833f76-1af1-4c4d-b6e3-de213573139c.pdf', title: 'Modern History Full Notes üï∞Ô∏è', date: '06 Jan 2025' }
        };
        const notesCount = Object.keys(pdfLinks).length;

        // Update counts display
        try {
            document.getElementById('video-count').textContent = `üé• Total Videos: ${videoCount}`;
            document.getElementById('notes-count').textContent = `üìù Total Notes: ${notesCount}`;
        } catch (e) {
            console.error('Counts display failed:', e);
        }

        // Video and notes setup
        const videoList = document.querySelector('.video-list');
        const notesList = document.querySelector('.notes-list');
        const modalPlayer = document.getElementById('modal-player');
        const modalVideo = document.getElementById('modal-video');
        const modalPlayerTitle = document.getElementById('modal-player-title');
        const modalPlayerDataUsage = document.getElementById('modal-player-data-usage');
        const qualitySelector = document.getElementById('quality-selector');
        const qualityLoader = document.getElementById('quality-loader');
        const modalDownloadBtn = document.getElementById('modal-download-btn');
        const petalsContainer = document.getElementById('petals');

        let currentLecture = null;
        let selectedQuality = null;
        let isDragging = false;
        let startX = 0;

        const videoDataUsage = {
            '720': { perMin: 1.125, total: 1.125 * 40, label: 'Ultra ‚ö°' },
            '480': { perMin: 0.675, total: 0.675 * 40, label: 'High üòà' },
            '360': { perMin: 0.3375, total: 0.3375 * 40, label: 'Medium üåê' },
            '240': { perMin: 0.18, total: 0.18 * 40, label: 'Low üîí' },
            '144': { perMin: 0.09, total: 0.09 * 40, label: 'Minimal üíÄ' }
        };
        const videoDuration = 40;

        async function fetchPdfSize(url, lecture) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                if (response.ok) {
                    const size = response.headers.get('content-length');
                    pdfSizes[lecture] = size ? (size / (1024 * 1024)).toFixed(2) : 5;
                } else {
                    pdfSizes[lecture] = 5;
                }
                const noteItem = document.querySelector(`.notes-list .item[data-lecture="${lecture}"]`);
                if (noteItem) {
                    const date = pdfLinks[lecture].date ? `, ${pdfLinks[lecture].date}` : '';
                    noteItem.querySelector('.file-info').textContent = `Size: ~${pdfSizes[lecture]} MB${date} üìè`;
                }
            } catch (e) {
                console.error(`PDF size fetch failed for lecture ${lecture}:`, e);
            }
        }

        function createPetals() {
            try {
                for (let i = 0; i < 10; i++) {
                    const petal = document.createElement('div');
                    petal.className = 'petal';
                    petal.style.left = Math.random() * 100 + 'vw';
                    petal.style.animationDelay = Math.random() * 2 + 's';
                    petalsContainer.appendChild(petal);
                }
                const petals = document.querySelectorAll('.petal');
                petals.forEach(petal => petal.style.display = 'block');
                setTimeout(() => petals.forEach(petal => petal.remove()), 3000);
            } catch (e) {
                console.error('Petals failed:', e);
            }
        }
        setInterval(createPetals, 10000);

        const pdfSizes = {};
        try {
            for (let i = 1; i <= videoCount; i++) {
                const videoItem = document.createElement('div');
                videoItem.className = 'item';
                videoItem.dataset.lecture = i;
                videoItem.innerHTML = `
                    <img src="https://i.ytimg.com/vi_webp/o1kEOHmAZ7Q/sddefault.webp" alt="Lecture-${i}">
                    <div class="content">
                        <span>History Lecture-${i} üé•</span>
                        <div class="credit">PULY STAR</div>
                    </div>
                `;
                videoItem.onclick = function() {
                    currentLecture = i;
                    modalPlayerTitle.textContent = `History Lecture-${i} üé•`;
                    modalPlayerDataUsage.textContent = `Duration: ~${videoDuration} min, Data: ~${videoDataUsage['720'].total.toFixed(2)} MB (Ultra 720 ‚ö°)`;
                    selectedQuality = null;
                    loadVideo(getDefaultM3u8Url(i));
                    modalPlayer.classList.add('active');
                    moveLoaderToQuality('720');
                };
                videoList.appendChild(videoItem);

                if (pdfLinks[i]) {
                    const noteItem = document.createElement('div');
                    noteItem.className = 'item';
                    noteItem.dataset.lecture = i;
                    const date = pdfLinks[i].date ? `, ${pdfLinks[i].date}` : '';
                    noteItem.innerHTML = `
                        <img src="https://i.ytimg.com/vi_webp/o1kEOHmAZ7Q/sddefault.webp" alt="${pdfLinks[i].title}">
                        <div class="content">
                            <span>${pdfLinks[i].title}</span>
                            <div class="credit">PULY STAR</div>
                            <div class="file-info">Size: ~${pdfSizes[i] || 5} MB${date} üìè</div>
                        </div>
                    `;
                    noteItem.onclick = function() {
                        window.open(pdfLinks[i].url, '_blank');
                    };
                    notesList.appendChild(noteItem);
                    fetchPdfSize(pdfLinks[i].url, i);
                }
            }
        } catch (e) {
            console.error('Video/notes setup failed:', e);
        }

        try {
            qualitySelector.addEventListener('mousedown', startDrag);
            qualitySelector.addEventListener('touchstart', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
        } catch (e) {
            console.error('Quality selector events failed:', e);
        }

        function startDrag(e) {
            isDragging = true;
            startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            const x = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
            const delta = x - startX;
            qualitySelector.scrollLeft -= delta;
            startX = x;
            updateLoaderPosition();
        }

        function endDrag() {
            isDragging = false;
        }

        try {
            document.querySelectorAll('.quality-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectedQuality = this.dataset.quality;
                    document.querySelectorAll('.quality-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    moveLoaderToQuality(selectedQuality);
                    if (currentLecture) {
                        loadVideo(getM3u8Url(currentLecture, selectedQuality));
                        modalPlayerDataUsage.textContent = `Duration: ~${videoDuration} min, Data: ~${videoDataUsage[selectedQuality].total.toFixed(2)} MB (${videoDataUsage[selectedQuality].label})`;
                    }
                });
            });
        } catch (e) {
            console.error('Quality option listeners failed:', e);
        }

        function updateLoaderPosition() {
            try {
                const activeOption = document.querySelector('.quality-option.active') || document.querySelector('.quality-option[data-quality="720"]');
                moveLoaderToQuality(activeOption.dataset.quality);
            } catch (e) {
                console.error('Update loader position failed:', e);
            }
        }

        function moveLoaderToQuality(quality) {
            try {
                const option = document.querySelector(`.quality-option[data-quality="${quality}"]`);
                if (option) {
                    const rect = option.getBoundingClientRect();
                    const parentRect = qualitySelector.getBoundingClientRect();
                    qualityLoader.style.width = `${rect.width}px`;
                    qualityLoader.style.left = `${rect.left - parentRect.left + qualitySelector.scrollLeft}px`;
                }
            } catch (e) {
                console.error('Move loader failed:', e);
            }
        }

        function playDefault() {
            try {
                if (currentLecture) {
                    selectedQuality = null;
                    loadVideo(getDefaultM3u8Url(currentLecture));
                    modalPlayerDataUsage.textContent = `Duration: ~${videoDuration} min, Data: ~${videoDataUsage['720'].total.toFixed(2)} MB (Ultra 720 ‚ö°)`;
                    document.querySelectorAll('.quality-option').forEach(opt => opt.classList.remove('active'));
                    document.querySelector('.quality-option[data-quality="720"]').classList.add('active');
                    moveLoaderToQuality('720');
                }
            } catch (e) {
                console.error('Play default failed:', e);
            }
        }

        modalDownloadBtn.onclick = function() {
            try {
                if (!currentLecture) return false;
                const quality = selectedQuality || '720';
                const m3u8Url = selectedQuality ? getM3u8Url(currentLecture, quality) : getDefaultM3u8Url(currentLecture);
                try {
                    window.location.href = `intent://${m3u8Url}#Intent;package=idm.internet.download.manager;scheme=https;end`;
                } catch (e) {
                    navigator.clipboard.writeText(m3u8Url).then(() => {
                        alert(`"History Lecture-${currentLecture}" ‡§ï‡§æ ${quality} ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ! üìã\n‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ó‡§æ‡§á‡§°:\n1. 1DM ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç: https://play.google.com/store/apps/details?id=idm.internet.download.manager\n2. 1DM ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§Ç‡§ï ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§\n3. VLC ‡§Æ‡•á‡§Ç ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‚Üí "Convert/Save" ‚Üí MP4 ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç‡•§\n4. ffmpeg: ffmpeg -i "${m3u8Url}" -c copy "History Lecture-${currentLecture}.mp4"\n‡§ï‡•ç‡§µ‡§æ‡§≤‡§ø‡§ü‡•Ä: ${quality} (~${videoDataUsage[quality].total.toFixed(2)} MB) üåê`);
                    });
                }
                return false;
            } catch (e) {
                console.error('Download button failed:', e);
                return false;
            }
        };

        function copyLink() {
            try {
                if (!currentLecture) {
                    alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§è‡§ï ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡•Å‡§®‡•á‡§Ç! ‚ö†Ô∏è');
                    return;
                }
                const quality = selectedQuality || '720';
                const m3u8Url = selectedQuality ? getM3u8Url(currentLecture, quality) : getDefaultM3u8Url(currentLecture);
                window.open(m3u8Url, '_blank');
                alert(`"History Lecture-${currentLecture}" (${quality}) ‡§≤‡§ø‡§Ç‡§ï ‡§®‡§Ø‡•á ‡§ü‡•à‡§¨ ‡§Æ‡•á‡§Ç ‡§ñ‡•Å‡§≤ ‡§ó‡§Ø‡§æ! üåê (~${videoDataUsage[quality].total.toFixed(2)} MB)`);
            } catch (e) {
                console.error('Copy link failed:', e);
                alert('‡§≤‡§ø‡§Ç‡§ï ‡§ñ‡•ã‡§≤‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§ üö´');
            }
        }

        function playNow() {
            try {
                if (currentLecture) {
                    const quality = selectedQuality || '720';
                    const m3u8Url = selectedQuality ? getM3u8Url(currentLecture, quality) : getDefaultM3u8Url(currentLecture);
                    loadVideo(m3u8Url);
                    modalPlayerDataUsage.textContent = `Duration: ~${videoDuration} min, Data: ~${videoDataUsage[quality].total.toFixed(2)} MB (${videoDataUsage[quality].label})`;
                    modalVideo.play().catch(e => console.error(`Video playback failed: ${e.message}`));
                }
            } catch (e) {
                console.error('Play now failed:', e);
            }
        }

        function showSection(section) {
            try {
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.querySelector(`#${section}`).classList.add('active');
                document.querySelector(`.tab[onclick="showSection('${section}')"]`).classList.add('active');
                modalPlayer.classList.remove('active');
                currentLecture = null;
                selectedQuality = null;
                modalPlayerDataUsage.textContent = '';
            } catch (e) {
                console.error('Show section failed:', e);
            }
        }

        function getDefaultM3u8Url(lectureNumber) {
            return `https://kgs-v2.akamaized.net/kgs-test/history-foundation/l${lectureNumber}/l${lectureNumber}.m3u8`;
        }

        function getM3u8Url(lectureNumber, quality) {
            return `https://kgs-v2.akamaized.net/kgs-test/history-foundation/l${lectureNumber}/${quality}.m3u8`;
        }

        function loadVideo(m3u8Url) {
            try {
                if (Hls.isSupported()) {
                    const hls = new Hls({
                        enableWorker: true,
                        lowLatencyMode: true,
                        backBufferLength: 90
                    });
                    hls.loadSource(m3u8Url);
                    hls.attachMedia(modalVideo);
                    hls.on(Hls.Events.MANIFEST_PARSED, () => console.log('HLS manifest loaded'));
                    hls.on(Hls.Events.ERROR, (event, data) => {
                        console.error(`HLS error: ${data.type} - ${data.details}`);
                        if (data.fatal) {
                            switch (data.type) {
                                case Hls.ErrorTypes.NETWORK_ERROR:
                                    hls.startLoad();
                                    break;
                                case Hls.ErrorTypes.MEDIA_ERROR:
                                    hls.recoverMediaError();
                                    break;
                                default:
                                    alert('CRITICAL SYSTEM FAILURE: Video stream corrupted üåê');
                                    break;
                            }
                        }
                    });
                } else if (modalVideo.canPlayType('application/vnd.apple.mpegurl')) {
                    modalVideo.src = m3u8Url;
                    modalVideo.addEventListener('error', () => {
                        console.error('Native HLS error');
                        alert('CRITICAL SYSTEM FAILURE: Video stream corrupted üåê');
                    });
                } else {
                    console.error('HLS not supported');
                    alert('CRITICAL SYSTEM FAILURE: Video stream corrupted üåê');
                }
            } catch (e) {
                console.error('Load video failed:', e);
                alert('ERROR: Video loading failed ‚ö†Ô∏è');
            }
        }

        try {
            modalVideo.addEventListener('play', function() {
                if (currentLecture) {
                    const m3u8Url = selectedQuality ? getM3u8Url(currentLecture, selectedQuality) : getDefaultM3u8Url(currentLecture);
                    loadVideo(m3u8Url);
                }
            }, { once: true });

            modalPlayer.addEventListener('click', function(e) {
                if (e.target === modalPlayer) {
                    modalPlayer.classList.remove('active');
                    modalVideo.pause();
                }
            });
        } catch (e) {
            console.error('Modal video/player events failed:', e);
        }
    </script>
</body>
</html>
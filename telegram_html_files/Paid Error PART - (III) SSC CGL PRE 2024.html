<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Test</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5; /* Improved indigo */
            --secondary-color: #4338ca;
            --success-color: #16a34a; /* Brighter green for better contrast */
            --danger-color: #dc2626;
            --warning-color: #0369a1;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-color: #1e293b;
            --bg-color: #ffffff;
            --muted-text: #64748b;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
        }

        /* Add custom scrollbar styling */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Add responsive styles for mobile */
        @media screen and (max-width: 768px) {
            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                top: auto;
                z-index: 1000;
                max-height: 50vh;
                margin: 0;
                border-radius: 16px 16px 0 0;
            }

            .palette-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 10px;
            }

            .palette-item {
                width: 100%;
                height: 36px;
            }
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--light-bg);
        }

        /* Custom scrollbar for webkit browsers */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        .question-palette:hover {
            box-shadow: var(--shadow-lg);
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .palette-item.active::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid currentColor;
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.5; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--border-color), transparent);
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-color), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }
        
        .question-container {
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            background-color: var(--bg-color);
            box-shadow: var(--shadow-md);
            min-height: 500px;
            display: flex;
            flex-direction: column;
        }

        .question-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }
        
        .question-number {
            font-size: 14px;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-color);
            font-weight: 500;
            animation: fadeIn 0.5s ease;
        }
        
        .options {
            flex-grow: 1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .option {
            display: block;
            margin: 12px 0;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            color: var(--text-color);
            background-color: var(--bg-color);
            font-size: 14px;
            font-weight: 400;
            user-select: none; /* Prevent text selection */
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: rgba(79, 70, 229, 0.05);
            transition: width 0.3s ease;
            z-index: 0;
        }
        
        .option:hover::before {
            width: 100%;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            transform: translateX(8px);
        }
        
        .option:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .option.selected {
            background-color: rgba(79, 70, 229, 0.15);
            border-color: var(--primary-color);
            transform: translateX(10px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        .option.selected::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background-color: var(--primary-color);
            border-radius: 4px 0 0 4px;
        }
        
        .option-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            /* Added flex-wrap for better text handling */
            flex-wrap: wrap;
            width: 100%;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 35px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            position: sticky;
            bottom: 20px;
            background-color: var(--bg-color);
            padding-bottom: 10px;
            z-index: 5;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 22px;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            min-width: 100px;
            letter-spacing: 0.3px;
            background-color: var(--primary-color);
            outline: none;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
            z-index: 0;
        }

        button:hover::before {
            width: 150%;
            height: 150%;
        }

        button:active::before {
            background: rgba(0, 0, 0, 0.1);
            width: 150%;
            height: 150%;
        }
        
        button:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.25);
            filter: brightness(var(--button-hover-brightness));
        }
        
        button:active {
            transform: translateY(-2px);
            transition: all 0.1s;
        }

        button i {
            font-size: 18px;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 1;
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button:hover i {
            transform: scale(1.2);
        }

        button:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        button:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
            box-shadow: none;
        }

        button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        button:disabled::before {
            display: none;
        }

        #bookmark-btn {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            font-weight: 500;
            transition: all 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover {
            border-color: #eab308;
            color: #eab308;
            background-color: rgba(234, 179, 8, 0.08);
        }

        #bookmark-btn.active {
            background-color: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 600;
        }

        #bookmark-btn.active:hover {
            background-color: #ca8a04;
            color: #1e293b;
        }

        #bookmark-btn i {
            transition: transform 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover i {
            transform: translateY(-2px);
        }
        
        #submit-test {
            background-color: var(--success-color);
            font-weight: 600;
            min-width: 140px;
        }
        
        #submit-test:hover {
            box-shadow: 0 6px 15px rgba(22, 163, 74, 0.25);
        }
        
        #prev-btn, #next-btn {
            background-color: var(--primary-color);
            min-width: 130px;
        }
        
        #timer {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: rgba(79, 70, 229, 0.08);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .timer-warning {
            color: var(--danger-color);
            animation: pulse 1.5s infinite;
            background: rgba(220, 38, 38, 0.1);
            border-color: var(--danger-color);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        #result {
            display: none;
            color: var(--text-color);
        }
        
        #score {
            font-size: 32px;
            text-align: center;
            margin: 35px 0;
            padding: 30px;
            background: linear-gradient(to right, rgba(79, 70, 229, 0.08), rgba(139, 92, 246, 0.08));
            border-radius: 12px;
            line-height: 1.6;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.8s var(--animation-bounce);
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #score::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(79, 70, 229, 0.1), transparent 60%);
            z-index: 0;
        }

        #score div {
            position: relative;
            z-index: 1;
        }

        .score-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .score-card {
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--chart-color-1), var(--chart-color-3));
            transition: height 0.3s ease;
        }

        .score-card:hover::before {
            height: 6px;
        }

        .score-card:nth-child(2)::before {
            background: linear-gradient(to right, var(--chart-color-2), var(--chart-color-4));
        }

        .score-card:nth-child(3)::before {
            background: linear-gradient(to right, var(--chart-color-3), var(--chart-color-5));
        }

        .score-card:nth-child(4)::before {
            background: linear-gradient(to right, var(--chart-color-4), var(--chart-color-1));
        }

        .score-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .score-card h3 {
            margin: 0 0 16px 0;
            color: var(--text-color);
            font-size: 14px;
            font-weight: 600;
            line-height: 1.4;
            max-width: 100%;
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        .score-card div {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, var(--chart-color-1), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            line-height: 1.2;
            margin: 0;
            padding: 0;
        }

        .score-card:hover div {
            transform: scale(1.1);
        }

        .score-card:nth-child(2) div {
            background: linear-gradient(45deg, var(--chart-color-2), var(--chart-color-4));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(3) div {
            background: linear-gradient(45deg, var(--chart-color-3), var(--chart-color-5));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(4) div {
            background: linear-gradient(45deg, var(--chart-color-4), var(--chart-color-1));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .chart-container {
            height: 350px;
            margin: 25px 0;
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            animation: fadeScale 1s ease;
            position: relative;
        }

        @keyframes fadeScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(79, 70, 229, 0.03), transparent 70%);
            z-index: 0;
            border-radius: 12px;
        }

        .shortcut-hint {
            font-size: 12px;
            color: var(--muted-text);
            font-weight: normal;
        }

        .keyboard-shortcuts {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .keyboard-shortcuts span {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            padding: 3px 6px;
            border-radius: 6px;
            font-size: 11px;
            color: var(--muted-text);
            cursor: help;
            font-weight: 500;
        }

        .keyboard-shortcuts span:hover {
            background: var(--border-color);
            color: var(--text-color);
        }

        .option-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 26px;
            height: 26px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .option:hover .option-number {
            transform: scale(1.1);
        }

        .option.selected .option-number {
            background: var(--success-color);
            box-shadow: 0 0 10px rgba(22, 163, 74, 0.4);
        }

        .palette-toggle-btn {
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(79, 70, 229, 0.25);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            padding: 0;
            min-width: unset;
        }

        .palette-toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.2), transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .palette-toggle-btn:hover::before {
            opacity: 1;
        }

        .palette-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(79, 70, 229, 0.4);
        }

        .palette-toggle-btn:active {
            transform: scale(0.95);
        }

        .palette-toggle-btn.active {
            transform: rotate(45deg);
        }

        .palette-toggle-btn i {
            position: relative;
            z-index: 1;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .palette-toggle-btn:hover i {
            transform: rotate(-15deg);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 13px;
            }

            .container {
                padding: 15px;
                border-radius: 10px;
            }

            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: 0;
                z-index: 1000;
                border-radius: 0;
                overflow-y: auto;
                transform: translateX(100%);
                transition: transform 0.3s var(--animation-bounce);
                padding: 20px;
            }

            .question-palette.visible {
                transform: translateX(0);
            }

            .palette-toggle-btn {
                width: 48px;
                height: 48px;
                bottom: 16px;
                right: 16px;
                font-size: 18px;
            }

            .palette-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .palette-close-btn {
                background: transparent;
                border: none;
                color: var(--text-color);
                font-size: 20px;
                cursor: pointer;
                min-width: auto;
                padding: 10px;
                box-shadow: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
            }

            .palette-close-btn:hover {
                color: var(--primary-color);
                background: rgba(79, 70, 229, 0.1);
            }

            .score-details {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
                gap: 12px;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
                position: sticky;
                bottom: 10px;
                padding-bottom: 5px;
            }
            
            .question-container {
                min-height: 400px;
            }

            .bookmark-btn {
                width: 100%;
                justify-content: center;
            }

            button {
                width: 100%;
                justify-content: center;
                padding: 14px 20px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding-bottom: 12px;
            }

            .header-controls {
                width: 100%;
                justify-content: center;
            }

            .theme-toggle {
                width: 40px;
                height: 40px;
                padding: 10px;
            }

            .keyboard-shortcuts {
                display: none;
            }

            #timer {
                padding: 8px 14px;
                font-size: 13px;
                width: 100%;
                justify-content: center;
            }

            .question {
                font-size: 15px;
            }

            .option {
                padding: 14px;
                margin: 10px 0;
                word-break: break-word; /* Added to prevent text overflow */
            }

            .option:hover {
                transform: translateX(4px);
            }

            .option.selected {
                transform: translateX(8px);
            }

            /* Fix for mobile devices where hover states persist */
            @media (hover: none) {
                button:hover, .option:hover, .score-card:hover, .answer-review:hover {
                    transform: none;
                }

                button:active, .option:active {
                    transform: scale(0.98);
                }
            }

            /* Enhance readability on mobile */
            #score {
                font-size: 24px;
                padding: 20px;
            }

            .chart-container {
                height: 300px;
            }

            .custom-chart-legend {
                flex-direction: column;
                align-items: flex-start;
                padding-left: 20px;
            }

            /* Prevent mobile zoom when tapping buttons/options */
            button, .option, input, select {
                font-size: 16px;
            }

            .palette-filters {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 10px;
                justify-content: center;
                -webkit-overflow-scrolling: touch;
                gap: 8px;
            }
            
            .filter-btn {
                font-size: 11px;
                padding: 5px 10px;
                white-space: nowrap;
                flex-shrink: 0; /* Prevent filters from shrinking */
            }
            
            /* Fix download button on mobile */
            .download-btn {
                width: 100%;
                min-width: 100%;
                margin-top: 15px;
                padding: 14px 10px;
                white-space: normal; /* Allow text to wrap */
            }
            
            /* Option text can wrap now */
            .option-content {
                flex-wrap: wrap;
                width: 100%;
            }
            
            /* Ensure option number doesn't shrink */
            .option-number {
                flex-shrink: 0;
                margin-bottom: 5px;
            }
        }

        .answer-review {
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 15px;
            background: var(--bg-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .answer-review:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(79, 70, 229, 0.1);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .explanation strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        .explanation p {
            margin: 8px 0;
            line-height: 1.6;
            color: var(--text-color);
        }

        [data-theme="dark"] .explanation {
            background: rgba(99, 102, 241, 0.1);
        }

        .correct {
            color: var(--success-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(22, 163, 74, 0.1);
            transition: all 0.3s ease;
        }

        .correct:hover {
            background-color: rgba(22, 163, 74, 0.15);
        }

        .incorrect {
            color: var(--danger-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(220, 38, 38, 0.1);
            transition: all 0.3s ease;
        }

        .incorrect:hover {
            background-color: rgba(220, 38, 38, 0.15);
        }

        .marks-info {
                font-size: 12px;
            color: var(--muted-text);
            font-style: normal;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 10px;
            background-color: rgba(100, 116, 139, 0.08);
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .marks-info:hover {
            background-color: rgba(100, 116, 139, 0.12);
        }

        .question-number {
            font-weight: 600;
            color: var(--text-color);
            font-size: 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border-color);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            min-width: unset;
            width: 38px;
            height: 38px;
        }

        .theme-toggle:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.08);
            transform: rotate(180deg);
        }

        .review-warning {
            background-color: rgba(220, 38, 38, 0.08);
            border: 1px solid var(--danger-color);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-color);
            box-shadow: var(--shadow-md);
            animation: slideDown 0.5s var(--animation-bounce);
        }

        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .review-warning i {
            color: var(--danger-color);
            font-size: 28px;
            animation: shake 1s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        #review-list {
            margin-top: 25px;
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .review-item:hover {
            background: rgba(79, 70, 229, 0.05);
            transform: translateX(5px);
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .analytics-container {
            margin-top: 35px;
            padding: 25px;
            border-radius: 12px;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .analytics-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .analytics-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .analytics-container h3 i {
            font-size: 20px;
            color: var(--chart-color-1);
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .keyboard-pressed {
            transform: scale(0.95) translateY(0) !important;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1) !important;
            opacity: 0.9;
            transition: all 0.1s ease !important;
        }
        
        .keyboard-selected {
            background-color: rgba(79, 70, 229, 0.15);
            transform: translateX(5px);
            transition: all 0.1s ease;
        }
        
        @keyframes buttonPulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .review-warning {
            animation: none;
            transition: all 0.3s var(--animation-bounce);
        }
        
        .fade-out {
            opacity: 0 !important;
            transform: translateY(-10px) !important;
        }
        
        .review-warning button {
            flex: 1;
            min-width: 120px;
        }
        
        @media (max-width: 768px) {
            .review-warning {
                flex-direction: column;
                padding: 20px;
            }
            
            .review-warning i {
                margin-bottom: 10px;
                align-self: center;
            }
        }

        .custom-chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 24px;
            flex-wrap: wrap;
            padding: 0 16px;
        }

        .chart-legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            display: inline-block;
            flex-shrink: 0;
        }

        .legend-text {
            color: var(--text-color);
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .score-card {
                padding: 20px;
                min-height: 100px;
            }

            .score-card h3 {
                font-size: 13px;
                margin-bottom: 12px;
            }

            .score-card div {
                font-size: 24px;
            }

            .custom-chart-legend {
                gap: 12px;
                margin-top: 20px;
                padding: 0 12px;
            }

            .chart-legend-item {
                font-size: 12px;
            }

            .legend-color {
                width: 10px;
                height: 10px;
                margin-right: 6px;
            }
        }

        /* Add new styles for creator info */
        .creator-info {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            border-radius: 12px;
            margin-bottom: 20px;
            gap: 15px;
            border: 1px solid var(--border-color);
        }

        .creator-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .creator-logo:hover {
            transform: scale(1.1);
        }

        .creator-tg {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .creator-tg:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .creator-tg i {
            color: #229ED9;
            font-size: 20px;
        }

        [data-theme="dark"] .creator-info {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(34, 197, 94, 0.1) 100%);
        }

        .download-btn {
            background: linear-gradient(145deg, var(--chart-color-1), var(--chart-color-3));
            margin-top: 20px;
            width: auto;
            padding: 12px 24px;
            transition: all 0.3s var(--animation-bounce);
            box-shadow: var(--shadow-md);
            font-weight: 600;
            letter-spacing: 0.5px;
            min-width: 200px;
            color: white;
            /* Ensure text doesn't overflow */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .download-btn:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .download-btn i {
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="creator-info">
        <a href="https://t.me/finallygotnirvana" target="_blank" class="creator-tg">
            <i class="fab fa-telegram"></i>
            Created by @finallygotnirvana
        </a>
        <img src="https://i.ibb.co/0ysnvFZS/0x1900-000000-80-0-0.jpg" alt="Creator Logo" class="creator-logo">
    </div>

    <div class="test-layout">
        <div id="test-container" class="container">
            <div class="header">
                <h1 id="test-title">Mock Test</h1>
                <div class="header-controls">
                    <div id="timer"><i class="fas fa-clock"></i> Time Remaining: 00:00</div>
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <div id="current-question"></div>
            
            <div class="navigation">
                <div class="nav-buttons">
                    <button id="prev-btn" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                    <button id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button id="submit-test" style="display: none;"><i class="fas fa-check"></i> Submit Test</button>
                </div>
                <button id="bookmark-btn">
                    <i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>
                </button>
            </div>
        </div>

        <div class="question-palette container">
            <div class="palette-header">
                <h3>Question Palette</h3>
            </div>
            <div class="palette-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="answered">Answered</button>
                <button class="filter-btn" data-filter="not-answered">Not Answered</button>
                <button class="filter-btn" data-filter="marked-review">Marked for Review</button>
            </div>
            <div class="palette-grid" id="question-palette"></div>
        </div>
    </div>

    <button class="palette-toggle-btn" id="palette-toggle">
        <i class="fas fa-th"></i>
    </button>

            <div id="result" class="container">
            <div id="score"></div>
            <div class="score-details">
                <div class="score-card">
                    <h3>Total Questions</h3>
                    <div id="total-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Attempted</h3>
                    <div id="attempted-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Correct</h3>
                    <div id="correct-answers">0</div>
                </div>
                <div class="score-card">
                    <h3>Accuracy</h3>
                    <div id="accuracy">0%</div>
                </div>
            </div>
            <div class="analytics-container">
                <h3>Performance Analysis</h3>
                <div class="chart-container" id="performance-chart"></div>
                <button id="download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
            <div id="answers"></div>
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                <button id="bottom-download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Test data
        const testData = {"test_info": {"title": "Paid Error PART - (III)  SSC CGL PRE 2024", "duration": "10", "total_questions": 25, "max_marks": 50, "marks_per_question": 2.0, "negative_marks": 0.5}, "questions": [{"question_number": 1, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> The teacher asked him not to keep disturbing the class, but it had no affect.", "options": ["1) him not to keep\n                                                    <input class=\"question_options0\" name=\"selected_option_0\" type=\"radio\" value=\"527200_128041\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) but it had no affect.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_0\" type=\"radio\" value=\"527201_128041\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) the teacher asked\n                                                    <input class=\"question_options2\" name=\"selected_option_0\" type=\"radio\" value=\"527202_128041\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) disturbing the class\n                                                    <input class=\"question_options3\" name=\"selected_option_0\" type=\"radio\" value=\"527203_128041\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) but it had no affect.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_0\" type=\"radio\" value=\"527201_128041\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) affect   effect     effect  Noun       ,     affect Verb              ,   : The teacher asked him not to keep disturbing the class, but it had no effect. <br /> effectwill be used instead of affect because here effect is used as a Noun, meaning impact or result. Affect is used as a Verb, meaning to influence. Therefore, the correct sentence will be: The teacher asked him not to keep disturbing the class, but it had no effect.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 2, "question_text": "<strong>Identify the error in the given sentence.</strong> <br /> My colleague always works latest than me", "options": ["1) than me.\n                                                    <input class=\"question_options0\" name=\"selected_option_1\" type=\"radio\" value=\"527204_128042\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) latest\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_1\" type=\"radio\" value=\"527205_128042\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) my colleague\n                                                    <input class=\"question_options2\" name=\"selected_option_1\" type=\"radio\" value=\"527206_128042\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) always works\n                                                    <input class=\"question_options3\" name=\"selected_option_1\" type=\"radio\" value=\"527207_128042\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) latest\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_1\" type=\"radio\" value=\"527205_128042\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) latest'  'later'    'later'   'comparative degree'     'latest'   'superlative degree'            ,  'later'    ;  He arrived later than I did. <br /> 'later'will be used instead of 'latest' because 'later' is used in the comparative degree, while 'latest' is used in the superlative degree. Since the sentence is comparing two people, 'later' is appropriate; like He arrived later than I did.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 3, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains a grammatical error.</strong> <br /> My sister and I / work very hard / nevertheless my brother does not do / any task assigned to him.", "options": ["1) work very hard\n                                                    <input class=\"question_options0\" name=\"selected_option_2\" type=\"radio\" value=\"527208_128043\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) nevertheless my brother does not do\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_2\" type=\"radio\" value=\"527209_128043\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) any task assigned to him.\n                                                    <input class=\"question_options2\" name=\"selected_option_2\" type=\"radio\" value=\"527210_128043\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) My sister and I\n                                                    <input class=\"question_options3\" name=\"selected_option_2\" type=\"radio\" value=\"527211_128043\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) nevertheless my brother does not do\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_2\" type=\"radio\" value=\"527209_128043\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B)  \"nevertheless my brother does not do\"    'does not do'    'does not perform'        'perform a task'      ,  'perform'              - \"He does not perform any task assigned to him.\" <br /> The error is in the segment \"nevertheless my brother does not do.\" Instead of 'does not do,' it should be 'does not perform,' as 'perform a task' is a more appropriate and commonly used structure to indicate doing a task. For example - \"He does not perform any task assigned to him.\"", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 4, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains an error.</strong> <br /> He was / bad injured / in the / last match.", "options": ["1) in the\n                                                    <input class=\"question_options0\" name=\"selected_option_3\" type=\"radio\" value=\"527212_128044\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) bad injured\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_3\" type=\"radio\" value=\"527213_128044\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) last match.\n                                                    <input class=\"question_options2\" name=\"selected_option_3\" type=\"radio\" value=\"527214_128044\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) he was\n                                                    <input class=\"question_options3\" name=\"selected_option_3\" type=\"radio\" value=\"527215_128044\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) bad injured\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_3\" type=\"radio\" value=\"527213_128044\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) bad injured'  'badly injured'    injured  qualify    adverb 'badly'    ,   adjective 'bad' ;  He was badly injured in the accident. badly injured will be used instead of 'bad injured' because to qualify the verb 'injured,' we need the adverb 'badly,' not the adjective 'bad'; Like He was badly injured in the accident.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 5, "question_text": "<strong>Select the sentence that contains a spelling error.</strong>", "options": ["1) Journalism is often the work of painstaking rigour and perseverence that detail the socio-political experiences of our worlds.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_4\" type=\"radio\" value=\"527216_128045\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Elephants are in trouble mainly because people desire ivory trinkets that are made of tusks, often gruesomely killing them to achieve their purpose.\n                                                    <input class=\"question_options1\" name=\"selected_option_4\" type=\"radio\" value=\"527217_128045\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) The venerated singer was also secretive, moody and very intense, famous for erratic and difficult behaviour\n                                                    <input class=\"question_options2\" name=\"selected_option_4\" type=\"radio\" value=\"527218_128045\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Researchers recommend that pesticides should not be used indiscriminately as they eliminate biodiversity for future generations.\n                                                    <input class=\"question_options3\" name=\"selected_option_4\" type=\"radio\" value=\"527219_128045\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) Journalism is often the work of painstaking rigour and perseverence that detail the socio-political experiences of our worlds.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_4\" type=\"radio\" value=\"527216_128045\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) Journalism is often the work of painstaking rigour and perseverence that detail the socio-political experiences of our worlds.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 6, "question_text": "<strong>The following sentence has been divided into three segments. One of them may contain an error. Select the option that has the segment with the error. If you dont find any error, select No error as your answer.</strong> <br /> Mr. Alis shop / is further to / the hospital.", "options": ["1) is further to\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_5\" type=\"radio\" value=\"503339_122362\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) no error\n                                                    <input class=\"question_options1\" name=\"selected_option_5\" type=\"radio\" value=\"503340_122362\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) the hospital.\n                                                    <input class=\"question_options2\" name=\"selected_option_5\" type=\"radio\" value=\"503341_122362\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) mr. Alis shop\n                                                    <input class=\"question_options3\" name=\"selected_option_5\" type=\"radio\" value=\"503342_122362\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) is further to\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_5\" type=\"radio\" value=\"503339_122362\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) 'is further to'  is'farther from'           ,  farther     ,  further                 The park is farther from my house. <br /> Is 'farther from'will be used instead of is 'further to' because when referring to physical distance, 'farther' is used, whereas 'further' is used for progression or sequence. Like The park is farther from my house.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 7, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> It rain a lot in this part of the country.", "options": ["1) It rain\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_6\" type=\"radio\" value=\"503343_122363\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) in this part\n                                                    <input class=\"question_options1\" name=\"selected_option_6\" type=\"radio\" value=\"503344_122363\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) of the country\n                                                    <input class=\"question_options2\" name=\"selected_option_6\" type=\"radio\" value=\"503345_122363\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) a lot\n                                                    <input class=\"question_options3\" name=\"selected_option_6\" type=\"radio\" value=\"503346_122363\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) It rain\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_6\" type=\"radio\" value=\"503343_122363\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) It rain'  'It rains'    Present Simple Tense   subject singular    verb   's'  'es'   ;  'It rains a lot in this part of the country.' <br /> 'It rains' will be used instead of 'It rain' because in Present Simple Tense, when the subject is singular, 's' or 'es' is added to the verb; like 'It rains a lot in this part of the country.'", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 8, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> In some countries, you are not able to drink until you are 21.", "options": ["1) In some countries,\n                                                    <input class=\"question_options0\" name=\"selected_option_7\" type=\"radio\" value=\"503359_122367\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) you are not\n                                                    <input class=\"question_options1\" name=\"selected_option_7\" type=\"radio\" value=\"503360_122367\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) until you are 21.\n                                                    <input class=\"question_options2\" name=\"selected_option_7\" type=\"radio\" value=\"503361_122367\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) able to drink\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_7\" type=\"radio\" value=\"503362_122367\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) able to drink\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_7\" type=\"radio\" value=\"503362_122367\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'able to'drink   'cannot'            ,  'can'  'cannot'           <br /> cannot'will be used instead of 'able to drink' because in this context, it refers to a legal restriction, which is more naturally expressed with 'can' or 'cannot.'", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 9, "question_text": "<strong>Select the option that corrects the error in the given sentence.</strong> <br /> She sings good", "options": ["1) well\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_8\" type=\"radio\" value=\"503363_122368\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) goodly\n                                                    <input class=\"question_options1\" name=\"selected_option_8\" type=\"radio\" value=\"503364_122368\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) better\n                                                    <input class=\"question_options2\" name=\"selected_option_8\" type=\"radio\" value=\"503365_122368\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) best\n                                                    <input class=\"question_options3\" name=\"selected_option_8\" type=\"radio\" value=\"503366_122368\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) well\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_8\" type=\"radio\" value=\"503363_122368\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) good'  'well'    'sings' verb  qualify    adverb      'well'  adverb  'good' adjective ,     ;  She sings well. <br /> 'well'will be used instead of 'good' because to qualify the verb 'sings', an adverb is required, and 'well' is the correct adverb. 'good' is an adjective, which is not appropriate here; Like She sings well.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 10, "question_text": "<strong>Identify the error in the following sentence.</strong> <br /> Ourselves should not boast of ones knowledge.", "options": ["1) knowledge\n                                                    <input class=\"question_options0\" name=\"selected_option_9\" type=\"radio\" value=\"503371_122370\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) ourselves\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_9\" type=\"radio\" value=\"503372_122370\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) ones\n                                                    <input class=\"question_options2\" name=\"selected_option_9\" type=\"radio\" value=\"503373_122370\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) boast\n                                                    <input class=\"question_options3\" name=\"selected_option_9\" type=\"radio\" value=\"503374_122370\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) ourselves\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_9\" type=\"radio\" value=\"503372_122370\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B)Ourselves should not boast of ones knowledgeourselves   Ourselves Reflexive Pronoun         Subject  Object        Subject      :We should not boast of our knowledge. <br /> The error is inourselvesbecause it is a reflexive pronoun used when the subject and object are the same. Since the subject is not specified,weshould be used instead. Additionally,onesshould be replaced withourfor subject-verb agreement.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 11, "question_text": "<strong>The given sentence is divided into four segments. Select the option that has the segment with a grammatical error.</strong> <br /> Two of the worlds / best forwards / has played alongside / David Beckham.", "options": ["1) two of the worlds\n                                                    <input class=\"question_options0\" name=\"selected_option_10\" type=\"radio\" value=\"503375_122371\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) david Beckham.\n                                                    <input class=\"question_options1\" name=\"selected_option_10\" type=\"radio\" value=\"503376_122371\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) has played alongside\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_10\" type=\"radio\" value=\"503377_122371\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) best forwards\n                                                    <input class=\"question_options3\" name=\"selected_option_10\" type=\"radio\" value=\"503378_122371\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) has played alongside\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_10\" type=\"radio\" value=\"503377_122371\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) has played'  'have played'      Subject 'Two of the worlds best forwards' Plural   Plural Subject   Verb  Plural  'have'    ;  Two of the world's best forwards have played alongside David Beckham. <br /> 'have played' will be used instead of 'has played' because the subject of the sentence 'Two of the worlds best forwards' is plural, and with a plural subject, the plural form of the verb 'have' is used; Like Two of the world's best forwards have played alongside David Beckham.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 12, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> I have sing Let It Go before a crowd of thousands of people.", "options": ["1) thousands of people\n                                                    <input class=\"question_options0\" name=\"selected_option_11\" type=\"radio\" value=\"503383_122373\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) I have sing\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_11\" type=\"radio\" value=\"503384_122373\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Let It Go before\n                                                    <input class=\"question_options2\" name=\"selected_option_11\" type=\"radio\" value=\"503385_122373\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) a crowd of\n                                                    <input class=\"question_options3\" name=\"selected_option_11\" type=\"radio\" value=\"503386_122373\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) I have sing\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_11\" type=\"radio\" value=\"503384_122373\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) have sing'  'have sung'    'have'    Verb   (Past Participle) form    ;  I have sung many songs before. <br /> 'have sung' will be used instead of 'have sing' because with 'have,' the third form (Past Participle) of the verb is always used; Like I have sung many songs before.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 13, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> He always wants to be in the company of those who are intellectually superior than him.", "options": ["1) those who are intellectually\n                                                    <input class=\"question_options0\" name=\"selected_option_12\" type=\"radio\" value=\"503387_122374\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) be in the company of\n                                                    <input class=\"question_options1\" name=\"selected_option_12\" type=\"radio\" value=\"503388_122374\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) he always wants to\n                                                    <input class=\"question_options2\" name=\"selected_option_12\" type=\"radio\" value=\"503389_122374\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) superior than him.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_12\" type=\"radio\" value=\"503390_122374\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) superior than him.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_12\" type=\"radio\" value=\"503390_122374\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) superior than him'  'superior to him'    'superior', 'inferior', 'junior', 'senior', 'prefer'     'to'     ,   'than' ;  She is senior to me in the office. <br /> 'superior to him' will be used instead of 'superior than him' because with words like 'superior', 'inferior', 'junior', 'senior', 'prefer', etc., 'to' is used instead of 'than'; Like She is senior to me in the office.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 14, "question_text": "<strong>Select the option with the correct use of future tense</strong>", "options": ["1) By next December, I will have been completed six years in this home.\n                                                    <input class=\"question_options0\" name=\"selected_option_13\" type=\"radio\" value=\"503391_122375\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) By next December, I will have complete six years in this home.\n                                                    <input class=\"question_options1\" name=\"selected_option_13\" type=\"radio\" value=\"503392_122375\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) By next December, I will have completed six years in this home.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_13\" type=\"radio\" value=\"503393_122375\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) By next December, I will be completed six years in this home.\n                                                    <input class=\"question_options3\" name=\"selected_option_13\" type=\"radio\" value=\"503394_122375\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) By next December, I will have completed six years in this home.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_13\" type=\"radio\" value=\"503393_122375\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) By next December, I will have completed six years in this home <br />  By next December, I will have completed six years in this home.    Future Perfect Tense  ,                Will have completed       <br />  The correct answer isBy next December, I will have completed six years in this home.because it uses the Future Perfect Tense, indicating that the action will be completed by a specific point in the future.Will have completedcorrectly conveys the action's completion.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 15, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains an error.</strong> <br /> Mr. Suman / asked me / to pack / my luggages", "options": ["1) mr. Suman\n                                                    <input class=\"question_options0\" name=\"selected_option_14\" type=\"radio\" value=\"503395_122376\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) asked me\n                                                    <input class=\"question_options1\" name=\"selected_option_14\" type=\"radio\" value=\"503396_122376\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) my luggages.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_14\" type=\"radio\" value=\"503397_122376\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) to pack\n                                                    <input class=\"question_options3\" name=\"selected_option_14\" type=\"radio\" value=\"503398_122376\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) my luggages.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_14\" type=\"radio\" value=\"503397_122376\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C)my luggages' error   'luggage' Uncountable Noun ,   Plural  'luggages'        'luggage'    ;  \"Mr. Suman asked me to pack my luggage.\" <br /> There is an error in 'my luggages' because 'luggage' is an uncountable noun, so the plural form 'luggages' is incorrect. The correct sentence should use 'luggage'; Like \"Mr. Suman asked me to pack my luggage.\"", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 16, "question_text": "<strong>Identify the error in the given sentence.</strong> <br /> Camels tend to move slowly than other domestic animals in the plain.", "options": ["1) than other\n                                                    <input class=\"question_options0\" name=\"selected_option_15\" type=\"radio\" value=\"503411_122380\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) move slowly\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_15\" type=\"radio\" value=\"503412_122380\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) camels tend to\n                                                    <input class=\"question_options2\" name=\"selected_option_15\" type=\"radio\" value=\"503413_122380\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) domestic animals in the plains\n                                                    <input class=\"question_options3\" name=\"selected_option_15\" type=\"radio\" value=\"503414_122380\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) move slowly\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_15\" type=\"radio\" value=\"503412_122380\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "'B) slowly'  'slower'    'than' Comparative Degree   ,  Comparative Degree  'more'  Adjective  Comparative Form      He runs faster than me. <br /> 'slower'will be used instead of 'slowly' because 'than' indicates a comparison, and in Comparative Degree, we use 'more' or the Comparative Form of the adjective. For example He runs faster than me.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 17, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment in which the article has been used INCORRECTLY</strong>. <br /> Master Sam / is a heaviest / boy in / grade twelve.", "options": ["1) is a heaviest\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_16\" type=\"radio\" value=\"503415_122381\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) grade twelve.\n                                                    <input class=\"question_options1\" name=\"selected_option_16\" type=\"radio\" value=\"503416_122381\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) master Sam\n                                                    <input class=\"question_options2\" name=\"selected_option_16\" type=\"radio\" value=\"503417_122381\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) boy in\n                                                    <input class=\"question_options3\" name=\"selected_option_16\" type=\"radio\" value=\"503418_122381\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) is a heaviest\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_16\" type=\"radio\" value=\"503415_122381\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) is a heaviest'  'is the heaviest'    superlative degree (heaviest)   'the' article    , 'a'    He is the tallest boy in the class. <br /> 'is the heaviest' will be used instead of 'is a heaviest' because before the superlative degree (heaviest), the article 'the' is used, not 'a'. Like He is the tallest boy in the class.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 18, "question_text": "<strong>The given sentence is divided into four segments. Select the option that has the segment with a grammatical error.</strong> <br /> Jerry driving / home late / when the incident / took place", "options": ["1) Jerry driving\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_17\" type=\"radio\" value=\"503423_122383\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) when the incident\n                                                    <input class=\"question_options1\" name=\"selected_option_17\" type=\"radio\" value=\"503424_122383\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) home late\n                                                    <input class=\"question_options2\" name=\"selected_option_17\" type=\"radio\" value=\"503425_122383\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) took place\n                                                    <input class=\"question_options3\" name=\"selected_option_17\" type=\"radio\" value=\"503426_122383\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) Jerry driving\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_17\" type=\"radio\" value=\"503423_122383\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) Jerry driving'  'Jerry was driving'      'took place' Past Tense    'driving'  'was driving'         Tense  ;  Jerry was driving home late when the incident took place. <br /> 'Jerry was driving' will be used instead of 'Jerry driving' because the sentence contains the verb 'took place' in Past Tense. Therefore, 'driving' should be changed to 'was driving' to maintain consistency in tense throughout the sentence; Like Jerry was driving home late when the incident took place.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 19, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains a grammatical error.</strong> <br /> The lions became violently / when the visitors / started throwing / stones at them.", "options": ["1) when the visitors\n                                                    <input class=\"question_options0\" name=\"selected_option_18\" type=\"radio\" value=\"503427_122384\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) started throwing\n                                                    <input class=\"question_options1\" name=\"selected_option_18\" type=\"radio\" value=\"503428_122384\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) stones at them.\n                                                    <input class=\"question_options2\" name=\"selected_option_18\" type=\"radio\" value=\"503429_122384\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) the lions became violently\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_18\" type=\"radio\" value=\"503430_122384\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) the lions became violently\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_18\" type=\"radio\" value=\"503430_122384\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) violently'  'violent'     'became'  linking verb   linking verb   adjective     , adverb    He became angry. <br /> violent'will be used instead of 'violently' because 'became' is a linking verb, and after a linking verb, we use an adjective, not an adverb. For example He became angry.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 20, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error</strong>. <br /> The company specialises at / designing, crafting and manufacturing / exquisite, high quality furniture / of exceptional craftsmanship", "options": ["1) exquisite, high-quality furniture\n                                                    <input class=\"question_options0\" name=\"selected_option_19\" type=\"radio\" value=\"503447_122389\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) of exceptional craftsmanship\n                                                    <input class=\"question_options1\" name=\"selected_option_19\" type=\"radio\" value=\"503448_122389\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) designing, crafting and manufacturing\n                                                    <input class=\"question_options2\" name=\"selected_option_19\" type=\"radio\" value=\"503449_122389\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) the company specialises at\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_19\" type=\"radio\" value=\"503450_122389\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) the company specialises at\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_19\" type=\"radio\" value=\"503450_122389\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) specialises at'  'specialises in'    'specialise'    preposition 'in'              ;  The company specialises in making electronic gadgets. <br /> 'specialises in'will be used instead of 'specialises at' because 'specialise' always takes the preposition 'in' when referring to a particular area or activity; Like The company specialises in making electronic gadgets.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 21, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error</strong>. <br /> My dog / barks / very louder / at night", "options": ["1) at night\n                                                    <input class=\"question_options0\" name=\"selected_option_20\" type=\"radio\" value=\"503451_122390\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) my dog\n                                                    <input class=\"question_options1\" name=\"selected_option_20\" type=\"radio\" value=\"503452_122390\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) barks\n                                                    <input class=\"question_options2\" name=\"selected_option_20\" type=\"radio\" value=\"503453_122390\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) very louder\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_20\" type=\"radio\" value=\"503454_122390\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) very louder\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_20\" type=\"radio\" value=\"503454_122390\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) very louder'  'very loudly'    'louder' Comparative Adjective ,   Adverb     'barks' (verb)  modify ;  The child speaks very loudly. <br /> 'very loudly' will be used instead of 'very louder' because 'louder' is a Comparative Adjective, while here an Adverb is needed to modify the verb 'barks'; Like The child speaks very loudly.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 22, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error</strong>. <br /> He and his friends / does not / want to / attend the meeting", "options": ["1) attend the meeting\n                                                    <input class=\"question_options0\" name=\"selected_option_21\" type=\"radio\" value=\"503463_122393\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) want to\n                                                    <input class=\"question_options1\" name=\"selected_option_21\" type=\"radio\" value=\"503464_122393\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) does not\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_21\" type=\"radio\" value=\"503465_122393\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) he and his friends\n                                                    <input class=\"question_options3\" name=\"selected_option_21\" type=\"radio\" value=\"503466_122393\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) does not\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_21\" type=\"radio\" value=\"503465_122393\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) does not'  'do not'    'He and his friends'  plural subject ,  plural subject   'do'    ,   'does';  They do not want to go. <br /> 'do not' will be used instead of 'does not' because 'He and his friends' is a plural subject, and with a plural subject, we use 'do,' not 'does'; Like They do not want to go.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 23, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment in which the article has been used INCORRECTLY.</strong> <br /> In the recent past, the IT industry has emerged / as a major contributor to an industry revenue / as well as employment / opportunity provider in the country", "options": ["1) as a major contributor to an industry revenue\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_22\" type=\"radio\" value=\"503467_122394\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) In the recent past, the IT industry has emerged\n                                                    <input class=\"question_options1\" name=\"selected_option_22\" type=\"radio\" value=\"503468_122394\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) as well as employment\n                                                    <input class=\"question_options2\" name=\"selected_option_22\" type=\"radio\" value=\"503469_122394\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) opportunity provider in the country\n                                                    <input class=\"question_options3\" name=\"selected_option_22\" type=\"radio\" value=\"503470_122394\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) as a major contributor to an industry revenue\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_22\" type=\"radio\" value=\"503467_122394\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) an industry revenue'  'the industry revenue'    'industry revenue'  ,   'the'      : 'as a major contributor to the industry revenue'    <br /> 'the industry revenue' will be used instead of 'an industry revenue' because 'industry revenue' is specific, and 'the' is required here. Thus, the correct phrase is 'as a major contributor to the industry revenue.'", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 24, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains a grammatical error.</strong> <br /> Please go and meet the chairperson. / She will be / away for the / few next days", "options": ["1) away for the\n                                                    <input class=\"question_options0\" name=\"selected_option_23\" type=\"radio\" value=\"503479_122397\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) she will be\n                                                    <input class=\"question_options1\" name=\"selected_option_23\" type=\"radio\" value=\"503480_122397\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) please go and meet the chairperson.\n                                                    <input class=\"question_options2\" name=\"selected_option_23\" type=\"radio\" value=\"503481_122397\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) few next days\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_23\" type=\"radio\" value=\"503482_122397\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) few next days\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_23\" type=\"radio\" value=\"503482_122397\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'few next days'  'next few days'       adjective (next)  number (few)         'next few days';  He will be away for the next few days. <br /> 'next few days'will be used instead of 'few next days' because typically, the adjective (next) comes before the number (few). The correct phrase will be 'next few days'; like He will be away for the next few days.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 25, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> While I was walking to the store, my friend calls me and ask for a favour.", "options": ["1) for a favour\n                                                    <input class=\"question_options0\" name=\"selected_option_24\" type=\"radio\" value=\"503483_122398\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) While I was walking\n                                                    <input class=\"question_options1\" name=\"selected_option_24\" type=\"radio\" value=\"503484_122398\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) to the store\n                                                    <input class=\"question_options2\" name=\"selected_option_24\" type=\"radio\" value=\"503485_122398\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) my friend calls me and ask\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_24\" type=\"radio\" value=\"503486_122398\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) my friend calls me and ask\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_24\" type=\"radio\" value=\"503486_122398\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) calls'  'called'    'was walking' Past Continuous Tense  , :  Clause   Verb Past Tense   'ask'   'asked'      Actions         While I was walking to the store, my friend called me and asked for a favour. <br /> 'called'will be used instead of 'calls' because 'was walking' is in Past Continuous Tense, so the verb in the main clause should also be in Past Tense. 'asked' will be used instead of 'ask' because both actions occurred at the same time. Example While I was walking to the store, my friend called me and asked for a favour.", "marks": {"positive": 2.0, "negative": 0.5}}]};

        // Test state variables
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let bookmarkedQuestions = new Set();
        let timerInterval;
        let isDarkMode = false;
        let visitedQuestions = new Set();

        // Initialize the test
        function initializeTest() {
            // Set test title
            document.getElementById('test-title').textContent = testData.test_info.title;
            
            // Initialize user answers array
            userAnswers = Array(testData.questions.length).fill(null);
            
            // Setup question palette
            setupQuestionPalette();
            
            // Setup timer
            setupTimer();
            
            // Show first question
            showQuestion(0);
            
            // Setup event listeners
            setupEventListeners();
            
            // Make sure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function setupEventListeners() {
            document.getElementById('prev-btn').addEventListener('click', goToPreviousQuestion);
            document.getElementById('next-btn').addEventListener('click', goToNextQuestion);
            document.getElementById('submit-test').addEventListener('click', showReviewWarning);
            document.getElementById('bookmark-btn').addEventListener('click', toggleBookmark);
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

            // Question palette toggle functionality
            document.getElementById('palette-toggle').addEventListener('click', toggleQuestionPalette);

            // Add keyboard event listener to document
            document.addEventListener('keydown', handleKeyPress);

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterQuestions(e.target.dataset.filter);
                });
            });
        }

        function toggleQuestionPalette() {
            const palette = document.querySelector('.question-palette');
            const toggleBtn = document.getElementById('palette-toggle');
            
            if (palette.classList.contains('visible')) {
                // Hide palette with animation
                palette.style.transform = 'translateX(100%)';
                toggleBtn.classList.remove('active');
                setTimeout(() => {
                    palette.classList.remove('visible');
                }, 300);
            } else {
                // Show palette with animation
                palette.classList.add('visible');
                toggleBtn.classList.add('active');
                setTimeout(() => {
                    palette.style.transform = 'translateX(0)';
                }, 10);
            }
        }

        // Add display flex to palette toggle button when in mobile view
        function updatePaletteToggleDisplay() {
            const toggleBtn = document.getElementById('palette-toggle');
            if (window.innerWidth <= 768) {
                toggleBtn.style.display = 'flex';
            } else {
                toggleBtn.style.display = 'none';
            }
        }

        // Call on load and window resize
        window.addEventListener('load', updatePaletteToggleDisplay);
        window.addEventListener('resize', updatePaletteToggleDisplay);

        function handleKeyPress(event) {
            console.log('Key pressed:', event.key); // Add debug logging
            
            // Ignore keyboard shortcuts if user is typing in an input field
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }

            // Ignore keyboard shortcuts if test is submitted
            if (document.getElementById('result').style.display === 'block') {
                return;
            }

            // Prevent default behavior for arrow keys and numbers to avoid page scrolling
            if (['ArrowLeft', 'ArrowRight', '1', '2', '3', '4'].includes(event.key)) {
                event.preventDefault();
            }

            switch(event.key) {
                case 'ArrowLeft':
                    if (currentQuestionIndex > 0) {
                        goToPreviousQuestion();
                    }
                    break;
                case 'ArrowRight':
                    if (currentQuestionIndex < testData.questions.length - 1) {
                        goToNextQuestion();
                    }
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
                case 'Enter':
                    if (currentQuestionIndex === testData.questions.length - 1) {
                        showReviewWarning();
                    } else {
                        goToNextQuestion();
                    }
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                    const optionIndex = parseInt(event.key) - 1;
                    const options = document.querySelectorAll('.option');
                    if (options[optionIndex]) {
                        // Add visual feedback for option selection
                        options[optionIndex].classList.add('keyboard-selected');
                        
                        // Actually select the option
                        const radio = options[optionIndex].querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            userAnswers[currentQuestionIndex] = optionIndex + 1;
                            
                            // Update the option's visual state
                            options.forEach(opt => opt.classList.remove('selected'));
                            options[optionIndex].classList.add('selected');
                            
                            // Update the question palette
                            updateQuestionPalette();
                        }
                        
                        // Remove the selection effect after animation
                        setTimeout(() => {
                            options[optionIndex].classList.remove('keyboard-selected');
                        }, 200);
                    }
                    break;
            }
        }

        function setupQuestionPalette() {
            const palette = document.getElementById('question-palette');
            palette.innerHTML = '';
            
            for (let i = 0; i < testData.questions.length; i++) {
                const item = document.createElement('div');
                item.className = 'palette-item not-visited';
                item.textContent = i + 1;
                item.addEventListener('click', () => {
                    showQuestion(i);
                    // Close the palette if it's currently visible (for mobile view)
                    const paletteElement = document.querySelector('.question-palette');
                    if (paletteElement.classList.contains('visible')) {
                        toggleQuestionPalette();
                    }
                });
                palette.appendChild(item);
            }
            
            // Ensure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function updateQuestionPalette() {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                item.className = 'palette-item';
                
                // Only add status classes if the question has been visited
                if (visitedQuestions.has(index)) {
                    if (bookmarkedQuestions.has(index)) {
                        item.classList.add('marked-review');
                    } else if (userAnswers[index] !== null) {
                        item.classList.add('answered');
                    } else {
                        item.classList.add('not-answered');
                    }
                } else {
                    item.classList.add('not-visited');
                }
                
                if (index === currentQuestionIndex) {
                    item.classList.add('active');
                }
            });
        }

        function filterQuestions(filter) {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                const isMarkedReview = bookmarkedQuestions.has(index);
                const isAnswered = userAnswers[index] !== null;
                const isVisited = visitedQuestions.has(index);
                
                switch(filter) {
                    case 'answered':
                        item.style.display = isAnswered ? 'flex' : 'none';
                        break;
                    case 'not-answered':
                        item.style.display = (isVisited && !isAnswered) ? 'flex' : 'none';
                        break;
                    case 'marked-review':
                        item.style.display = isMarkedReview ? 'flex' : 'none';
                        break;
                    default:
                        item.style.display = 'flex';
                }
            });
        }
        
        function setupTimer() {
            const duration = parseFloat(testData.test_info.duration);
            let timeLeft = Math.floor(duration * 60);
            const timerElement = document.getElementById('timer');
            
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                if (timeLeft <= 300) { // 5 minutes warning
                    timerElement.classList.add('timer-warning');
                }
                
                timerElement.innerHTML = `
                    <i class="fas fa-clock"></i>
                    Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}
                `;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest();
                }
                
                timeLeft--;
            }, 1000);
        }
        
        function showQuestion(index) {
            currentQuestionIndex = index;
            // Mark question as visited when opened
            visitedQuestions.add(index);
            const question = testData.questions[index];
            const container = document.getElementById('current-question');
            
            // Add fade-out animation
            container.style.opacity = '0';
            container.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                container.innerHTML = `
                    <div class="question-container">
                        <div class="question-number">
                            <span>Question ${question.question_number} of ${testData.questions.length}</span>
                            <span class="marks-info">
                                <i class="fas fa-plus-circle"></i> ${question.marks.positive}
                                <i class="fas fa-minus-circle"></i> ${question.marks.negative}
                            </span>
                        </div>
                        <div class="question">${question.question_text}</div>
                        <div class="options">
                            ${question.options.map((option, optIndex) => `
                                <label class="option ${userAnswers[index] === optIndex + 1 ? 'selected' : ''}">
                                    <input type="radio" name="question${index}" value="${optIndex + 1}" 
                                        ${userAnswers[index] === optIndex + 1 ? 'checked' : ''}>
                                        <div class="option-content">
                                    <span class="option-number">${optIndex + 1}</span> ${option}
                                        </div>
                                </label>
                            `).join('')}
                        </div>
                        <div style="flex-grow: 1;"></div>
                    </div>
                `;
                
                // Update bookmark button
                const bookmarkBtn = document.getElementById('bookmark-btn');
                bookmarkBtn.classList.toggle('active', bookmarkedQuestions.has(index));
                bookmarkBtn.innerHTML = bookmarkedQuestions.has(index) 
                    ? '<i class="fas fa-flag"></i> Marked for Review'
                    : '<i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>';
                
                // Add event listeners to options
                const options = container.querySelectorAll('.option');
                    options.forEach((option, optIdx) => {
                    option.addEventListener('click', function() {
                        const radio = this.querySelector('input[type="radio"]');
                        radio.checked = true;
                        
                            options.forEach(opt => {
                                opt.classList.remove('selected');
                                opt.style.transform = 'translateX(0)';
                            });
                            
                            // Animate the selected option
                        this.classList.add('selected');
                            this.style.transform = 'translateX(10px)';
                        
                        userAnswers[index] = parseInt(radio.value);
                        updateQuestionPalette();

                            // Highlight the option number with a pulse animation
                        const optionNumber = this.querySelector('.option-number');
                        optionNumber.style.animation = 'pulse 0.5s ease';
                        setTimeout(() => {
                            optionNumber.style.animation = '';
                        }, 500);
                });

                        // Add a small delay to each option's appearance
                        option.style.opacity = '0';
                        option.style.transform = 'translateX(20px)';
                        setTimeout(() => {
                            option.style.opacity = '1';
                            option.style.transform = 'translateX(0)';
                        }, 100 + (optIdx * 50));
                    });
                    
                    // Fade in the content
                    setTimeout(() => {
                        container.style.opacity = '1';
                        container.style.transform = 'translateY(0)';
                    }, 50);
                
                // Update navigation buttons
                updateNavigationButtons();
                
                // Update question palette
                updateQuestionPalette();
                }, 150);
        }
        
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-test');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === testData.questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }
        
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        }
        
        function goToNextQuestion() {
            if (currentQuestionIndex < testData.questions.length - 1) {
                showQuestion(currentQuestionIndex + 1);
            }
        }

        function toggleBookmark() {
            const btn = document.getElementById('bookmark-btn');
            if (bookmarkedQuestions.has(currentQuestionIndex)) {
                bookmarkedQuestions.delete(currentQuestionIndex);
                btn.classList.remove('active');
                btn.innerHTML = `
                    <i class="far fa-flag"></i> 
                    Mark for Review <span class="shortcut-hint">(B)</span>
                `;
            } else {
                bookmarkedQuestions.add(currentQuestionIndex);
                btn.classList.add('active');
                btn.innerHTML = `
                    <i class="fas fa-flag"></i> 
                    Marked for Review
                `;
            }
            updateQuestionPalette();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.innerHTML = `<i class="fas fa-${isDarkMode ? 'sun' : 'moon'}"></i>`;
        }

        function showReviewWarning() {
            // Skip the warning and directly submit the test
            submitTest();
        }
        
        function submitTest() {
            // Add submission animation
            const testContainer = document.getElementById('test-container');
            const questionPalette = document.querySelector('.question-palette');
            const resultContainer = document.getElementById('result');
            
            // Animate test container sliding out
            testContainer.style.transition = 'all 0.5s var(--animation-bounce)';
            testContainer.style.transform = 'translateX(-50px)';
            testContainer.style.opacity = '0';
            
            // Animate question palette fading out
            questionPalette.style.transition = 'all 0.5s var(--animation-bounce)';
            questionPalette.style.transform = 'translateX(50px)';
            questionPalette.style.opacity = '0';
            
            // Clear the timer
            clearInterval(timerInterval);
            
            // Calculate results with a slight delay for animation
            setTimeout(() => {
            let score = 0;
            let correctCount = 0;
            let attemptedCount = 0;
            const reviewAnswers = [];
            
            // Calculate score and statistics
            testData.questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct_answer;
                
                if (userAnswer !== null) {
                    attemptedCount++;
                    if (isCorrect) {
                        score += question.marks.positive;
                        correctCount++;
                    } else {
                        score -= question.marks.negative;
                    }
                }
                
                reviewAnswers.push({
                    questionNumber: question.question_number,
                    questionText: question.question_text,
                    userChoice: userAnswer,
                    userChoiceText: userAnswer !== null ? question.options[userAnswer - 1] : 'Not answered',
                    correctAnswer: question.correct_answer,
                    correctAnswerText: question.correct_option,
                    isCorrect: isCorrect,
                    answered: userAnswer !== null
                });
            });
            
            // Update statistics
            document.getElementById('total-questions').textContent = testData.questions.length;
            document.getElementById('attempted-questions').textContent = attemptedCount;
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('accuracy').textContent = 
                `${Math.round((correctCount / (attemptedCount || 1)) * 100)}%`;
            
            // Display score
            document.getElementById('score').innerHTML = `
                <div style="font-size: 36px; color: var(--primary-color);">
                    ${score.toFixed(2)} / ${testData.questions.length * testData.questions[0].marks.positive}
                </div>
                <div style="color: var(--text-color); margin-top: 10px;">
                    Percentage: ${Math.round((score / (testData.questions.length * testData.questions[0].marks.positive)) * 100)}%
                </div>
            `;
            
            // Create performance chart
            const chartContainer = document.getElementById('performance-chart');
            chartContainer.innerHTML = ''; // Clear previous chart if any
            const ctx = document.createElement('canvas');
            chartContainer.appendChild(ctx);
                
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Correct', 'Incorrect', 'Not Attempted'],
                    datasets: [{
                        data: [
                            correctCount,
                            attemptedCount - correctCount,
                            testData.questions.length - attemptedCount
                        ],
                        backgroundColor: [
                                '#16a34a', // Fixed success green
                                '#dc2626', // Fixed error red
                                '#8b5cf6'  // Fixed purple for not attempted
                        ],
                            borderColor: 'var(--bg-color)',
                        borderWidth: 2,
                            hoverOffset: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'var(--bg-color)',
                                titleColor: 'var(--text-color)',
                                bodyColor: 'var(--text-color)',
                                borderColor: 'var(--border-color)',
                                borderWidth: 1,
                                padding: 12,
                                boxPadding: 6,
                                usePointStyle: true,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        let value = context.raw || 0;
                                        let total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        let percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            },
                            title: {
                                display: true,
                                text: 'Test Performance',
                                color: 'var(--text-color)',
                                font: {
                                    family: 'Inter, sans-serif',
                                    size: 16,
                                    weight: '600'
                                },
                                padding: {
                                    bottom: 15
                            }
                        }
                    },
                    cutout: '65%',
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                            duration: 1500,
                            easing: 'easeOutQuart'
                    }
                }
            });
                
                // Replace the chart's built-in legend with a custom one
                const customLegend = document.createElement('div');
                customLegend.className = 'custom-chart-legend';

                chartContainer.appendChild(customLegend);
            
            // Update the analytics container title
            document.querySelector('.analytics-container h3').innerHTML = 
                '<i class="fas fa-chart-pie"></i> Performance Analysis';
            
            // Add event listener to the download analysis buttons with a small delay to ensure UI is ready
            setTimeout(() => {
                const downloadBtn = document.getElementById('download-analysis');
                const bottomDownloadBtn = document.getElementById('bottom-download-analysis');
                if (downloadBtn) {
                    downloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
                if (bottomDownloadBtn) {
                    bottomDownloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
            }, 500);
            
            // Fix any palette toggle issue
            if (window.innerWidth <= 768) {
                const paletteToggle = document.getElementById('palette-toggle');
                if (paletteToggle) {
                    paletteToggle.style.display = 'flex';
                }
                
                // Add close button to palette if not exists
                const palette = document.querySelector('.question-palette');
                if (palette && !document.querySelector('.palette-close-btn')) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'palette-close-btn';
                    closeBtn.innerHTML = '<i class="fas fa-times"></i>';
                    closeBtn.addEventListener('click', toggleQuestionPalette);
                    
                    const paletteHeader = palette.querySelector('.palette-header');
                    if (paletteHeader) {
                        paletteHeader.appendChild(closeBtn);
                    }
                }
            }
            
                // Display answer review with staggered animation
            const answersDiv = document.getElementById('answers');
            answersDiv.innerHTML = '<h3>Answer Review:</h3>';
            
                reviewAnswers.forEach((answer, idx) => {
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-review';
                    answerDiv.style.opacity = '0';
                    answerDiv.style.transform = 'translateY(20px)';
                
                answerDiv.innerHTML = `
                    <p><strong>Question ${answer.questionNumber}:</strong> ${answer.questionText}</p>
                    <p class="${answer.answered ? (answer.isCorrect ? 'correct' : 'incorrect') : ''}">
                        Your answer: ${answer.userChoiceText}
                        ${answer.isCorrect ? '<i class="fas fa-check"></i>' : 
                        (answer.answered ? '<i class="fas fa-times"></i>' : '')}
                    </p>
                    ${!answer.isCorrect ? `
                        <p class="correct">
                            Correct answer: ${answer.correctAnswerText}
                            <i class="fas fa-check"></i>
                        </p>
                    ` : ''}
                    ${testData.questions[idx].explanation ? `
                        <div class="explanation">
                            <p><strong>Explanation:</strong></p>
                            <p>${testData.questions[idx].explanation}</p>
                        </div>
                    ` : ''}
                `;
                
                answersDiv.appendChild(answerDiv);
                    
                    // Animate each answer review with a staggered delay
                    setTimeout(() => {
                        answerDiv.style.transition = 'all 0.5s var(--animation-bounce)';
                        answerDiv.style.opacity = '1';
                        answerDiv.style.transform = 'translateY(0)';
                    }, 200 + (idx * 100));
                });
                
                // Show results container with animation
                resultContainer.style.display = 'block';
                resultContainer.style.opacity = '0';
                resultContainer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultContainer.style.transition = 'all 0.6s var(--animation-bounce)';
                    resultContainer.style.opacity = '1';
                    resultContainer.style.transform = 'translateY(0)';
                }, 100);
                
                // Hide test components
                testContainer.style.display = 'none';
                questionPalette.style.display = 'none';
                document.getElementById('palette-toggle').style.display = 'none';
            }, 600);
        }
        
        // Initialize the test
        initializeTest();

        // Add CSS transitions to the current-question container
        document.addEventListener('DOMContentLoaded', function() {
            const currentQuestion = document.getElementById('current-question');
            currentQuestion.style.transition = 'opacity 0.3s ease, transform 0.3s var(--animation-bounce)';
        });

        // Add CSS for smooth palette transitions
        document.addEventListener('DOMContentLoaded', function() {
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .question-palette {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                #palette-toggle {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                @media (max-width: 768px) {
                    .question-container:hover {
                        transform: translateY(-2px);
                    }
                    
                    .score-card:hover {
                        transform: translateY(-4px);
                    }
                    
                    .option:hover {
                        transform: translateX(4px);
                    }
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Add this after the Chart.js script tag but before your testData declaration
        document.addEventListener('DOMContentLoaded', function() {
            // Add custom styling for chart legend
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .chart-legend-item {
                    display: flex;
                    align-items: center;
                    margin: 8px 0;
                    font-weight: 600;
                }
                
                .legend-color {
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    margin-right: 8px;
                    display: inline-block;
                }
                
                .legend-correct {
                    background-color: #16a34a;
                }
                
                .legend-incorrect {
                    background-color: #dc2626;
                }
                
                .legend-not-attempted {
                    background-color: #8b5cf6;
                }
                
                .custom-chart-legend {
                    display: flex;
                    justify-content: center;
                    gap: 15px;
                    margin-top: 15px;
                    flex-wrap: wrap;
                }
                
                [data-theme="dark"] .legend-text {
                    color: #f1f5f9;
                }
                
                .chart-container canvas {
                    margin-bottom: 10px;
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Function to download test analysis as HTML file
        function downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount) {
            const maxScore = testData.questions.length * testData.questions[0].marks.positive;
            const percentage = Math.round((score / maxScore) * 100);

            // Create HTML content
            let htmlContent = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Test Analysis - ${testData.test_info.title}</title>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
                <style>
                    body {
                        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                        max-width: 900px;
                        margin: 0 auto;
                        padding: 20px;
                        color: #1e293b;
                        background-color: #f8fafc;
                        line-height: 1.6;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 15px;
                    }
                    .header h1 {
                        color: #4f46e5;
                        margin-bottom: 5px;
                    }
                    .header .date {
                        font-style: italic;
                        color: #64748b;
                    }
                    .summary {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                        gap: 20px;
                        margin-bottom: 30px;
                    }
                    .summary-card {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 15px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        text-align: center;
                        border: 1px solid #e2e8f0;
                    }
                    .summary-card h3 {
                        margin-top: 0;
                        margin-bottom: 10px;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .summary-card .value {
                        font-size: 24px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight {
                        background-color: #f3f4f6;
                        padding: 30px;
                        border-radius: 8px;
                        text-align: center;
                        margin-bottom: 30px;
                        border: 1px solid #e5e7eb;
                    }
                    .score-highlight .score {
                        font-size: 48px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight .percentage {
                        font-size: 18px;
                        color: #64748b;
                    }
                    .question-review {
                        margin-bottom: 30px;
                    }
                    .question {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 20px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        margin-bottom: 15px;
                        border: 1px solid #e2e8f0;
                    }
                    .question-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 10px;
                        padding-bottom: 10px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .question-text {
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer {
                        margin-bottom: 5px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer.correct {
                        color: #16a34a;
                    }
                    .user-answer.incorrect {
                        color: #dc2626;
                    }
                    .correct-answer {
                        color: #16a34a;
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation {
                        background-color: #f8fafc;
                        padding: 15px;
                        border-radius: 8px;
                        border-left: 4px solid #4f46e5;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation-title {
                        font-weight: bold;
                        margin-bottom: 5px;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 40px;
                        padding-top: 20px;
                        border-top: 1px solid #e2e8f0;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .unattempted {
                        color: #8b5cf6;
                    }
                    @media print {
                        body {
                            background-color: white;
                        }
                        .question, .summary-card, .score-highlight {
                            break-inside: avoid;
                        }
                    }
                    /* Responsive fixes */
                    @media (max-width: 768px) {
                        body {
                            padding: 10px;
                        }
                        .summary {
                            grid-template-columns: 1fr;
                        }
                        .score-highlight .score {
                            font-size: 36px;
                        }
                        .question-header {
                            flex-direction: column;
                            align-items: flex-start;
                        }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>${testData.test_info.title}</h1>
                    <div class="date">Generated on: ${new Date().toLocaleString()}</div>
                </div>
                
                <div class="score-highlight">
                    <div class="score">${score.toFixed(2)} / ${maxScore}</div>
                    <div class="percentage">Percentage: ${percentage}%</div>
                </div>
                
                <div class="summary">
                    <div class="summary-card">
                        <h3>Total Questions</h3>
                        <div class="value">${testData.questions.length}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Attempted</h3>
                        <div class="value">${attemptedCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Correct</h3>
                        <div class="value">${correctCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Accuracy</h3>
                        <div class="value">${Math.round((correctCount / (attemptedCount || 1)) * 100)}%</div>
                    </div>
                </div>
                
                <h2>Question Review</h2>
                <div class="question-review">
            `;

            // Add each question and answer to the HTML content
            reviewAnswers.forEach((answer, idx) => {
                const question = testData.questions[idx];
                htmlContent += `
                    <div class="question">
                        <div class="question-header">
                            <strong>Question ${answer.questionNumber}</strong>
                            <span>${answer.isCorrect ? '+' : (answer.answered ? '-' : '0')}${question.marks.positive} marks</span>
                        </div>
                        <div class="question-text">${answer.questionText}</div>
                        <div class="user-answer ${answer.isCorrect ? 'correct' : (answer.answered ? 'incorrect' : 'unattempted')}">
                            <strong>${answer.answered ? 'Your answer: ' : 'Not attempted'}</strong> 
                            ${answer.answered ? answer.userChoiceText : ''}
                            ${answer.isCorrect ? ' ' : (answer.answered ? ' ' : '')}
                        </div>
                        ${!answer.isCorrect ? `
                            <div class="correct-answer">
                                <strong>Correct answer:</strong> ${answer.correctAnswerText}
                            </div>
                        ` : ''}
                        ${question.explanation ? `
                            <div class="explanation">
                                <div class="explanation-title">Explanation:</div>
                                <div>${question.explanation}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            // Close HTML content
            htmlContent += `
                </div>
                
                <div class="footer">
                    <p>&copy; 2025 KUNAL Test Platform. All rights reserved.</p>
                    <p>Created by @finallygotnirvana</p>
                </div>
            </body>
            </html>
            `;

            // Create a download link
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            
            // Format date for filename
            const date = new Date();
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            
            downloadLink.download = `Test_Analysis_${formattedDate}.html`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }

        document.addEventListener('keydown', function(e) {
            // Prevent default behavior for arrow keys
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight' || e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
            }

            switch(e.key) {
                case 'ArrowLeft':
                    goToPreviousQuestion();
                    break;
                case 'ArrowRight':
                    goToNextQuestion();
                    break;
                case 'ArrowUp':
                case 'ArrowDown':
                    // Get all options for the current question
                    const options = document.querySelectorAll('.option');
                    if (options.length === 0) return;

                    // Find currently selected option
                    let currentIndex = Array.from(options).findIndex(opt => opt.classList.contains('selected'));
                    
                    // Calculate new index
                    if (e.key === 'ArrowUp') {
                        currentIndex = currentIndex <= 0 ? options.length - 1 : currentIndex - 1;
                    } else {
                        currentIndex = currentIndex >= options.length - 1 ? 0 : currentIndex + 1;
                    }

                    // Select the new option
                    options.forEach(opt => opt.classList.remove('selected'));
                    options[currentIndex].classList.add('selected');
                    options[currentIndex].querySelector('input[type="radio"]').checked = true;
                    
                    // Update user answer
                    userAnswers[currentQuestionIndex] = currentIndex + 1;
                    updateQuestionPalette();
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
            }
        });
    </script>
</body>
</html>

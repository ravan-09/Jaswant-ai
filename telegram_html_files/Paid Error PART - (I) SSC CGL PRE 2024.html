<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Test</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5; /* Improved indigo */
            --secondary-color: #4338ca;
            --success-color: #16a34a; /* Brighter green for better contrast */
            --danger-color: #dc2626;
            --warning-color: #0369a1;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-color: #1e293b;
            --bg-color: #ffffff;
            --muted-text: #64748b;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
        }

        /* Add custom scrollbar styling */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Add responsive styles for mobile */
        @media screen and (max-width: 768px) {
            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                top: auto;
                z-index: 1000;
                max-height: 50vh;
                margin: 0;
                border-radius: 16px 16px 0 0;
            }

            .palette-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 10px;
            }

            .palette-item {
                width: 100%;
                height: 36px;
            }
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--light-bg);
        }

        /* Custom scrollbar for webkit browsers */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        .question-palette:hover {
            box-shadow: var(--shadow-lg);
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .palette-item.active::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid currentColor;
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.5; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--border-color), transparent);
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-color), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }
        
        .question-container {
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            background-color: var(--bg-color);
            box-shadow: var(--shadow-md);
            min-height: 500px;
            display: flex;
            flex-direction: column;
        }

        .question-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }
        
        .question-number {
            font-size: 14px;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-color);
            font-weight: 500;
            animation: fadeIn 0.5s ease;
        }
        
        .options {
            flex-grow: 1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .option {
            display: block;
            margin: 12px 0;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            color: var(--text-color);
            background-color: var(--bg-color);
            font-size: 14px;
            font-weight: 400;
            user-select: none; /* Prevent text selection */
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: rgba(79, 70, 229, 0.05);
            transition: width 0.3s ease;
            z-index: 0;
        }
        
        .option:hover::before {
            width: 100%;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            transform: translateX(8px);
        }
        
        .option:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .option.selected {
            background-color: rgba(79, 70, 229, 0.15);
            border-color: var(--primary-color);
            transform: translateX(10px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        .option.selected::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background-color: var(--primary-color);
            border-radius: 4px 0 0 4px;
        }
        
        .option-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            /* Added flex-wrap for better text handling */
            flex-wrap: wrap;
            width: 100%;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 35px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            position: sticky;
            bottom: 20px;
            background-color: var(--bg-color);
            padding-bottom: 10px;
            z-index: 5;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 22px;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            min-width: 100px;
            letter-spacing: 0.3px;
            background-color: var(--primary-color);
            outline: none;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
            z-index: 0;
        }

        button:hover::before {
            width: 150%;
            height: 150%;
        }

        button:active::before {
            background: rgba(0, 0, 0, 0.1);
            width: 150%;
            height: 150%;
        }
        
        button:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.25);
            filter: brightness(var(--button-hover-brightness));
        }
        
        button:active {
            transform: translateY(-2px);
            transition: all 0.1s;
        }

        button i {
            font-size: 18px;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 1;
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button:hover i {
            transform: scale(1.2);
        }

        button:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        button:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
            box-shadow: none;
        }

        button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        button:disabled::before {
            display: none;
        }

        #bookmark-btn {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            font-weight: 500;
            transition: all 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover {
            border-color: #eab308;
            color: #eab308;
            background-color: rgba(234, 179, 8, 0.08);
        }

        #bookmark-btn.active {
            background-color: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 600;
        }

        #bookmark-btn.active:hover {
            background-color: #ca8a04;
            color: #1e293b;
        }

        #bookmark-btn i {
            transition: transform 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover i {
            transform: translateY(-2px);
        }
        
        #submit-test {
            background-color: var(--success-color);
            font-weight: 600;
            min-width: 140px;
        }
        
        #submit-test:hover {
            box-shadow: 0 6px 15px rgba(22, 163, 74, 0.25);
        }
        
        #prev-btn, #next-btn {
            background-color: var(--primary-color);
            min-width: 130px;
        }
        
        #timer {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: rgba(79, 70, 229, 0.08);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .timer-warning {
            color: var(--danger-color);
            animation: pulse 1.5s infinite;
            background: rgba(220, 38, 38, 0.1);
            border-color: var(--danger-color);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        #result {
            display: none;
            color: var(--text-color);
        }
        
        #score {
            font-size: 32px;
            text-align: center;
            margin: 35px 0;
            padding: 30px;
            background: linear-gradient(to right, rgba(79, 70, 229, 0.08), rgba(139, 92, 246, 0.08));
            border-radius: 12px;
            line-height: 1.6;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.8s var(--animation-bounce);
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #score::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(79, 70, 229, 0.1), transparent 60%);
            z-index: 0;
        }

        #score div {
            position: relative;
            z-index: 1;
        }

        .score-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .score-card {
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--chart-color-1), var(--chart-color-3));
            transition: height 0.3s ease;
        }

        .score-card:hover::before {
            height: 6px;
        }

        .score-card:nth-child(2)::before {
            background: linear-gradient(to right, var(--chart-color-2), var(--chart-color-4));
        }

        .score-card:nth-child(3)::before {
            background: linear-gradient(to right, var(--chart-color-3), var(--chart-color-5));
        }

        .score-card:nth-child(4)::before {
            background: linear-gradient(to right, var(--chart-color-4), var(--chart-color-1));
        }

        .score-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .score-card h3 {
            margin: 0 0 16px 0;
            color: var(--text-color);
            font-size: 14px;
            font-weight: 600;
            line-height: 1.4;
            max-width: 100%;
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        .score-card div {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, var(--chart-color-1), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            line-height: 1.2;
            margin: 0;
            padding: 0;
        }

        .score-card:hover div {
            transform: scale(1.1);
        }

        .score-card:nth-child(2) div {
            background: linear-gradient(45deg, var(--chart-color-2), var(--chart-color-4));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(3) div {
            background: linear-gradient(45deg, var(--chart-color-3), var(--chart-color-5));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(4) div {
            background: linear-gradient(45deg, var(--chart-color-4), var(--chart-color-1));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .chart-container {
            height: 350px;
            margin: 25px 0;
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            animation: fadeScale 1s ease;
            position: relative;
        }

        @keyframes fadeScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(79, 70, 229, 0.03), transparent 70%);
            z-index: 0;
            border-radius: 12px;
        }

        .shortcut-hint {
            font-size: 12px;
            color: var(--muted-text);
            font-weight: normal;
        }

        .keyboard-shortcuts {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .keyboard-shortcuts span {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            padding: 3px 6px;
            border-radius: 6px;
            font-size: 11px;
            color: var(--muted-text);
            cursor: help;
            font-weight: 500;
        }

        .keyboard-shortcuts span:hover {
            background: var(--border-color);
            color: var(--text-color);
        }

        .option-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 26px;
            height: 26px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .option:hover .option-number {
            transform: scale(1.1);
        }

        .option.selected .option-number {
            background: var(--success-color);
            box-shadow: 0 0 10px rgba(22, 163, 74, 0.4);
        }

        .palette-toggle-btn {
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(79, 70, 229, 0.25);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            padding: 0;
            min-width: unset;
        }

        .palette-toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.2), transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .palette-toggle-btn:hover::before {
            opacity: 1;
        }

        .palette-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(79, 70, 229, 0.4);
        }

        .palette-toggle-btn:active {
            transform: scale(0.95);
        }

        .palette-toggle-btn.active {
            transform: rotate(45deg);
        }

        .palette-toggle-btn i {
            position: relative;
            z-index: 1;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .palette-toggle-btn:hover i {
            transform: rotate(-15deg);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 13px;
            }

            .container {
                padding: 15px;
                border-radius: 10px;
            }

            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: 0;
                z-index: 1000;
                border-radius: 0;
                overflow-y: auto;
                transform: translateX(100%);
                transition: transform 0.3s var(--animation-bounce);
                padding: 20px;
            }

            .question-palette.visible {
                transform: translateX(0);
            }

            .palette-toggle-btn {
                width: 48px;
                height: 48px;
                bottom: 16px;
                right: 16px;
                font-size: 18px;
            }

            .palette-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .palette-close-btn {
                background: transparent;
                border: none;
                color: var(--text-color);
                font-size: 20px;
                cursor: pointer;
                min-width: auto;
                padding: 10px;
                box-shadow: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
            }

            .palette-close-btn:hover {
                color: var(--primary-color);
                background: rgba(79, 70, 229, 0.1);
            }

            .score-details {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
                gap: 12px;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
                position: sticky;
                bottom: 10px;
                padding-bottom: 5px;
            }
            
            .question-container {
                min-height: 400px;
            }

            .bookmark-btn {
                width: 100%;
                justify-content: center;
            }

            button {
                width: 100%;
                justify-content: center;
                padding: 14px 20px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding-bottom: 12px;
            }

            .header-controls {
                width: 100%;
                justify-content: center;
            }

            .theme-toggle {
                width: 40px;
                height: 40px;
                padding: 10px;
            }

            .keyboard-shortcuts {
                display: none;
            }

            #timer {
                padding: 8px 14px;
                font-size: 13px;
                width: 100%;
                justify-content: center;
            }

            .question {
                font-size: 15px;
            }

            .option {
                padding: 14px;
                margin: 10px 0;
                word-break: break-word; /* Added to prevent text overflow */
            }

            .option:hover {
                transform: translateX(4px);
            }

            .option.selected {
                transform: translateX(8px);
            }

            /* Fix for mobile devices where hover states persist */
            @media (hover: none) {
                button:hover, .option:hover, .score-card:hover, .answer-review:hover {
                    transform: none;
                }

                button:active, .option:active {
                    transform: scale(0.98);
                }
            }

            /* Enhance readability on mobile */
            #score {
                font-size: 24px;
                padding: 20px;
            }

            .chart-container {
                height: 300px;
            }

            .custom-chart-legend {
                flex-direction: column;
                align-items: flex-start;
                padding-left: 20px;
            }

            /* Prevent mobile zoom when tapping buttons/options */
            button, .option, input, select {
                font-size: 16px;
            }

            .palette-filters {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 10px;
                justify-content: center;
                -webkit-overflow-scrolling: touch;
                gap: 8px;
            }
            
            .filter-btn {
                font-size: 11px;
                padding: 5px 10px;
                white-space: nowrap;
                flex-shrink: 0; /* Prevent filters from shrinking */
            }
            
            /* Fix download button on mobile */
            .download-btn {
                width: 100%;
                min-width: 100%;
                margin-top: 15px;
                padding: 14px 10px;
                white-space: normal; /* Allow text to wrap */
            }
            
            /* Option text can wrap now */
            .option-content {
                flex-wrap: wrap;
                width: 100%;
            }
            
            /* Ensure option number doesn't shrink */
            .option-number {
                flex-shrink: 0;
                margin-bottom: 5px;
            }
        }

        .answer-review {
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 15px;
            background: var(--bg-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .answer-review:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(79, 70, 229, 0.1);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .explanation strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        .explanation p {
            margin: 8px 0;
            line-height: 1.6;
            color: var(--text-color);
        }

        [data-theme="dark"] .explanation {
            background: rgba(99, 102, 241, 0.1);
        }

        .correct {
            color: var(--success-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(22, 163, 74, 0.1);
            transition: all 0.3s ease;
        }

        .correct:hover {
            background-color: rgba(22, 163, 74, 0.15);
        }

        .incorrect {
            color: var(--danger-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(220, 38, 38, 0.1);
            transition: all 0.3s ease;
        }

        .incorrect:hover {
            background-color: rgba(220, 38, 38, 0.15);
        }

        .marks-info {
                font-size: 12px;
            color: var(--muted-text);
            font-style: normal;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 10px;
            background-color: rgba(100, 116, 139, 0.08);
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .marks-info:hover {
            background-color: rgba(100, 116, 139, 0.12);
        }

        .question-number {
            font-weight: 600;
            color: var(--text-color);
            font-size: 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border-color);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            min-width: unset;
            width: 38px;
            height: 38px;
        }

        .theme-toggle:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.08);
            transform: rotate(180deg);
        }

        .review-warning {
            background-color: rgba(220, 38, 38, 0.08);
            border: 1px solid var(--danger-color);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-color);
            box-shadow: var(--shadow-md);
            animation: slideDown 0.5s var(--animation-bounce);
        }

        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .review-warning i {
            color: var(--danger-color);
            font-size: 28px;
            animation: shake 1s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        #review-list {
            margin-top: 25px;
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .review-item:hover {
            background: rgba(79, 70, 229, 0.05);
            transform: translateX(5px);
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .analytics-container {
            margin-top: 35px;
            padding: 25px;
            border-radius: 12px;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .analytics-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .analytics-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .analytics-container h3 i {
            font-size: 20px;
            color: var(--chart-color-1);
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .keyboard-pressed {
            transform: scale(0.95) translateY(0) !important;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1) !important;
            opacity: 0.9;
            transition: all 0.1s ease !important;
        }
        
        .keyboard-selected {
            background-color: rgba(79, 70, 229, 0.15);
            transform: translateX(5px);
            transition: all 0.1s ease;
        }
        
        @keyframes buttonPulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .review-warning {
            animation: none;
            transition: all 0.3s var(--animation-bounce);
        }
        
        .fade-out {
            opacity: 0 !important;
            transform: translateY(-10px) !important;
        }
        
        .review-warning button {
            flex: 1;
            min-width: 120px;
        }
        
        @media (max-width: 768px) {
            .review-warning {
                flex-direction: column;
                padding: 20px;
            }
            
            .review-warning i {
                margin-bottom: 10px;
                align-self: center;
            }
        }

        .custom-chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 24px;
            flex-wrap: wrap;
            padding: 0 16px;
        }

        .chart-legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            display: inline-block;
            flex-shrink: 0;
        }

        .legend-text {
            color: var(--text-color);
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .score-card {
                padding: 20px;
                min-height: 100px;
            }

            .score-card h3 {
                font-size: 13px;
                margin-bottom: 12px;
            }

            .score-card div {
                font-size: 24px;
            }

            .custom-chart-legend {
                gap: 12px;
                margin-top: 20px;
                padding: 0 12px;
            }

            .chart-legend-item {
                font-size: 12px;
            }

            .legend-color {
                width: 10px;
                height: 10px;
                margin-right: 6px;
            }
        }

        /* Add new styles for creator info */
        .creator-info {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            border-radius: 12px;
            margin-bottom: 20px;
            gap: 15px;
            border: 1px solid var(--border-color);
        }

        .creator-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .creator-logo:hover {
            transform: scale(1.1);
        }

        .creator-tg {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .creator-tg:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .creator-tg i {
            color: #229ED9;
            font-size: 20px;
        }

        [data-theme="dark"] .creator-info {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(34, 197, 94, 0.1) 100%);
        }

        .download-btn {
            background: linear-gradient(145deg, var(--chart-color-1), var(--chart-color-3));
            margin-top: 20px;
            width: auto;
            padding: 12px 24px;
            transition: all 0.3s var(--animation-bounce);
            box-shadow: var(--shadow-md);
            font-weight: 600;
            letter-spacing: 0.5px;
            min-width: 200px;
            color: white;
            /* Ensure text doesn't overflow */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .download-btn:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .download-btn i {
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="creator-info">
        <a href="https://t.me/finallygotnirvana" target="_blank" class="creator-tg">
            <i class="fab fa-telegram"></i>
            Created by @finallygotnirvana
        </a>
        <img src="https://i.ibb.co/0ysnvFZS/0x1900-000000-80-0-0.jpg" alt="Creator Logo" class="creator-logo">
    </div>

    <div class="test-layout">
        <div id="test-container" class="container">
            <div class="header">
                <h1 id="test-title">Mock Test</h1>
                <div class="header-controls">
                    <div id="timer"><i class="fas fa-clock"></i> Time Remaining: 00:00</div>
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <div id="current-question"></div>
            
            <div class="navigation">
                <div class="nav-buttons">
                    <button id="prev-btn" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                    <button id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button id="submit-test" style="display: none;"><i class="fas fa-check"></i> Submit Test</button>
                </div>
                <button id="bookmark-btn">
                    <i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>
                </button>
            </div>
        </div>

        <div class="question-palette container">
            <div class="palette-header">
                <h3>Question Palette</h3>
            </div>
            <div class="palette-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="answered">Answered</button>
                <button class="filter-btn" data-filter="not-answered">Not Answered</button>
                <button class="filter-btn" data-filter="marked-review">Marked for Review</button>
            </div>
            <div class="palette-grid" id="question-palette"></div>
        </div>
    </div>

    <button class="palette-toggle-btn" id="palette-toggle">
        <i class="fas fa-th"></i>
    </button>

            <div id="result" class="container">
            <div id="score"></div>
            <div class="score-details">
                <div class="score-card">
                    <h3>Total Questions</h3>
                    <div id="total-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Attempted</h3>
                    <div id="attempted-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Correct</h3>
                    <div id="correct-answers">0</div>
                </div>
                <div class="score-card">
                    <h3>Accuracy</h3>
                    <div id="accuracy">0%</div>
                </div>
            </div>
            <div class="analytics-container">
                <h3>Performance Analysis</h3>
                <div class="chart-container" id="performance-chart"></div>
                <button id="download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
            <div id="answers"></div>
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                <button id="bottom-download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Test data
        const testData = {"test_info": {"title": "Paid Error PART - (I)  SSC CGL PRE 2024", "duration": "10", "total_questions": 20, "max_marks": 40, "marks_per_question": 2.0, "negative_marks": 0.5}, "questions": [{"question_number": 1, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains an error.</strong> <br /> Mr. Abhilash and his family / have received / no informations / about the incident", "options": ["1) have received\n                                                    <input class=\"question_options0\" name=\"selected_option_0\" type=\"radio\" value=\"494569_120214\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) no informations\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_0\" type=\"radio\" value=\"494570_120214\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) about the incident.\n                                                    <input class=\"question_options2\" name=\"selected_option_0\" type=\"radio\" value=\"494571_120214\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Mr. Abhilash and his family\n                                                    <input class=\"question_options3\" name=\"selected_option_0\" type=\"radio\" value=\"494572_120214\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) no informations\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_0\" type=\"radio\" value=\"494570_120214\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) 'informations' के बदले 'information' का प्रयोग होगा क्योंकि 'information' एक Uncountable Noun है और इसका हमेशा Singular रूप में प्रयोग होता है; जैसे— They provided us with correct information. <br /> 'information' will be used instead of 'informations' because 'information' is an Uncountable Noun and is always used in the Singular form; Like— They provided us with correct information.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 2, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> My brother performed / extremely good / in the class test / held yesterday", "options": ["1) held yesterday\n                                                    <input class=\"question_options0\" name=\"selected_option_1\" type=\"radio\" value=\"494573_120215\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) in the class test\n                                                    <input class=\"question_options1\" name=\"selected_option_1\" type=\"radio\" value=\"494574_120215\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) My brother performed\n                                                    <input class=\"question_options2\" name=\"selected_option_1\" type=\"radio\" value=\"494575_120215\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) extremely good\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_1\" type=\"radio\" value=\"494576_120215\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) extremely good\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_1\" type=\"radio\" value=\"494576_120215\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) ‘extremely good' के बदले'extremely well'का प्रयोग होगा क्योंकि ‘good’ एक adjective है जो noun को modify करता है, जबकि यहाँ verb 'performed' को modify करने के लिए adverb 'well' का प्रयोग करना चाहिए; जैसे— He performed well in the exam. <br /> 'extremely well'will be used instead of 'extremely good' because 'good' is an adjective that modifies a noun, whereas here the adverb 'well' should be used to modify the verb 'performed'; Like— He performed well in the exam.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 3, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> Every students in the hostel decided to travel to Delhi to witness the Republic Day parade", "options": ["1) Republic Day Parade.\n                                                    <input class=\"question_options0\" name=\"selected_option_2\" type=\"radio\" value=\"494577_120216\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) to witness the\n                                                    <input class=\"question_options1\" name=\"selected_option_2\" type=\"radio\" value=\"494578_120216\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) decided to travel to Delhi\n                                                    <input class=\"question_options2\" name=\"selected_option_2\" type=\"radio\" value=\"494579_120216\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Every students in the hostel\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_2\" type=\"radio\" value=\"494580_120216\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) Every students in the hostel\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_2\" type=\"radio\" value=\"494580_120216\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "'D) Every students' के बदले'Every student'का प्रयोग होगा क्योंकि 'Every' के बाद Noun हमेशा Singular होता है; जैसे— Example: Every student in the class participated in the event. <br /> 'Every student'will be used instead of 'Every students' because after 'Every,' the noun is always Singular; Example: Every student in the class participated in the event.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 4, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> By this time next year / I will had graduated from college / and starting my first job / in the field of marketing.", "options": ["1) in the field of marketing\n                                                    <input class=\"question_options0\" name=\"selected_option_3\" type=\"radio\" value=\"494581_120217\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) and starting my first job\n                                                    <input class=\"question_options1\" name=\"selected_option_3\" type=\"radio\" value=\"494582_120217\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) By this time next year\n                                                    <input class=\"question_options2\" name=\"selected_option_3\" type=\"radio\" value=\"494583_120217\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) I will had graduated from college\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_3\" type=\"radio\" value=\"494584_120217\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) I will had graduated from college\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_3\" type=\"radio\" value=\"494584_120217\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'I will had graduated from college' के बदले'I will have graduated from college'का प्रयोग होगा क्योंकि 'will' के बाद हमेशा base form (have) का प्रयोग होता है। अतः 'had' गलत है। उदाहरण — By this time next year, I will have completed my studies. <br /> 'I will have graduated from college'will be used instead of 'I will had graduated from college' because 'will' is always followed by the base form of the verb (have). Thus, 'had' is incorrect. Example— By this time next year, I will have completed my studies.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 5, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> I are dancing with my husband at my sister’s wedding.  ", "options": ["1) husband at my\n                                                    <input class=\"question_options0\" name=\"selected_option_4\" type=\"radio\" value=\"494585_120218\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) sister’s wedding\n                                                    <input class=\"question_options1\" name=\"selected_option_4\" type=\"radio\" value=\"494586_120218\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) with my\n                                                    <input class=\"question_options2\" name=\"selected_option_4\" type=\"radio\" value=\"494587_120218\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) I are dancing\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_4\" type=\"radio\" value=\"494588_120218\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) I are dancing\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_4\" type=\"radio\" value=\"494588_120218\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'I are dancing' के बदले'I am dancing'का प्रयोग होगा क्योंकि Subject (I) के साथ Verb 'are' का प्रयोग करना गलत है। 'I' के साथ हमेशा 'am' का प्रयोग होता है; जैसे— I am going to the market. <br /> 'Iam dancing'will be used instead of 'I are dancing' because using the verb 'are' with the subject 'I' is incorrect. The verb 'am' should always be used with 'I'; Like— I am going to the market.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 6, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> The tea at this café is best than at the Costa Café in our office", "options": ["1) at the Costa Café\n                                                    <input class=\"question_options0\" name=\"selected_option_5\" type=\"radio\" value=\"494589_120219\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) The tea at this café\n                                                    <input class=\"question_options1\" name=\"selected_option_5\" type=\"radio\" value=\"494590_120219\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) is best than\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_5\" type=\"radio\" value=\"494591_120219\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) In our office.\n                                                    <input class=\"question_options3\" name=\"selected_option_5\" type=\"radio\" value=\"494592_120219\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) is best than\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_5\" type=\"radio\" value=\"494591_120219\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) is best than' के बदले'is better than'का प्रयोग होगा क्योंकि Comparative Degree का प्रयोग 'than' के साथ होता है। 'Best' Superlative Degree है, जिसे 'than' के साथ प्रयोग नहीं किया जा सकता है; जैसे— The tea at this café is better than at the Costa Café in our office. <br /> 'is better than' will be used instead of 'is best than' because the Comparative Degree is used with 'than'. 'Best' is a Superlative Degree, which cannot be used with 'than'; Like— The tea at this café is better than at the Costa Café in our office.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 7, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> After the concert was over, / they go to a restaurant, / had dinner together / and talked until midnight.", "options": ["1) they go to a restaurant,\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_6\" type=\"radio\" value=\"494593_120220\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) had dinner together\n                                                    <input class=\"question_options1\" name=\"selected_option_6\" type=\"radio\" value=\"494594_120220\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) and talked until midnight\n                                                    <input class=\"question_options2\" name=\"selected_option_6\" type=\"radio\" value=\"494595_120220\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) After the concert was over\n                                                    <input class=\"question_options3\" name=\"selected_option_6\" type=\"radio\" value=\"494596_120220\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) they go to a restaurant,\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_6\" type=\"radio\" value=\"494593_120220\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) ‘go' के बदले'went'का प्रयोग होगा क्योंकि ‘After the concert was over’ Clause में verb 'was' Past Tense में है अत: मुख्य Clause में भी Verb Past Tense में होगा; जैसे— After the meeting was over, they went home and rested. <br /> 'went'will be used instead of 'go' because in 'After the concert was over' clause the verb 'was' is in Past Tense, so in the main clause, the Verb should also be in Past Tense; Like— After the meeting was over, they went home and rested.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 8, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> Renewable energy / sources like solar and wind power / will replaced traditional fossil fuels / and help reduce carbon emissions", "options": ["1) and help reduce carbon emissions\n                                                    <input class=\"question_options0\" name=\"selected_option_7\" type=\"radio\" value=\"494597_120221\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) will replaced traditional fossil fuels\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_7\" type=\"radio\" value=\"494598_120221\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) sources like solar and wind power\n                                                    <input class=\"question_options2\" name=\"selected_option_7\" type=\"radio\" value=\"494599_120221\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Renewable energy\n                                                    <input class=\"question_options3\" name=\"selected_option_7\" type=\"radio\" value=\"494600_120221\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) will replaced traditional fossil fuels\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_7\" type=\"radio\" value=\"494598_120221\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) ‘will replaced' के बदले'will replace'का प्रयोग होगा क्योंकि Modal Verb ‘will’ के बाद हमेशा Verb का Base Form (Simple Form) प्रयुक्त होता है; जैसे— He will go to the market tomorrow. <br /> 'will replace'will be used instead of 'will replaced' because after the Modal Verb ‘will’, the Base Form (Simple Form) of the verb is always used; Like— He will go to the market tomorrow", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 9, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> Our family is planning / a trip to Europe next summer / where we should visit several famous / landmarks and enjoy local cuisine.", "options": ["1) Our family is planning\n                                                    <input class=\"question_options0\" name=\"selected_option_8\" type=\"radio\" value=\"494601_120222\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) a trip to Europe next summer\n                                                    <input class=\"question_options1\" name=\"selected_option_8\" type=\"radio\" value=\"494602_120222\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) landmarks and enjoy local cuisine\n                                                    <input class=\"question_options2\" name=\"selected_option_8\" type=\"radio\" value=\"494603_120222\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) where we should visit several famous\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_8\" type=\"radio\" value=\"494604_120222\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) where we should visit several famous\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_8\" type=\"radio\" value=\"494604_120222\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'should' के स्थान पर'will'का use होगा क्योंकि यहां भविष्य की योजना की बात की जा रही है, और 'should' का प्रयोग आमतौर पर सुझाव या कर्तव्य के लिए होता है, न कि भविष्य की योजनाओं के लिए। Example— Incorrect: where we should visit several famous landmarks. correct: where we will visit several famous landmarks. <br /> 'should' should be replaced with'will'because the sentence is discussing a future plan, and 'should' is typically used for suggestions or obligations, not for future intentions. Example— Incorrect: where we should visit several famous landmarks. Correct: where we will visit several famous landmarks.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 10, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> No other place in this country is so better as Gulmarg, Kashmir", "options": ["1) No other place\n                                                    <input class=\"question_options0\" name=\"selected_option_9\" type=\"radio\" value=\"494605_120223\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) in this country is\n                                                    <input class=\"question_options1\" name=\"selected_option_9\" type=\"radio\" value=\"494606_120223\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) so better as\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_9\" type=\"radio\" value=\"494607_120223\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Gulmarg, Kashmir\n                                                    <input class=\"question_options3\" name=\"selected_option_9\" type=\"radio\" value=\"494608_120223\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) so better as\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_9\" type=\"radio\" value=\"494607_120223\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) ‘so better as' के बदले'as good as'का प्रयोग होगा क्योंकि Comparative degree के लिए 'as...as' का प्रयोग किया जाता है, और 'better' Comparative degree के लिए उपयुक्त नहीं है। अतः सही वाक्य होगा: No other place in this country is as good as Gulmarg, Kashmir. <br /> 'as good as' will be used instead of 'so better as' because for comparative degree, 'as...as' is used, and 'better' is not appropriate in this construction. Thus, the correct sentence is: No other place in this country is as good as Gulmarg, Kashmir.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 11, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains a grammatical error.</strong> <br /> My sister, Juliet, / got married / as her / was 23.", "options": ["1) as her\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_10\" type=\"radio\" value=\"494609_120224\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) My sister, Juliet,\n                                                    <input class=\"question_options1\" name=\"selected_option_10\" type=\"radio\" value=\"494610_120224\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) got married\n                                                    <input class=\"question_options2\" name=\"selected_option_10\" type=\"radio\" value=\"494611_120224\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) was 23\n                                                    <input class=\"question_options3\" name=\"selected_option_10\" type=\"radio\" value=\"494612_120224\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) as her\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_10\" type=\"radio\" value=\"494609_120224\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) 'as her'के बदले 'when she' का use होगा क्योंकि 'as her' का use गलत है। यहाँ 'when she was 23' का use होना चाहिए क्योंकि यहाँ उम्र को दर्शाने के लिए 'when' और व्यक्ति को संदर्भित करने के लिए 'she' का प्रयोग किया जाता है, न कि 'her' का। <br /> 'when she' will be used instead of 'as her' because 'as her' is incorrect. The correct expression should be 'when she was 23' since 'when' is used to indicate the time (age) and 'she' is used to refer to the person, not 'her'.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 12, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> It is he who work for the company for more than a decade", "options": ["1) for the company\n                                                    <input class=\"question_options0\" name=\"selected_option_11\" type=\"radio\" value=\"494613_120225\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) for more than a decade\n                                                    <input class=\"question_options1\" name=\"selected_option_11\" type=\"radio\" value=\"494614_120225\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) It is he\n                                                    <input class=\"question_options2\" name=\"selected_option_11\" type=\"radio\" value=\"494615_120225\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) who work\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_11\" type=\"radio\" value=\"494616_120225\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) who work\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_11\" type=\"radio\" value=\"494616_120225\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) 'who work' के बदले'who works'का प्रयोग होगा क्योंकि Relative Pronoun 'who' यहाँ 'he' के लिए प्रयुक्त हुआ है, और 'he' एक Singular Subject है, इसलिए Verb भी Singular होगी; जैसे— It is he who works for the company for more than a decade. <br /> 'who works'will be used instead of 'who work' because the Relative Pronoun 'who' is referring to 'he', and 'he' is a Singular Subject, so the Verb should also be Singular; Like— It is he who works for the company for more than a decade.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 13, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> The windows / violent banged / during the / storm yesterday", "options": ["1) The windows\n                                                    <input class=\"question_options0\" name=\"selected_option_12\" type=\"radio\" value=\"494617_120226\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) storm yesterday.\n                                                    <input class=\"question_options1\" name=\"selected_option_12\" type=\"radio\" value=\"494618_120226\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) during the\n                                                    <input class=\"question_options2\" name=\"selected_option_12\" type=\"radio\" value=\"494619_120226\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) violent banged\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_12\" type=\"radio\" value=\"494620_120226\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) violent banged\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_12\" type=\"radio\" value=\"494620_120226\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) violent banged' के बदले'violently banged'का प्रयोग होगा क्योंकि 'violent' Adjective है और यहां Adverb 'violently' की आवश्यकता है, जो Verb 'banged' को Qualify करेगा; जैसे— The door violently shut in the wind. <br /> 'violently banged'will be used instead of 'violent banged' because 'violent' is an adjective, and here we need an adverb 'violently' to qualify the verb 'banged'; Like— The door violently shut in the wind", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 14, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> Rahul thinks he is as smarter as his friends in the class.", "options": ["1) his friends\n                                                    <input class=\"question_options0\" name=\"selected_option_13\" type=\"radio\" value=\"494621_120227\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) he is as smarter as\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_13\" type=\"radio\" value=\"494622_120227\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Rahul thinks\n                                                    <input class=\"question_options2\" name=\"selected_option_13\" type=\"radio\" value=\"494623_120227\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) in the class\n                                                    <input class=\"question_options3\" name=\"selected_option_13\" type=\"radio\" value=\"494624_120227\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) he is as smarter as\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_13\" type=\"radio\" value=\"494622_120227\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) ‘as smarter as' के बदले'smarter than'का use होगा क्योंकि 'as...as' का प्रयोग समानता दिखाने के लिए किया जाता है, जबकि 'than' का प्रयोग तुलना करने के लिए किया जाता है; जैसे— Rahul thinks he is smarter than his friends in the class. <br /> 'smarter than'will be used instead of 'as smarter as' because 'as...as' is used to show equality, whereas 'than' is used for comparison; like— Rahul thinks he is smarter than his friends in the class.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 15, "question_text": "<strong>The following sentence has been divided into parts. One of them may contain an error. Select the part that contains the error from the given options. If you don’t find any error, mark ‘No error’ as your answer.</strong> <br /> Neither my brother nor my brothers-in-law / attended the meeting / as his health is not more good.", "options": ["1) No error\n                                                    <input class=\"question_options0\" name=\"selected_option_14\" type=\"radio\" value=\"494625_120228\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) as his health is not more good\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_14\" type=\"radio\" value=\"494626_120228\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) attended the meeting\n                                                    <input class=\"question_options2\" name=\"selected_option_14\" type=\"radio\" value=\"494627_120228\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Neither my brother nor my brothers-in-law\n                                                    <input class=\"question_options3\" name=\"selected_option_14\" type=\"radio\" value=\"494628_120228\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) as his health is not more good\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_14\" type=\"radio\" value=\"494626_120228\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) 'more good'के बदले 'better' का use होगा क्योंकि 'better' Comparative Adjective है, जो कि 'good' की तुलना में सही रूप है। 'More good' गलत है। सही 'better' होगा; जैसे— His health is better now. <br /> 'better' will be used instead of 'more good' because 'better' is the correct comparative adjective form of 'good.' 'More good' is incorrect. The correct word is 'better'; like— His health is better now.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 16, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> Solutions to the country’s interior problems are still a long way away", "options": ["1) a long way away.\n                                                    <input class=\"question_options0\" name=\"selected_option_15\" type=\"radio\" value=\"494629_120229\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) the country’s interior\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_15\" type=\"radio\" value=\"494630_120229\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) problems are still\n                                                    <input class=\"question_options2\" name=\"selected_option_15\" type=\"radio\" value=\"494631_120229\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Solutions to\n                                                    <input class=\"question_options3\" name=\"selected_option_15\" type=\"radio\" value=\"494632_120229\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) the country’s interior\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_15\" type=\"radio\" value=\"494630_120229\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) 'interior' के बदले 'internal' का प्रयोग होगा क्योंकि 'interior' का मतलब होता है किसी चीज़ का भीतरी भाग, जबकि यहां संदर्भ 'country’s problems' के अंदरूनी (internal) मुद्दों का है। अत: सही शब्द 'internal' होगा; जैसे— The government is focusing on solving internal problems. <br /> 'internal' will be used instead of 'interior' because 'interior' refers to the inside part of something, whereas here the context is about the 'country’s problems,' which are internal issues. Therefore, the correct word is 'internal'; like— The government is focusing on solving internal problems.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 17, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains an error.</strong> <br /> They secret / decided / to leave / the town", "options": ["1) the town\n                                                    <input class=\"question_options0\" name=\"selected_option_16\" type=\"radio\" value=\"494633_120230\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) to leave\n                                                    <input class=\"question_options1\" name=\"selected_option_16\" type=\"radio\" value=\"494634_120230\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) decided\n                                                    <input class=\"question_options2\" name=\"selected_option_16\" type=\"radio\" value=\"494635_120230\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) They secret\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_16\" type=\"radio\" value=\"494636_120230\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) They secret\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_16\" type=\"radio\" value=\"494636_120230\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) ‘They secret' के बदले'secretly'का प्रयोग होगा क्योंकि 'secret' एक noun है और यहाँ adverb की आवश्यकता है, जो verb 'decided' को modify करे। सही शब्द 'secretly' होगा; जैसे— They secretly decided to leave the town. <br /> 'secretly'will be used instead of 'secret' because 'secret' is a noun, and here an adverb is required to modify the verb 'decided.' The correct word is 'secretly'; like— They secretly decided to leave the town.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 18, "question_text": "<strong>The following sentence has been divided into four segments. Identify the segment that contains an error.</strong> <br /> Mr. Surya / have no interior / motive in offering / you support.", "options": ["1) you support.\n                                                    <input class=\"question_options0\" name=\"selected_option_17\" type=\"radio\" value=\"494637_120231\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Mr. Surya\n                                                    <input class=\"question_options1\" name=\"selected_option_17\" type=\"radio\" value=\"494638_120231\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) have no interior\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_17\" type=\"radio\" value=\"494639_120231\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) motive in offering\n                                                    <input class=\"question_options3\" name=\"selected_option_17\" type=\"radio\" value=\"494640_120231\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) have no interior\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_17\" type=\"radio\" value=\"494639_120231\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) have' के बदले'has'का प्रयोग होगा क्योंकि Subject (Mr. Surya) Singular है, अतः Singular Verb 'has' का प्रयोग होगा। उदाहरण के लिए: It was Mr. Surya who has no interior motive in offering you support. <br /> 'has'will be used instead of 'have' because the Subject (Mr. Surya) is Singular, so Singular Verb 'has' will be used. For example: It was Mr. Surya who has no interior motive in offering you support.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 19, "question_text": "<strong>The following sentence has been split into four segments. Identify the segment that contains a grammatical error.</strong> <br /> By the end of / this month, he / will been working / for five years.", "options": ["1) will been working\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_18\" type=\"radio\" value=\"494641_120232\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) By the end of\n                                                    <input class=\"question_options1\" name=\"selected_option_18\" type=\"radio\" value=\"494642_120232\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) this month, he\n                                                    <input class=\"question_options2\" name=\"selected_option_18\" type=\"radio\" value=\"494643_120232\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) for five years\n                                                    <input class=\"question_options3\" name=\"selected_option_18\" type=\"radio\" value=\"494644_120232\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) will been working\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_18\" type=\"radio\" value=\"494641_120232\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) will been working' के बदले'will have been working'का प्रयोग होगा क्योंकि 'by the end of this month' भविष्य में किसी कार्य की समाप्ति दर्शा रहा है और Future Perfect Continuous Tense का प्रयोग किया जाएगा; जैसे— By the end of this month, he will have been working here for five years. <br /> 'will have been working'will be used instead of 'will been working' because 'by the end of this month' indicates the completion of an action in the future and Future Perfect Continuous Tense will be used; Like— By the end of this month, he will have been working here for five years.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 20, "question_text": "<strong>Parts of the following sentence have been given as options. Select the option that contains an error.</strong> <br /> I have the hundred reasons to not attend the meeting tomorrow", "options": ["1) the meeting\n                                                    <input class=\"question_options0\" name=\"selected_option_19\" type=\"radio\" value=\"494645_120233\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) I have the hundred reasons\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_19\" type=\"radio\" value=\"494646_120233\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) to not attend\n                                                    <input class=\"question_options2\" name=\"selected_option_19\" type=\"radio\" value=\"494647_120233\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Tomorrow\n                                                    <input class=\"question_options3\" name=\"selected_option_19\" type=\"radio\" value=\"494648_120233\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) I have the hundred reasons\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_19\" type=\"radio\" value=\"494646_120233\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B)‘the hundred reasons’के बदले‘a hundred reasons’का प्रयोग होगा क्योंकि 'hundred' जैसे शब्दों के पहले 'the' का प्रयोग तभी होता है जब संख्या विशेष रूप से जानी-पहचानी हो। सामान्य संदर्भ में,'a'का प्रयोग किया जाता है, जैसे—'a hundred,' 'a thousand.' <br /> •‘a hundred reasons’will be used instead of‘the hundred reasons’because'a'is used before numerical expressions like'a hundred,' 'a thousand,'when the number is indefinite or not specifically known. The definite article'the'is used only when referring to a specific, known quantity. <br /> Example:✅ I havea hundred reasonsto explain this.❌ I havethe hundred reasonsto explain this.", "marks": {"positive": 2.0, "negative": 0.5}}]};

        // Test state variables
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let bookmarkedQuestions = new Set();
        let timerInterval;
        let isDarkMode = false;
        let visitedQuestions = new Set();

        // Initialize the test
        function initializeTest() {
            // Set test title
            document.getElementById('test-title').textContent = testData.test_info.title;
            
            // Initialize user answers array
            userAnswers = Array(testData.questions.length).fill(null);
            
            // Setup question palette
            setupQuestionPalette();
            
            // Setup timer
            setupTimer();
            
            // Show first question
            showQuestion(0);
            
            // Setup event listeners
            setupEventListeners();
            
            // Make sure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function setupEventListeners() {
            document.getElementById('prev-btn').addEventListener('click', goToPreviousQuestion);
            document.getElementById('next-btn').addEventListener('click', goToNextQuestion);
            document.getElementById('submit-test').addEventListener('click', showReviewWarning);
            document.getElementById('bookmark-btn').addEventListener('click', toggleBookmark);
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

            // Question palette toggle functionality
            document.getElementById('palette-toggle').addEventListener('click', toggleQuestionPalette);

            // Add keyboard event listener to document
            document.addEventListener('keydown', handleKeyPress);

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterQuestions(e.target.dataset.filter);
                });
            });
        }

        function toggleQuestionPalette() {
            const palette = document.querySelector('.question-palette');
            const toggleBtn = document.getElementById('palette-toggle');
            
            if (palette.classList.contains('visible')) {
                // Hide palette with animation
                palette.style.transform = 'translateX(100%)';
                toggleBtn.classList.remove('active');
                setTimeout(() => {
                    palette.classList.remove('visible');
                }, 300);
            } else {
                // Show palette with animation
                palette.classList.add('visible');
                toggleBtn.classList.add('active');
                setTimeout(() => {
                    palette.style.transform = 'translateX(0)';
                }, 10);
            }
        }

        // Add display flex to palette toggle button when in mobile view
        function updatePaletteToggleDisplay() {
            const toggleBtn = document.getElementById('palette-toggle');
            if (window.innerWidth <= 768) {
                toggleBtn.style.display = 'flex';
            } else {
                toggleBtn.style.display = 'none';
            }
        }

        // Call on load and window resize
        window.addEventListener('load', updatePaletteToggleDisplay);
        window.addEventListener('resize', updatePaletteToggleDisplay);

        function handleKeyPress(event) {
            console.log('Key pressed:', event.key); // Add debug logging
            
            // Ignore keyboard shortcuts if user is typing in an input field
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }

            // Ignore keyboard shortcuts if test is submitted
            if (document.getElementById('result').style.display === 'block') {
                return;
            }

            // Prevent default behavior for arrow keys and numbers to avoid page scrolling
            if (['ArrowLeft', 'ArrowRight', '1', '2', '3', '4'].includes(event.key)) {
                event.preventDefault();
            }

            switch(event.key) {
                case 'ArrowLeft':
                    if (currentQuestionIndex > 0) {
                        goToPreviousQuestion();
                    }
                    break;
                case 'ArrowRight':
                    if (currentQuestionIndex < testData.questions.length - 1) {
                        goToNextQuestion();
                    }
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
                case 'Enter':
                    if (currentQuestionIndex === testData.questions.length - 1) {
                        showReviewWarning();
                    } else {
                        goToNextQuestion();
                    }
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                    const optionIndex = parseInt(event.key) - 1;
                    const options = document.querySelectorAll('.option');
                    if (options[optionIndex]) {
                        // Add visual feedback for option selection
                        options[optionIndex].classList.add('keyboard-selected');
                        
                        // Actually select the option
                        const radio = options[optionIndex].querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            userAnswers[currentQuestionIndex] = optionIndex + 1;
                            
                            // Update the option's visual state
                            options.forEach(opt => opt.classList.remove('selected'));
                            options[optionIndex].classList.add('selected');
                            
                            // Update the question palette
                            updateQuestionPalette();
                        }
                        
                        // Remove the selection effect after animation
                        setTimeout(() => {
                            options[optionIndex].classList.remove('keyboard-selected');
                        }, 200);
                    }
                    break;
            }
        }

        function setupQuestionPalette() {
            const palette = document.getElementById('question-palette');
            palette.innerHTML = '';
            
            for (let i = 0; i < testData.questions.length; i++) {
                const item = document.createElement('div');
                item.className = 'palette-item not-visited';
                item.textContent = i + 1;
                item.addEventListener('click', () => {
                    showQuestion(i);
                    // Close the palette if it's currently visible (for mobile view)
                    const paletteElement = document.querySelector('.question-palette');
                    if (paletteElement.classList.contains('visible')) {
                        toggleQuestionPalette();
                    }
                });
                palette.appendChild(item);
            }
            
            // Ensure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function updateQuestionPalette() {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                item.className = 'palette-item';
                
                // Only add status classes if the question has been visited
                if (visitedQuestions.has(index)) {
                    if (bookmarkedQuestions.has(index)) {
                        item.classList.add('marked-review');
                    } else if (userAnswers[index] !== null) {
                        item.classList.add('answered');
                    } else {
                        item.classList.add('not-answered');
                    }
                } else {
                    item.classList.add('not-visited');
                }
                
                if (index === currentQuestionIndex) {
                    item.classList.add('active');
                }
            });
        }

        function filterQuestions(filter) {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                const isMarkedReview = bookmarkedQuestions.has(index);
                const isAnswered = userAnswers[index] !== null;
                const isVisited = visitedQuestions.has(index);
                
                switch(filter) {
                    case 'answered':
                        item.style.display = isAnswered ? 'flex' : 'none';
                        break;
                    case 'not-answered':
                        item.style.display = (isVisited && !isAnswered) ? 'flex' : 'none';
                        break;
                    case 'marked-review':
                        item.style.display = isMarkedReview ? 'flex' : 'none';
                        break;
                    default:
                        item.style.display = 'flex';
                }
            });
        }
        
        function setupTimer() {
            const duration = parseFloat(testData.test_info.duration);
            let timeLeft = Math.floor(duration * 60);
            const timerElement = document.getElementById('timer');
            
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                if (timeLeft <= 300) { // 5 minutes warning
                    timerElement.classList.add('timer-warning');
                }
                
                timerElement.innerHTML = `
                    <i class="fas fa-clock"></i>
                    Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}
                `;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest();
                }
                
                timeLeft--;
            }, 1000);
        }
        
        function showQuestion(index) {
            currentQuestionIndex = index;
            // Mark question as visited when opened
            visitedQuestions.add(index);
            const question = testData.questions[index];
            const container = document.getElementById('current-question');
            
            // Add fade-out animation
            container.style.opacity = '0';
            container.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                container.innerHTML = `
                    <div class="question-container">
                        <div class="question-number">
                            <span>Question ${question.question_number} of ${testData.questions.length}</span>
                            <span class="marks-info">
                                <i class="fas fa-plus-circle"></i> ${question.marks.positive}
                                <i class="fas fa-minus-circle"></i> ${question.marks.negative}
                            </span>
                        </div>
                        <div class="question">${question.question_text}</div>
                        <div class="options">
                            ${question.options.map((option, optIndex) => `
                                <label class="option ${userAnswers[index] === optIndex + 1 ? 'selected' : ''}">
                                    <input type="radio" name="question${index}" value="${optIndex + 1}" 
                                        ${userAnswers[index] === optIndex + 1 ? 'checked' : ''}>
                                        <div class="option-content">
                                    <span class="option-number">${optIndex + 1}</span> ${option}
                                        </div>
                                </label>
                            `).join('')}
                        </div>
                        <div style="flex-grow: 1;"></div>
                    </div>
                `;
                
                // Update bookmark button
                const bookmarkBtn = document.getElementById('bookmark-btn');
                bookmarkBtn.classList.toggle('active', bookmarkedQuestions.has(index));
                bookmarkBtn.innerHTML = bookmarkedQuestions.has(index) 
                    ? '<i class="fas fa-flag"></i> Marked for Review'
                    : '<i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>';
                
                // Add event listeners to options
                const options = container.querySelectorAll('.option');
                    options.forEach((option, optIdx) => {
                    option.addEventListener('click', function() {
                        const radio = this.querySelector('input[type="radio"]');
                        radio.checked = true;
                        
                            options.forEach(opt => {
                                opt.classList.remove('selected');
                                opt.style.transform = 'translateX(0)';
                            });
                            
                            // Animate the selected option
                        this.classList.add('selected');
                            this.style.transform = 'translateX(10px)';
                        
                        userAnswers[index] = parseInt(radio.value);
                        updateQuestionPalette();

                            // Highlight the option number with a pulse animation
                        const optionNumber = this.querySelector('.option-number');
                        optionNumber.style.animation = 'pulse 0.5s ease';
                        setTimeout(() => {
                            optionNumber.style.animation = '';
                        }, 500);
                });

                        // Add a small delay to each option's appearance
                        option.style.opacity = '0';
                        option.style.transform = 'translateX(20px)';
                        setTimeout(() => {
                            option.style.opacity = '1';
                            option.style.transform = 'translateX(0)';
                        }, 100 + (optIdx * 50));
                    });
                    
                    // Fade in the content
                    setTimeout(() => {
                        container.style.opacity = '1';
                        container.style.transform = 'translateY(0)';
                    }, 50);
                
                // Update navigation buttons
                updateNavigationButtons();
                
                // Update question palette
                updateQuestionPalette();
                }, 150);
        }
        
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-test');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === testData.questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }
        
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        }
        
        function goToNextQuestion() {
            if (currentQuestionIndex < testData.questions.length - 1) {
                showQuestion(currentQuestionIndex + 1);
            }
        }

        function toggleBookmark() {
            const btn = document.getElementById('bookmark-btn');
            if (bookmarkedQuestions.has(currentQuestionIndex)) {
                bookmarkedQuestions.delete(currentQuestionIndex);
                btn.classList.remove('active');
                btn.innerHTML = `
                    <i class="far fa-flag"></i> 
                    Mark for Review <span class="shortcut-hint">(B)</span>
                `;
            } else {
                bookmarkedQuestions.add(currentQuestionIndex);
                btn.classList.add('active');
                btn.innerHTML = `
                    <i class="fas fa-flag"></i> 
                    Marked for Review
                `;
            }
            updateQuestionPalette();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.innerHTML = `<i class="fas fa-${isDarkMode ? 'sun' : 'moon'}"></i>`;
        }

        function showReviewWarning() {
            // Skip the warning and directly submit the test
            submitTest();
        }
        
        function submitTest() {
            // Add submission animation
            const testContainer = document.getElementById('test-container');
            const questionPalette = document.querySelector('.question-palette');
            const resultContainer = document.getElementById('result');
            
            // Animate test container sliding out
            testContainer.style.transition = 'all 0.5s var(--animation-bounce)';
            testContainer.style.transform = 'translateX(-50px)';
            testContainer.style.opacity = '0';
            
            // Animate question palette fading out
            questionPalette.style.transition = 'all 0.5s var(--animation-bounce)';
            questionPalette.style.transform = 'translateX(50px)';
            questionPalette.style.opacity = '0';
            
            // Clear the timer
            clearInterval(timerInterval);
            
            // Calculate results with a slight delay for animation
            setTimeout(() => {
            let score = 0;
            let correctCount = 0;
            let attemptedCount = 0;
            const reviewAnswers = [];
            
            // Calculate score and statistics
            testData.questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct_answer;
                
                if (userAnswer !== null) {
                    attemptedCount++;
                    if (isCorrect) {
                        score += question.marks.positive;
                        correctCount++;
                    } else {
                        score -= question.marks.negative;
                    }
                }
                
                reviewAnswers.push({
                    questionNumber: question.question_number,
                    questionText: question.question_text,
                    userChoice: userAnswer,
                    userChoiceText: userAnswer !== null ? question.options[userAnswer - 1] : 'Not answered',
                    correctAnswer: question.correct_answer,
                    correctAnswerText: question.correct_option,
                    isCorrect: isCorrect,
                    answered: userAnswer !== null
                });
            });
            
            // Update statistics
            document.getElementById('total-questions').textContent = testData.questions.length;
            document.getElementById('attempted-questions').textContent = attemptedCount;
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('accuracy').textContent = 
                `${Math.round((correctCount / (attemptedCount || 1)) * 100)}%`;
            
            // Display score
            document.getElementById('score').innerHTML = `
                <div style="font-size: 36px; color: var(--primary-color);">
                    ${score.toFixed(2)} / ${testData.questions.length * testData.questions[0].marks.positive}
                </div>
                <div style="color: var(--text-color); margin-top: 10px;">
                    Percentage: ${Math.round((score / (testData.questions.length * testData.questions[0].marks.positive)) * 100)}%
                </div>
            `;
            
            // Create performance chart
            const chartContainer = document.getElementById('performance-chart');
            chartContainer.innerHTML = ''; // Clear previous chart if any
            const ctx = document.createElement('canvas');
            chartContainer.appendChild(ctx);
                
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Correct', 'Incorrect', 'Not Attempted'],
                    datasets: [{
                        data: [
                            correctCount,
                            attemptedCount - correctCount,
                            testData.questions.length - attemptedCount
                        ],
                        backgroundColor: [
                                '#16a34a', // Fixed success green
                                '#dc2626', // Fixed error red
                                '#8b5cf6'  // Fixed purple for not attempted
                        ],
                            borderColor: 'var(--bg-color)',
                        borderWidth: 2,
                            hoverOffset: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'var(--bg-color)',
                                titleColor: 'var(--text-color)',
                                bodyColor: 'var(--text-color)',
                                borderColor: 'var(--border-color)',
                                borderWidth: 1,
                                padding: 12,
                                boxPadding: 6,
                                usePointStyle: true,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        let value = context.raw || 0;
                                        let total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        let percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            },
                            title: {
                                display: true,
                                text: 'Test Performance',
                                color: 'var(--text-color)',
                                font: {
                                    family: 'Inter, sans-serif',
                                    size: 16,
                                    weight: '600'
                                },
                                padding: {
                                    bottom: 15
                            }
                        }
                    },
                    cutout: '65%',
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                            duration: 1500,
                            easing: 'easeOutQuart'
                    }
                }
            });
                
                // Replace the chart's built-in legend with a custom one
                const customLegend = document.createElement('div');
                customLegend.className = 'custom-chart-legend';

                chartContainer.appendChild(customLegend);
            
            // Update the analytics container title
            document.querySelector('.analytics-container h3').innerHTML = 
                '<i class="fas fa-chart-pie"></i> Performance Analysis';
            
            // Add event listener to the download analysis buttons with a small delay to ensure UI is ready
            setTimeout(() => {
                const downloadBtn = document.getElementById('download-analysis');
                const bottomDownloadBtn = document.getElementById('bottom-download-analysis');
                if (downloadBtn) {
                    downloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
                if (bottomDownloadBtn) {
                    bottomDownloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
            }, 500);
            
            // Fix any palette toggle issue
            if (window.innerWidth <= 768) {
                const paletteToggle = document.getElementById('palette-toggle');
                if (paletteToggle) {
                    paletteToggle.style.display = 'flex';
                }
                
                // Add close button to palette if not exists
                const palette = document.querySelector('.question-palette');
                if (palette && !document.querySelector('.palette-close-btn')) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'palette-close-btn';
                    closeBtn.innerHTML = '<i class="fas fa-times"></i>';
                    closeBtn.addEventListener('click', toggleQuestionPalette);
                    
                    const paletteHeader = palette.querySelector('.palette-header');
                    if (paletteHeader) {
                        paletteHeader.appendChild(closeBtn);
                    }
                }
            }
            
                // Display answer review with staggered animation
            const answersDiv = document.getElementById('answers');
            answersDiv.innerHTML = '<h3>Answer Review:</h3>';
            
                reviewAnswers.forEach((answer, idx) => {
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-review';
                    answerDiv.style.opacity = '0';
                    answerDiv.style.transform = 'translateY(20px)';
                
                answerDiv.innerHTML = `
                    <p><strong>Question ${answer.questionNumber}:</strong> ${answer.questionText}</p>
                    <p class="${answer.answered ? (answer.isCorrect ? 'correct' : 'incorrect') : ''}">
                        Your answer: ${answer.userChoiceText}
                        ${answer.isCorrect ? '<i class="fas fa-check"></i>' : 
                        (answer.answered ? '<i class="fas fa-times"></i>' : '')}
                    </p>
                    ${!answer.isCorrect ? `
                        <p class="correct">
                            Correct answer: ${answer.correctAnswerText}
                            <i class="fas fa-check"></i>
                        </p>
                    ` : ''}
                    ${testData.questions[idx].explanation ? `
                        <div class="explanation">
                            <p><strong>Explanation:</strong></p>
                            <p>${testData.questions[idx].explanation}</p>
                        </div>
                    ` : ''}
                `;
                
                answersDiv.appendChild(answerDiv);
                    
                    // Animate each answer review with a staggered delay
                    setTimeout(() => {
                        answerDiv.style.transition = 'all 0.5s var(--animation-bounce)';
                        answerDiv.style.opacity = '1';
                        answerDiv.style.transform = 'translateY(0)';
                    }, 200 + (idx * 100));
                });
                
                // Show results container with animation
                resultContainer.style.display = 'block';
                resultContainer.style.opacity = '0';
                resultContainer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultContainer.style.transition = 'all 0.6s var(--animation-bounce)';
                    resultContainer.style.opacity = '1';
                    resultContainer.style.transform = 'translateY(0)';
                }, 100);
                
                // Hide test components
                testContainer.style.display = 'none';
                questionPalette.style.display = 'none';
                document.getElementById('palette-toggle').style.display = 'none';
            }, 600);
        }
        
        // Initialize the test
        initializeTest();

        // Add CSS transitions to the current-question container
        document.addEventListener('DOMContentLoaded', function() {
            const currentQuestion = document.getElementById('current-question');
            currentQuestion.style.transition = 'opacity 0.3s ease, transform 0.3s var(--animation-bounce)';
        });

        // Add CSS for smooth palette transitions
        document.addEventListener('DOMContentLoaded', function() {
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .question-palette {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                #palette-toggle {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                @media (max-width: 768px) {
                    .question-container:hover {
                        transform: translateY(-2px);
                    }
                    
                    .score-card:hover {
                        transform: translateY(-4px);
                    }
                    
                    .option:hover {
                        transform: translateX(4px);
                    }
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Add this after the Chart.js script tag but before your testData declaration
        document.addEventListener('DOMContentLoaded', function() {
            // Add custom styling for chart legend
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .chart-legend-item {
                    display: flex;
                    align-items: center;
                    margin: 8px 0;
                    font-weight: 600;
                }
                
                .legend-color {
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    margin-right: 8px;
                    display: inline-block;
                }
                
                .legend-correct {
                    background-color: #16a34a;
                }
                
                .legend-incorrect {
                    background-color: #dc2626;
                }
                
                .legend-not-attempted {
                    background-color: #8b5cf6;
                }
                
                .custom-chart-legend {
                    display: flex;
                    justify-content: center;
                    gap: 15px;
                    margin-top: 15px;
                    flex-wrap: wrap;
                }
                
                [data-theme="dark"] .legend-text {
                    color: #f1f5f9;
                }
                
                .chart-container canvas {
                    margin-bottom: 10px;
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Function to download test analysis as HTML file
        function downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount) {
            const maxScore = testData.questions.length * testData.questions[0].marks.positive;
            const percentage = Math.round((score / maxScore) * 100);

            // Create HTML content
            let htmlContent = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Test Analysis - ${testData.test_info.title}</title>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
                <style>
                    body {
                        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                        max-width: 900px;
                        margin: 0 auto;
                        padding: 20px;
                        color: #1e293b;
                        background-color: #f8fafc;
                        line-height: 1.6;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 15px;
                    }
                    .header h1 {
                        color: #4f46e5;
                        margin-bottom: 5px;
                    }
                    .header .date {
                        font-style: italic;
                        color: #64748b;
                    }
                    .summary {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                        gap: 20px;
                        margin-bottom: 30px;
                    }
                    .summary-card {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 15px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        text-align: center;
                        border: 1px solid #e2e8f0;
                    }
                    .summary-card h3 {
                        margin-top: 0;
                        margin-bottom: 10px;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .summary-card .value {
                        font-size: 24px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight {
                        background-color: #f3f4f6;
                        padding: 30px;
                        border-radius: 8px;
                        text-align: center;
                        margin-bottom: 30px;
                        border: 1px solid #e5e7eb;
                    }
                    .score-highlight .score {
                        font-size: 48px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight .percentage {
                        font-size: 18px;
                        color: #64748b;
                    }
                    .question-review {
                        margin-bottom: 30px;
                    }
                    .question {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 20px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        margin-bottom: 15px;
                        border: 1px solid #e2e8f0;
                    }
                    .question-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 10px;
                        padding-bottom: 10px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .question-text {
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer {
                        margin-bottom: 5px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer.correct {
                        color: #16a34a;
                    }
                    .user-answer.incorrect {
                        color: #dc2626;
                    }
                    .correct-answer {
                        color: #16a34a;
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation {
                        background-color: #f8fafc;
                        padding: 15px;
                        border-radius: 8px;
                        border-left: 4px solid #4f46e5;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation-title {
                        font-weight: bold;
                        margin-bottom: 5px;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 40px;
                        padding-top: 20px;
                        border-top: 1px solid #e2e8f0;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .unattempted {
                        color: #8b5cf6;
                    }
                    @media print {
                        body {
                            background-color: white;
                        }
                        .question, .summary-card, .score-highlight {
                            break-inside: avoid;
                        }
                    }
                    /* Responsive fixes */
                    @media (max-width: 768px) {
                        body {
                            padding: 10px;
                        }
                        .summary {
                            grid-template-columns: 1fr;
                        }
                        .score-highlight .score {
                            font-size: 36px;
                        }
                        .question-header {
                            flex-direction: column;
                            align-items: flex-start;
                        }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>${testData.test_info.title}</h1>
                    <div class="date">Generated on: ${new Date().toLocaleString()}</div>
                </div>
                
                <div class="score-highlight">
                    <div class="score">${score.toFixed(2)} / ${maxScore}</div>
                    <div class="percentage">Percentage: ${percentage}%</div>
                </div>
                
                <div class="summary">
                    <div class="summary-card">
                        <h3>Total Questions</h3>
                        <div class="value">${testData.questions.length}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Attempted</h3>
                        <div class="value">${attemptedCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Correct</h3>
                        <div class="value">${correctCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Accuracy</h3>
                        <div class="value">${Math.round((correctCount / (attemptedCount || 1)) * 100)}%</div>
                    </div>
                </div>
                
                <h2>Question Review</h2>
                <div class="question-review">
            `;

            // Add each question and answer to the HTML content
            reviewAnswers.forEach((answer, idx) => {
                const question = testData.questions[idx];
                htmlContent += `
                    <div class="question">
                        <div class="question-header">
                            <strong>Question ${answer.questionNumber}</strong>
                            <span>${answer.isCorrect ? '+' : (answer.answered ? '-' : '0')}${question.marks.positive} marks</span>
                        </div>
                        <div class="question-text">${answer.questionText}</div>
                        <div class="user-answer ${answer.isCorrect ? 'correct' : (answer.answered ? 'incorrect' : 'unattempted')}">
                            <strong>${answer.answered ? 'Your answer: ' : 'Not attempted'}</strong> 
                            ${answer.answered ? answer.userChoiceText : ''}
                            ${answer.isCorrect ? ' ✓' : (answer.answered ? ' ✗' : '')}
                        </div>
                        ${!answer.isCorrect ? `
                            <div class="correct-answer">
                                <strong>Correct answer:</strong> ${answer.correctAnswerText}
                            </div>
                        ` : ''}
                        ${question.explanation ? `
                            <div class="explanation">
                                <div class="explanation-title">Explanation:</div>
                                <div>${question.explanation}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            // Close HTML content
            htmlContent += `
                </div>
                
                <div class="footer">
                    <p>&copy; 2025 KUNAL Test Platform. All rights reserved.</p>
                    <p>Created by @finallygotnirvana</p>
                </div>
            </body>
            </html>
            `;

            // Create a download link
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            
            // Format date for filename
            const date = new Date();
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            
            downloadLink.download = `Test_Analysis_${formattedDate}.html`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }

        document.addEventListener('keydown', function(e) {
            // Prevent default behavior for arrow keys
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight' || e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
            }

            switch(e.key) {
                case 'ArrowLeft':
                    goToPreviousQuestion();
                    break;
                case 'ArrowRight':
                    goToNextQuestion();
                    break;
                case 'ArrowUp':
                case 'ArrowDown':
                    // Get all options for the current question
                    const options = document.querySelectorAll('.option');
                    if (options.length === 0) return;

                    // Find currently selected option
                    let currentIndex = Array.from(options).findIndex(opt => opt.classList.contains('selected'));
                    
                    // Calculate new index
                    if (e.key === 'ArrowUp') {
                        currentIndex = currentIndex <= 0 ? options.length - 1 : currentIndex - 1;
                    } else {
                        currentIndex = currentIndex >= options.length - 1 ? 0 : currentIndex + 1;
                    }

                    // Select the new option
                    options.forEach(opt => opt.classList.remove('selected'));
                    options[currentIndex].classList.add('selected');
                    options[currentIndex].querySelector('input[type="radio"]').checked = true;
                    
                    // Update user answer
                    userAnswers[currentQuestionIndex] = currentIndex + 1;
                    updateQuestionPalette();
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Test</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5; /* Improved indigo */
            --secondary-color: #4338ca;
            --success-color: #16a34a; /* Brighter green for better contrast */
            --danger-color: #dc2626;
            --warning-color: #0369a1;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-color: #1e293b;
            --bg-color: #ffffff;
            --muted-text: #64748b;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
        }

        /* Add custom scrollbar styling */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Add responsive styles for mobile */
        @media screen and (max-width: 768px) {
            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                top: auto;
                z-index: 1000;
                max-height: 50vh;
                margin: 0;
                border-radius: 16px 16px 0 0;
            }

            .palette-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 10px;
            }

            .palette-item {
                width: 100%;
                height: 36px;
            }
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.12);
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --button-hover-brightness: 0.9;
            --transition-speed: 0.3s;
            --chart-color-1: #4f46e5;
            --chart-color-2: #f43f5e;
            --chart-color-3: #8b5cf6;
            --chart-color-4: #10b981;
            --chart-color-5: #f59e0b;
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        [data-theme="dark"] {
            --primary-color: #6366f1; /* Brighter indigo for dark mode */
            --secondary-color: #818cf8;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #0ea5e9;
            --light-bg: #0f172a;
            --border-color: #1e293b;
            --text-color: #f1f5f9;
            --bg-color: #1e293b;
            --muted-text: #94a3b8;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.6);
            --button-hover-brightness: 1.1;
            --chart-color-1: #818cf8;
            --chart-color-2: #fb7185;
            --chart-color-3: #a78bfa;
            --chart-color-4: #34d399;
            --chart-color-5: #fbbf24;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: var(--font-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--light-bg);
            line-height: 1.5;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.5s ease;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.03) 0%, rgba(16, 185, 129, 0.03) 100%);
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(34, 197, 94, 0.05) 100%);
        }
        
        .container {
            background-color: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
        }

        .container:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .test-layout {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .question-palette {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 16px;
            position: sticky;
            top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.4s var(--animation-bounce), box-shadow 0.3s ease;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--light-bg);
        }

        /* Custom scrollbar for webkit browsers */
        .question-palette::-webkit-scrollbar {
            width: 8px;
        }

        .question-palette::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        .question-palette::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        .question-palette:hover {
            box-shadow: var(--shadow-lg);
        }

        .palette-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .palette-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-weight: 500;
            min-width: unset;
            box-shadow: none;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filter-btn.active:hover {
            filter: brightness(var(--button-hover-brightness));
        }

        .palette-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .palette-item {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
            color: var(--text-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }

        .palette-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .palette-item.not-visited {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .palette-item.answered {
            background: #16a34a;
            color: white;
            border-color: #15803d;
        }

        .palette-item.marked-review {
            background: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 700;
        }

        .palette-item.not-answered {
            background: #dc2626;
            color: white;
            border-color: #b91c1c;
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .palette-item.active::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid currentColor;
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.5; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--border-color), transparent);
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-color), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }
        
        .question-container {
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            background-color: var(--bg-color);
            box-shadow: var(--shadow-md);
            min-height: 500px;
            display: flex;
            flex-direction: column;
        }

        .question-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }
        
        .question-number {
            font-size: 14px;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-color);
            font-weight: 500;
            animation: fadeIn 0.5s ease;
        }
        
        .options {
            flex-grow: 1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .option {
            display: block;
            margin: 12px 0;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            color: var(--text-color);
            background-color: var(--bg-color);
            font-size: 14px;
            font-weight: 400;
            user-select: none; /* Prevent text selection */
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: rgba(79, 70, 229, 0.05);
            transition: width 0.3s ease;
            z-index: 0;
        }
        
        .option:hover::before {
            width: 100%;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            transform: translateX(8px);
        }
        
        .option:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .option.selected {
            background-color: rgba(79, 70, 229, 0.15);
            border-color: var(--primary-color);
            transform: translateX(10px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        .option.selected::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background-color: var(--primary-color);
            border-radius: 4px 0 0 4px;
        }
        
        .option-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            /* Added flex-wrap for better text handling */
            flex-wrap: wrap;
            width: 100%;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 35px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            position: sticky;
            bottom: 20px;
            background-color: var(--bg-color);
            padding-bottom: 10px;
            z-index: 5;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 22px;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            min-width: 100px;
            letter-spacing: 0.3px;
            background-color: var(--primary-color);
            outline: none;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
            z-index: 0;
        }

        button:hover::before {
            width: 150%;
            height: 150%;
        }

        button:active::before {
            background: rgba(0, 0, 0, 0.1);
            width: 150%;
            height: 150%;
        }
        
        button:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.25);
            filter: brightness(var(--button-hover-brightness));
        }
        
        button:active {
            transform: translateY(-2px);
            transition: all 0.1s;
        }

        button i {
            font-size: 18px;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 1;
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button:hover i {
            transform: scale(1.2);
        }

        button:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        button:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
            box-shadow: none;
        }

        button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        button:disabled::before {
            display: none;
        }

        #bookmark-btn {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            font-weight: 500;
            transition: all 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover {
            border-color: #eab308;
            color: #eab308;
            background-color: rgba(234, 179, 8, 0.08);
        }

        #bookmark-btn.active {
            background-color: #eab308;
            color: #1e293b;
            border-color: #ca8a04;
            font-weight: 600;
        }

        #bookmark-btn.active:hover {
            background-color: #ca8a04;
            color: #1e293b;
        }

        #bookmark-btn i {
            transition: transform 0.3s var(--animation-bounce);
        }

        #bookmark-btn:hover i {
            transform: translateY(-2px);
        }
        
        #submit-test {
            background-color: var(--success-color);
            font-weight: 600;
            min-width: 140px;
        }
        
        #submit-test:hover {
            box-shadow: 0 6px 15px rgba(22, 163, 74, 0.25);
        }
        
        #prev-btn, #next-btn {
            background-color: var(--primary-color);
            min-width: 130px;
        }
        
        #timer {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: rgba(79, 70, 229, 0.08);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .timer-warning {
            color: var(--danger-color);
            animation: pulse 1.5s infinite;
            background: rgba(220, 38, 38, 0.1);
            border-color: var(--danger-color);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        #result {
            display: none;
            color: var(--text-color);
        }
        
        #score {
            font-size: 32px;
            text-align: center;
            margin: 35px 0;
            padding: 30px;
            background: linear-gradient(to right, rgba(79, 70, 229, 0.08), rgba(139, 92, 246, 0.08));
            border-radius: 12px;
            line-height: 1.6;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.8s var(--animation-bounce);
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #score::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(79, 70, 229, 0.1), transparent 60%);
            z-index: 0;
        }

        #score div {
            position: relative;
            z-index: 1;
        }

        .score-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .score-card {
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--animation-bounce);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--chart-color-1), var(--chart-color-3));
            transition: height 0.3s ease;
        }

        .score-card:hover::before {
            height: 6px;
        }

        .score-card:nth-child(2)::before {
            background: linear-gradient(to right, var(--chart-color-2), var(--chart-color-4));
        }

        .score-card:nth-child(3)::before {
            background: linear-gradient(to right, var(--chart-color-3), var(--chart-color-5));
        }

        .score-card:nth-child(4)::before {
            background: linear-gradient(to right, var(--chart-color-4), var(--chart-color-1));
        }

        .score-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .score-card h3 {
            margin: 0 0 16px 0;
            color: var(--text-color);
            font-size: 14px;
            font-weight: 600;
            line-height: 1.4;
            max-width: 100%;
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        .score-card div {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, var(--chart-color-1), var(--chart-color-3));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            line-height: 1.2;
            margin: 0;
            padding: 0;
        }

        .score-card:hover div {
            transform: scale(1.1);
        }

        .score-card:nth-child(2) div {
            background: linear-gradient(45deg, var(--chart-color-2), var(--chart-color-4));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(3) div {
            background: linear-gradient(45deg, var(--chart-color-3), var(--chart-color-5));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-card:nth-child(4) div {
            background: linear-gradient(45deg, var(--chart-color-4), var(--chart-color-1));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .chart-container {
            height: 350px;
            margin: 25px 0;
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            animation: fadeScale 1s ease;
            position: relative;
        }

        @keyframes fadeScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(79, 70, 229, 0.03), transparent 70%);
            z-index: 0;
            border-radius: 12px;
        }

        .shortcut-hint {
            font-size: 12px;
            color: var(--muted-text);
            font-weight: normal;
        }

        .keyboard-shortcuts {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .keyboard-shortcuts span {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            padding: 3px 6px;
            border-radius: 6px;
            font-size: 11px;
            color: var(--muted-text);
            cursor: help;
            font-weight: 500;
        }

        .keyboard-shortcuts span:hover {
            background: var(--border-color);
            color: var(--text-color);
        }

        .option-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 26px;
            height: 26px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .option:hover .option-number {
            transform: scale(1.1);
        }

        .option.selected .option-number {
            background: var(--success-color);
            box-shadow: 0 0 10px rgba(22, 163, 74, 0.4);
        }

        .palette-toggle-btn {
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(79, 70, 229, 0.25);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            padding: 0;
            min-width: unset;
        }

        .palette-toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.2), transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .palette-toggle-btn:hover::before {
            opacity: 1;
        }

        .palette-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(79, 70, 229, 0.4);
        }

        .palette-toggle-btn:active {
            transform: scale(0.95);
        }

        .palette-toggle-btn.active {
            transform: rotate(45deg);
        }

        .palette-toggle-btn i {
            position: relative;
            z-index: 1;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .palette-toggle-btn:hover i {
            transform: rotate(-15deg);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 13px;
            }

            .container {
                padding: 15px;
                border-radius: 10px;
            }

            .test-layout {
                grid-template-columns: 1fr;
            }

            .question-palette {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: 0;
                z-index: 1000;
                border-radius: 0;
                overflow-y: auto;
                transform: translateX(100%);
                transition: transform 0.3s var(--animation-bounce);
                padding: 20px;
            }

            .question-palette.visible {
                transform: translateX(0);
            }

            .palette-toggle-btn {
                width: 48px;
                height: 48px;
                bottom: 16px;
                right: 16px;
                font-size: 18px;
            }

            .palette-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .palette-close-btn {
                background: transparent;
                border: none;
                color: var(--text-color);
                font-size: 20px;
                cursor: pointer;
                min-width: auto;
                padding: 10px;
                box-shadow: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
            }

            .palette-close-btn:hover {
                color: var(--primary-color);
                background: rgba(79, 70, 229, 0.1);
            }

            .score-details {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
                gap: 12px;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
                position: sticky;
                bottom: 10px;
                padding-bottom: 5px;
            }
            
            .question-container {
                min-height: 400px;
            }

            .bookmark-btn {
                width: 100%;
                justify-content: center;
            }

            button {
                width: 100%;
                justify-content: center;
                padding: 14px 20px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding-bottom: 12px;
            }

            .header-controls {
                width: 100%;
                justify-content: center;
            }

            .theme-toggle {
                width: 40px;
                height: 40px;
                padding: 10px;
            }

            .keyboard-shortcuts {
                display: none;
            }

            #timer {
                padding: 8px 14px;
                font-size: 13px;
                width: 100%;
                justify-content: center;
            }

            .question {
                font-size: 15px;
            }

            .option {
                padding: 14px;
                margin: 10px 0;
                word-break: break-word; /* Added to prevent text overflow */
            }

            .option:hover {
                transform: translateX(4px);
            }

            .option.selected {
                transform: translateX(8px);
            }

            /* Fix for mobile devices where hover states persist */
            @media (hover: none) {
                button:hover, .option:hover, .score-card:hover, .answer-review:hover {
                    transform: none;
                }

                button:active, .option:active {
                    transform: scale(0.98);
                }
            }

            /* Enhance readability on mobile */
            #score {
                font-size: 24px;
                padding: 20px;
            }

            .chart-container {
                height: 300px;
            }

            .custom-chart-legend {
                flex-direction: column;
                align-items: flex-start;
                padding-left: 20px;
            }

            /* Prevent mobile zoom when tapping buttons/options */
            button, .option, input, select {
                font-size: 16px;
            }

            .palette-filters {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 10px;
                justify-content: center;
                -webkit-overflow-scrolling: touch;
                gap: 8px;
            }
            
            .filter-btn {
                font-size: 11px;
                padding: 5px 10px;
                white-space: nowrap;
                flex-shrink: 0; /* Prevent filters from shrinking */
            }
            
            /* Fix download button on mobile */
            .download-btn {
                width: 100%;
                min-width: 100%;
                margin-top: 15px;
                padding: 14px 10px;
                white-space: normal; /* Allow text to wrap */
            }
            
            /* Option text can wrap now */
            .option-content {
                flex-wrap: wrap;
                width: 100%;
            }
            
            /* Ensure option number doesn't shrink */
            .option-number {
                flex-shrink: 0;
                margin-bottom: 5px;
            }
        }

        .answer-review {
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 15px;
            background: var(--bg-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .answer-review:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(79, 70, 229, 0.1);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .explanation strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        .explanation p {
            margin: 8px 0;
            line-height: 1.6;
            color: var(--text-color);
        }

        [data-theme="dark"] .explanation {
            background: rgba(99, 102, 241, 0.1);
        }

        .correct {
            color: var(--success-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(22, 163, 74, 0.1);
            transition: all 0.3s ease;
        }

        .correct:hover {
            background-color: rgba(22, 163, 74, 0.15);
        }

        .incorrect {
            color: var(--danger-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: rgba(220, 38, 38, 0.1);
            transition: all 0.3s ease;
        }

        .incorrect:hover {
            background-color: rgba(220, 38, 38, 0.15);
        }

        .marks-info {
                font-size: 12px;
            color: var(--muted-text);
            font-style: normal;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 10px;
            background-color: rgba(100, 116, 139, 0.08);
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .marks-info:hover {
            background-color: rgba(100, 116, 139, 0.12);
        }

        .question-number {
            font-weight: 600;
            color: var(--text-color);
            font-size: 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border-color);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            min-width: unset;
            width: 38px;
            height: 38px;
        }

        .theme-toggle:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(79, 70, 229, 0.08);
            transform: rotate(180deg);
        }

        .review-warning {
            background-color: rgba(220, 38, 38, 0.08);
            border: 1px solid var(--danger-color);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-color);
            box-shadow: var(--shadow-md);
            animation: slideDown 0.5s var(--animation-bounce);
        }

        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .review-warning i {
            color: var(--danger-color);
            font-size: 28px;
            animation: shake 1s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        #review-list {
            margin-top: 25px;
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .review-item:hover {
            background: rgba(79, 70, 229, 0.05);
            transform: translateX(5px);
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .analytics-container {
            margin-top: 35px;
            padding: 25px;
            border-radius: 12px;
            background: var(--bg-color);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s var(--animation-bounce);
        }

        .analytics-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .analytics-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .analytics-container h3 i {
            font-size: 20px;
            color: var(--chart-color-1);
        }

        .palette-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(79, 70, 229, 0.3);
            z-index: 1;
        }

        .keyboard-pressed {
            transform: scale(0.95) translateY(0) !important;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1) !important;
            opacity: 0.9;
            transition: all 0.1s ease !important;
        }
        
        .keyboard-selected {
            background-color: rgba(79, 70, 229, 0.15);
            transform: translateX(5px);
            transition: all 0.1s ease;
        }
        
        @keyframes buttonPulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .review-warning {
            animation: none;
            transition: all 0.3s var(--animation-bounce);
        }
        
        .fade-out {
            opacity: 0 !important;
            transform: translateY(-10px) !important;
        }
        
        .review-warning button {
            flex: 1;
            min-width: 120px;
        }
        
        @media (max-width: 768px) {
            .review-warning {
                flex-direction: column;
                padding: 20px;
            }
            
            .review-warning i {
                margin-bottom: 10px;
                align-self: center;
            }
        }

        .custom-chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 24px;
            flex-wrap: wrap;
            padding: 0 16px;
        }

        .chart-legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            display: inline-block;
            flex-shrink: 0;
        }

        .legend-text {
            color: var(--text-color);
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .score-card {
                padding: 20px;
                min-height: 100px;
            }

            .score-card h3 {
                font-size: 13px;
                margin-bottom: 12px;
            }

            .score-card div {
                font-size: 24px;
            }

            .custom-chart-legend {
                gap: 12px;
                margin-top: 20px;
                padding: 0 12px;
            }

            .chart-legend-item {
                font-size: 12px;
            }

            .legend-color {
                width: 10px;
                height: 10px;
                margin-right: 6px;
            }
        }

        /* Add new styles for creator info */
        .creator-info {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            border-radius: 12px;
            margin-bottom: 20px;
            gap: 15px;
            border: 1px solid var(--border-color);
        }

        .creator-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .creator-logo:hover {
            transform: scale(1.1);
        }

        .creator-tg {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .creator-tg:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .creator-tg i {
            color: #229ED9;
            font-size: 20px;
        }

        [data-theme="dark"] .creator-info {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(34, 197, 94, 0.1) 100%);
        }

        .download-btn {
            background: linear-gradient(145deg, var(--chart-color-1), var(--chart-color-3));
            margin-top: 20px;
            width: auto;
            padding: 12px 24px;
            transition: all 0.3s var(--animation-bounce);
            box-shadow: var(--shadow-md);
            font-weight: 600;
            letter-spacing: 0.5px;
            min-width: 200px;
            color: white;
            /* Ensure text doesn't overflow */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .download-btn:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .download-btn i {
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="creator-info">
        <a href="https://t.me/finallygotnirvana" target="_blank" class="creator-tg">
            <i class="fab fa-telegram"></i>
            Created by @finallygotnirvana
        </a>
        <img src="https://i.ibb.co/0ysnvFZS/0x1900-000000-80-0-0.jpg" alt="Creator Logo" class="creator-logo">
    </div>

    <div class="test-layout">
        <div id="test-container" class="container">
            <div class="header">
                <h1 id="test-title">Mock Test</h1>
                <div class="header-controls">
                    <div id="timer"><i class="fas fa-clock"></i> Time Remaining: 00:00</div>
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <div id="current-question"></div>
            
            <div class="navigation">
                <div class="nav-buttons">
                    <button id="prev-btn" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                    <button id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button id="submit-test" style="display: none;"><i class="fas fa-check"></i> Submit Test</button>
                </div>
                <button id="bookmark-btn">
                    <i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>
                </button>
            </div>
        </div>

        <div class="question-palette container">
            <div class="palette-header">
                <h3>Question Palette</h3>
            </div>
            <div class="palette-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="answered">Answered</button>
                <button class="filter-btn" data-filter="not-answered">Not Answered</button>
                <button class="filter-btn" data-filter="marked-review">Marked for Review</button>
            </div>
            <div class="palette-grid" id="question-palette"></div>
        </div>
    </div>

    <button class="palette-toggle-btn" id="palette-toggle">
        <i class="fas fa-th"></i>
    </button>

            <div id="result" class="container">
            <div id="score"></div>
            <div class="score-details">
                <div class="score-card">
                    <h3>Total Questions</h3>
                    <div id="total-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Attempted</h3>
                    <div id="attempted-questions">0</div>
                </div>
                <div class="score-card">
                    <h3>Correct</h3>
                    <div id="correct-answers">0</div>
                </div>
                <div class="score-card">
                    <h3>Accuracy</h3>
                    <div id="accuracy">0%</div>
                </div>
            </div>
            <div class="analytics-container">
                <h3>Performance Analysis</h3>
                <div class="chart-container" id="performance-chart"></div>
                <button id="download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
            <div id="answers"></div>
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                <button id="bottom-download-analysis" class="download-btn"><i class="fas fa-download"></i> Download Analysis</button>
            </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Test data
        const testData = {"test_info": {"title": "Paid Voice PART - (II) SSC CGL PRE 2024", "duration": "10", "total_questions": 20, "max_marks": 40, "marks_per_question": 2.0, "negative_marks": 0.5}, "questions": [{"question_number": 1, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> The children have made the box.", "options": ["1) Children had made the box.\n                                                    <input class=\"question_options0\" name=\"selected_option_0\" type=\"radio\" value=\"494873_120290\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) The box is being made by the children.\n                                                    <input class=\"question_options1\" name=\"selected_option_0\" type=\"radio\" value=\"494874_120290\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) The box has been made by the children.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_0\" type=\"radio\" value=\"494875_120290\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) The box had been made by the children\n                                                    <input class=\"question_options3\" name=\"selected_option_0\" type=\"radio\" value=\"494876_120290\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) The box has been made by the children.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_0\" type=\"radio\" value=\"494875_120290\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) The box has been made by the children. <br /> Active Voice को Passive Voice में बदलते समय, object वाक्य की शुरुआत में आता है और क्रिया (verb) को Passive Voice के रूप में बदल दिया जाता है। यहाँ \"have made\" को Passive Voice में \"has been made\" में बदल दिया जाता है। जैसे— To Be → has been V³ → made <br /> Note: \"The box\" को object के रूप में शुरुआत में रखा गया और \"has been made\" का प्रयोग Passive Voice में किया गया। \"by the children\" को अंत में जोड़ा गया। <br /> Explanation in English: <br /> When converting Active Voice into Passive Voice, the object is placed at the beginning of the sentence, and the verb is changed into its Passive Voice form. In this case, \"have made\" is changed to \"has been made.\" For example: → To Be → has been → V³ → made <br /> Note: \"The box\" is placed as the object, and \"has been made\" is used in Passive Voice. \"by the children\" is added at the end.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 2, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> They are organising a concert for charity", "options": ["1) A concert is being organised by them for charity.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_1\" type=\"radio\" value=\"494877_120291\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) They are organising a charity concert.\n                                                    <input class=\"question_options1\" name=\"selected_option_1\" type=\"radio\" value=\"494878_120291\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) A concert for charity is organising by them.\n                                                    <input class=\"question_options2\" name=\"selected_option_1\" type=\"radio\" value=\"494879_120291\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) They are being organised a concert for charity\n                                                    <input class=\"question_options3\" name=\"selected_option_1\" type=\"radio\" value=\"494880_120291\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) A concert is being organised by them for charity.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_1\" type=\"radio\" value=\"494877_120291\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) A concert is being organised by them for charity. <br /> Active Voice को Passive Voice में बदलते समय, object वाक्य की शुरुआत में आता है और क्रिया (verb) को Passive Voice के रूप में बदल दिया जाता है। यहाँ \"are organising\" को Passive Voice में \"is being organised\" में बदल दिया जाता है। जैसे— To Be → is being V³ → organised <br /> Note:\"A concert\" को object के रूप में शुरुआत में रखा गया और \"is being organised\" का प्रयोग Passive Voice में किया गया। \"by them\" को अंत में जोड़ा गया। <br /> Explanation in English: <br /> When converting Active Voice into Passive Voice, the object is placed at the beginning of the sentence, and the verb is changed into its Passive Voice form. In this case, \"are organising\" is changed to \"is being organised.\" For example: → To Be → is being → V³ → organised <br /> Note: \"A concert\" is placed as the object, and \"is being organised\" is used in Passive Voice. \"by them\" is added at the end.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 3, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> Martha made pancakes yesterday.", "options": ["1) Pancakes had been made by Martha yesterday.\n                                                    <input class=\"question_options0\" name=\"selected_option_2\" type=\"radio\" value=\"494885_120293\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Pancakes were made by Martha yesterday.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_2\" type=\"radio\" value=\"494886_120293\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Pancakes were being made by Martha yesterday.\n                                                    <input class=\"question_options2\" name=\"selected_option_2\" type=\"radio\" value=\"494887_120293\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Pancakes was made by Martha yesterday.\n                                                    <input class=\"question_options3\" name=\"selected_option_2\" type=\"radio\" value=\"494888_120293\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) Pancakes were made by Martha yesterday.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_2\" type=\"radio\" value=\"494886_120293\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) Pancakes were made by Martha yesterday <br /> Active Voice को Passive Voice में बदलते समय, object वाक्य की शुरुआत में आता है और क्रिया (verb) को Passive Voice के रूप में बदल दिया जाता है। यहाँ \"made\" को Passive Voice में \"were made\" में बदल दिया जाता है। जैसे— To Be → wereV³ → made <br /> Note: \"Pancakes\" को object के रूप में शुरुआत में रखा गया और \"were made\" का प्रयोग Passive Voice में किया गया। \"by Martha\" को अंत में जोड़ा गया और \"yesterday\" समयसूचक शब्द के रूप में वाक्य के अंत में रहा। <br /> Explanation in English: <br /> When converting Active Voice into Passive Voice, the object is placed at the beginning of the sentence, and the verb is changed into its Passive Voice form. In this case, \"made\" is changed to \"were made.\" For example: → To Be → were→ V³ → made <br /> Note: \"Pancakes\" is placed as the object, and \"were made\" is used in Passive Voice. \"by Martha\" is added at the end, and \"yesterday\" remains as the time indicator.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 4, "question_text": "<strong>Select the option that expresses the given sentence in active voice.</strong> <br /> I will be gifted a fancy doll by them the next day.", "options": ["1) They will gift me a fancy doll tomorrow.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_3\" type=\"radio\" value=\"494889_120294\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) They gift me a fancy doll the previous day.\n                                                    <input class=\"question_options1\" name=\"selected_option_3\" type=\"radio\" value=\"494890_120294\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) They gifted me a fancy doll yesterday.\n                                                    <input class=\"question_options2\" name=\"selected_option_3\" type=\"radio\" value=\"494891_120294\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) They are gifting me a fancy doll the next day.\n                                                    <input class=\"question_options3\" name=\"selected_option_3\" type=\"radio\" value=\"494892_120294\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) They will gift me a fancy doll tomorrow.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_3\" type=\"radio\" value=\"494889_120294\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) They will gift me a fancy doll tomorrow <br /> Passive Voice को Active Voice में बदलते समय, subject वाक्य की शुरुआत में आता है और क्रिया (verb) को Active Voice के रूप में बदल दिया जाता है। Passive Voice में \"will be gifted\" को Active Voice में \"will gift\" में बदल दिया जाता है, और समयसूचक शब्द \"the next day\" को \"tomorrow\" में बदल दिया जाता है। जैसे— To Be → will gift Object → me <br /> Note: \"They\" को subject के रूप में starting में रखा गया और \"will gift\" का प्रयोग Active Voice में किया गया। \"me\" को object के रूप में और \"tomorrow\" को समयसूचक शब्द के रूप में रखा गया। <br /> Explanation in English: <br /> When converting Passive Voice into Active Voice, the subject appears at the beginning of the sentence, and the verb is changed into its Active Voice form. In this case, \"will be gifted\" is changed to \"will gift,\" and the time indicator \"the next day\" is changed to \"tomorrow.\" For example:→ To Be → will gift → Object → me <br /> Note: \"They\" is placed as the subject, \"will gift\" is used as the verb, \"me\" is the object, and \"tomorrow\" is used as the time indicator.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 5, "question_text": "<strong>Select the option that expresses the following sentence in passive voice.</strong> <br /> Sonam does not like bananas.", "options": ["1) Bananas had not been liked by Sonam.\n                                                    <input class=\"question_options0\" name=\"selected_option_4\" type=\"radio\" value=\"494901_120297\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Bananas have not been liked by Sonam.\n                                                    <input class=\"question_options1\" name=\"selected_option_4\" type=\"radio\" value=\"494902_120297\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Bananas are not liked by Sonam.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_4\" type=\"radio\" value=\"494903_120297\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Banana is not liked by Sonam\n                                                    <input class=\"question_options3\" name=\"selected_option_4\" type=\"radio\" value=\"494904_120297\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) Bananas are not liked by Sonam.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_4\" type=\"radio\" value=\"494903_120297\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) Bananas are not liked by Sonam. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। वाक्य ‘Sonam does not like bananas’ को Passive Voice में बदलते समय Object ‘bananas’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘does not like’ को Passive Voice में बदलकर ‘are not liked’ किया जाता है, क्योंकि यह Simple Present Tense का वाक्य है। Subject ‘Sonam’ को अंत में ‘by Sonam’ के रूप में रखा गया है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘Sonam does not like bananas’, the object ‘bananas’ is placed at the beginning, and the verb ‘does not like’ is changed to ‘are not liked’ in Passive Voice. The subject ‘Sonam’ is placed at the end as ‘by Sonam’. Therefore, the correct answer is (Bananas are not liked by Sonam).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 6, "question_text": "​​​​​​<strong>Select the option that expresses the given sentence in passive voice</strong> <br /> Someone has taken my secret diary.", "options": ["1) My secret diary has to be taken by someone.\n                                                    <input class=\"question_options0\" name=\"selected_option_5\" type=\"radio\" value=\"494905_120298\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) My secret diary had been taken by someone.\n                                                    <input class=\"question_options1\" name=\"selected_option_5\" type=\"radio\" value=\"494906_120298\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) My secret diary will have been taken by someone.\n                                                    <input class=\"question_options2\" name=\"selected_option_5\" type=\"radio\" value=\"494907_120298\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) My secret diary has been taken by someone\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_5\" type=\"radio\" value=\"494908_120298\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) My secret diary has been taken by someone\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_5\" type=\"radio\" value=\"494908_120298\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) My secret diary has been taken by someone <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। वाक्य ‘Someone has taken my secret diary’ को Passive Voice में बदलते समय Object ‘my secret diary’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘has taken’ को Passive Voice में बदलकर ‘has been taken’ किया जाता है। Subject ‘someone’ को अंत में ‘by someone’ के रूप में रखा गया है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘Someone has taken my secret diary’, the object ‘my secret diary’ is placed at the beginning, and the verb ‘has taken’ is changed to ‘has been taken’. The subject ‘someone’ is placed at the end as ‘by someone’.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 7, "question_text": "<strong>Select the option that expresses the given sentence in active voice.</strong> <br /> The drug pedlar was arrested by the narcotics team.", "options": ["1) The narcotics team arrest the drug pedlar.\n                                                    <input class=\"question_options0\" name=\"selected_option_6\" type=\"radio\" value=\"494917_120301\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) The narcotics team has arrested the drug pedlar.\n                                                    <input class=\"question_options1\" name=\"selected_option_6\" type=\"radio\" value=\"494918_120301\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) The narcotics team was arrested the drug pedlar.\n                                                    <input class=\"question_options2\" name=\"selected_option_6\" type=\"radio\" value=\"494919_120301\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) The narcotics team arrested the drug pedlar\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_6\" type=\"radio\" value=\"494920_120301\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) The narcotics team arrested the drug pedlar\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_6\" type=\"radio\" value=\"494920_120301\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) The narcotics team arrested the drug pedlar <br /> Passive Voice को Active Voice में बदलने के लिए (Subject + Verb + Object) का प्रयोग किया जाता है। वाक्य ‘The drug pedlar was arrested by the narcotics team’ को Active Voice में बदलते समय ‘the narcotics team’ को Subject के रूप में और ‘the drug pedlar’ को Object के रूप में रखा गया है। Passive Verb ‘was arrested’ को Active Voice में बदलकर ‘arrested’ किया गया है। अतः सही उत्तर (The narcotics team arrested the drug pedlar) है। <br /> To convert Passive Voice into Active Voice, the structure (Subject + Verb + Object) is used. In the sentence ‘The drug pedlar was arrested by the narcotics team’, the subject ‘the narcotics team’ is placed first, followed by the verb ‘arrested’, and the object ‘the drug pedlar’. Therefore, the correct answer is (The narcotics team arrested the drug pedlar).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 8, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> Scientists were conducting experiments on the newly discovered species", "options": ["1) The newly discovered species has been conducting experiments by scientists.\n                                                    <input class=\"question_options0\" name=\"selected_option_7\" type=\"radio\" value=\"494921_120302\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Experiments were being conducted on the newly discovered species by scientists.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_7\" type=\"radio\" value=\"494922_120302\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) The newly discovered species has been experimented on by scientists.\n                                                    <input class=\"question_options2\" name=\"selected_option_7\" type=\"radio\" value=\"494923_120302\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Experiments on the newly discovered species had been conducted by the scientists\n                                                    <input class=\"question_options3\" name=\"selected_option_7\" type=\"radio\" value=\"494924_120302\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) Experiments were being conducted on the newly discovered species by scientists.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_7\" type=\"radio\" value=\"494922_120302\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) Experiments were being conducted on the newly discovered species by scientists. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। वाक्य ‘Scientists were conducting experiments on the newly discovered species’ को Passive Voice में बदलते समय Object ‘experiments’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘were conducting’ को Passive Voice में बदलकर ‘were being conducted’ किया गया है। Subject ‘scientists’ को अंत में ‘by scientists’ के रूप में रखा गया है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘Scientists were conducting experiments on the newly discovered species’, the object ‘experiments’ is placed at the beginning, and the verb ‘were conducting’ is changed to ‘were being conducted’. The subject ‘scientists’ is placed at the end as ‘by scientists’. Therefore, the correct answer is (Experiments were being conducted on the newly discovered species by scientists).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 9, "question_text": "<strong>Select the option that correctly expresses the given sentence in passive voice.</strong> <br /> I will never overlook this creativity.", "options": ["1) This creativity will never be overlooked by me.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_8\" type=\"radio\" value=\"494929_120304\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) This creativity will be overlooked by me.\n                                                    <input class=\"question_options1\" name=\"selected_option_8\" type=\"radio\" value=\"494930_120304\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) This creativity will being overlooked by me.\n                                                    <input class=\"question_options2\" name=\"selected_option_8\" type=\"radio\" value=\"494931_120304\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) This creativity will not never be overlooked by me.\n                                                    <input class=\"question_options3\" name=\"selected_option_8\" type=\"radio\" value=\"494932_120304\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) This creativity will never be overlooked by me.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_8\" type=\"radio\" value=\"494929_120304\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) This creativity will never be overlooked by me. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। वाक्य ‘I will never overlook this creativity’ को Passive Voice में बदलते समय Object ‘this creativity’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘will overlook’ को Passive Voice में बदलकर ‘will be overlooked’ किया गया है, और ‘by me’ को वाक्य के अंत में रखा गया है। साथ ही, ‘never’ को उसी स्थान पर रखा गया है। अतः सही उत्तर (This creativity will never be overlooked by me) है। <br /> To convert Active Voice to Passive Voice, the formula (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘I will never overlook this creativity’, the object ‘this creativity’ is placed at the beginning, the verb ‘will overlook’ is changed to ‘will be overlooked’ in Passive Voice, and ‘by me’ is added at the end. The word ‘never’ remains in its original position. Therefore, the correct answer is (This creativity will never be overlooked by me).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 10, "question_text": "<strong>Select the option that correctly expresses the following sentence in passive voice.</strong> <br /> Who invited you to this party?", "options": ["1) By whom you are invited to this party?\n                                                    <input class=\"question_options0\" name=\"selected_option_9\" type=\"radio\" value=\"494933_120305\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) By whom are you invited to this party?\n                                                    <input class=\"question_options1\" name=\"selected_option_9\" type=\"radio\" value=\"494934_120305\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) By whom you were invited to this party?\n                                                    <input class=\"question_options2\" name=\"selected_option_9\" type=\"radio\" value=\"494935_120305\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) By whom were you invited to this party?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_9\" type=\"radio\" value=\"494936_120305\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) By whom were you invited to this party?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_9\" type=\"radio\" value=\"494936_120305\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) By whom were you invited to this party? <br /> Active Voice में प्रश्न को Passive Voice में बदलने के लिए (By whom + Auxiliary Verb + Subject + Past Participle) का प्रयोग किया जाता है। वाक्य ‘Who invited you to this party?’ को Passive Voice में बदलते समय Verb ‘invited’ को Passive Voice में बदलकर ‘were invited’ किया जाता है, और प्रश्न वाक्य की संरचना को बनाए रखने के लिए ‘By whom’ का प्रयोग किया जाता है। अतः सही उत्तर (By whom were you invited to this party?) है। <br /> To convert a question from Active Voice to Passive Voice, the structure (By whom + Auxiliary Verb + Subject + Past Participle) is used. In the sentence ‘Who invited you to this party?’, the verb ‘invited’ is changed to ‘were invited’ in Passive Voice, and the question is maintained by using ‘By whom’. Therefore, the correct answer is (By whom were you invited to this party?).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 11, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> He will give a lecture on personality development.", "options": ["1) A lecture on personality development will be giving by him.\n                                                    <input class=\"question_options0\" name=\"selected_option_10\" type=\"radio\" value=\"494949_120309\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) A lecture on personality development can be given by him.\n                                                    <input class=\"question_options1\" name=\"selected_option_10\" type=\"radio\" value=\"494950_120309\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) A lecture will be given on personality development.\n                                                    <input class=\"question_options2\" name=\"selected_option_10\" type=\"radio\" value=\"494951_120309\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) A lecture on personality development will be given by him.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_10\" type=\"radio\" value=\"494952_120309\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) A lecture on personality development will be given by him.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_10\" type=\"radio\" value=\"494952_120309\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) A lecture on personality development will be given by him <br /> Active Voice को Passive Voice में बदलते समय, object sentence की शुरुआत में आता है और क्रिया (verb) को Passive Voice के रूप में बदल दिया जाता है। यहाँ \"will give\" को Passive Voice में \"will be given\" में बदल दिया जाता है। जैसे— To Be → will be V³ → given <br /> Note: \"A lecture on personality development\" को object के रूप में शुरुआत में रखा गया और \"will be given\" का प्रयोग Passive Voice में किया गया। \"by him\" को अंत में जोड़ा गया। <br /> Explanation in English: <br /> When converting Active Voice into Passive Voice, the object is placed at the beginning of the sentence, and the verb is changed into its Passive Voice form. In this case, \"will give\" is changed to \"will be given.\" For example:→ To Be → will be → V³ → given <br /> Note: \"A lecture on personality development\" is placed as the object, and \"will be given\" is used in Passive Voice. \"by him\" is added at the end.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 12, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> His behaviour vexes me sometimes.", "options": ["1) I am sometimes vexed by his behaviour.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_11\" type=\"radio\" value=\"494953_120310\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) His behaviour is vexed.\n                                                    <input class=\"question_options1\" name=\"selected_option_11\" type=\"radio\" value=\"494954_120310\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Sometimes he vexes me with his behaviour.\n                                                    <input class=\"question_options2\" name=\"selected_option_11\" type=\"radio\" value=\"494955_120310\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) He is being vexing me with his behaviour\n                                                    <input class=\"question_options3\" name=\"selected_option_11\" type=\"radio\" value=\"494956_120310\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 1, "correct_option": "1) I am sometimes vexed by his behaviour.\n                                                    <input checked=\"checked\" class=\"question_options0\" name=\"selected_option_11\" type=\"radio\" value=\"494953_120310\"/>\n<span class=\"checkmark radio_check0\"></span>", "explanation": "A) I am sometimes vexed by his behaviour <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। sentence ‘His behaviour vexes me sometimes’ को Passive Voice में बदलते समय Object ‘me’ को Subject के रूप में रखा गया है। Verb ‘vexes’ को Passive Voice में बदलकर ‘am vexed’ किया गया है, और ‘by his behaviour’ को वाक्य के अंत में रखा गया है। Time Expression ‘sometimes’ को sentence में उचित स्थान पर रखा गया है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘His behaviour vexes me sometimes’, the object ‘me’ is placed as the subject, the verb ‘vexes’ is changed to ‘am vexed’, and ‘by his behaviour’ is added at the end. The time expression ‘sometimes’ is placed appropriately.", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 13, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> They have built a new bridge across the river.", "options": ["1) A new bridge has built across the river by them.\n                                                    <input class=\"question_options0\" name=\"selected_option_12\" type=\"radio\" value=\"494969_120314\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) The river has been built a new bridge by them.\n                                                    <input class=\"question_options1\" name=\"selected_option_12\" type=\"radio\" value=\"494970_120314\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) A new bridge has been built across the river by them.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_12\" type=\"radio\" value=\"494971_120314\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) A new bridge by them has been built across the river.\n                                                    <input class=\"question_options3\" name=\"selected_option_12\" type=\"radio\" value=\"494972_120314\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) A new bridge has been built across the river by them.\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_12\" type=\"radio\" value=\"494971_120314\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) A new bridge has been built across the river by them. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। sentence ‘They have built a new bridge across the river’ को Passive Voice में बदलते समय Object ‘a new bridge’ को sentence की शुरुआत में रखा जाता है। Verb ‘have built’ को Passive Voice में बदलकर ‘has been built’ किया जाता है, और Subject ‘they’ को अंत में ‘by them’ के रूप में रखा जाता है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘They have built a new bridge across the river’, the object ‘a new bridge’ is placed at the beginning, the verb ‘have built’ is changed to ‘has been built’, and the subject ‘they’ is placed at the end as ‘by them’", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 14, "question_text": "<strong>Select the option that expresses the given sentence in passive voice</strong>. <br /> They are building a new hospital in the city.", "options": ["1) A new hospital will be built in the city by them.\n                                                    <input class=\"question_options0\" name=\"selected_option_13\" type=\"radio\" value=\"494973_120315\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) A new hospital is being built in the city by them.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_13\" type=\"radio\" value=\"494974_120315\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) A new hospital was built in the city by them.\n                                                    <input class=\"question_options2\" name=\"selected_option_13\" type=\"radio\" value=\"494975_120315\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) A new hospital has been built in the city by them\n                                                    <input class=\"question_options3\" name=\"selected_option_13\" type=\"radio\" value=\"494976_120315\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) A new hospital is being built in the city by them.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_13\" type=\"radio\" value=\"494974_120315\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) A new hospital is being built in the city by them. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Being + Past Participle + by + Subject) का use किया जाता है, जब sentence Continuous Tense में हो। वाक्य ‘They are building a new hospital in the city’ को Passive Voice में बदलते समय Object ‘a new hospital’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘are building’ को Passive Voice में बदलकर ‘is being built’ किया जाता है, और Subject ‘they’ को अंत में ‘by them’ के रूप में रखा गया है। <br /> To convert Active Voice into Passive Voice for a Continuous Tense, the structure (Object + Auxiliary Verb + Being + Past Participle + by + Subject) is used. In the sentence ‘They are building a new hospital in the city’, the object ‘a new hospital’ is placed at the beginning, and the verb ‘are building’ is changed to ‘is being built’. The subject ‘they’ is placed at the end as ‘by them’. Therefore, the correct answer is (A new hospital is being built in the city by them).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 15, "question_text": "<strong>Select the option that expresses the given sentence in active voice.</strong> <br /> Were the plants being grafted by the gardener?", "options": ["1) Were the plants grafting the gardener?\n                                                    <input class=\"question_options0\" name=\"selected_option_14\" type=\"radio\" value=\"494985_120318\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Were the gardener grafting the plants?\n                                                    <input class=\"question_options1\" name=\"selected_option_14\" type=\"radio\" value=\"494986_120318\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Was the gardener grafting the plants?\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_14\" type=\"radio\" value=\"494987_120318\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Was the gardener grafted the plants?\n                                                    <input class=\"question_options3\" name=\"selected_option_14\" type=\"radio\" value=\"494988_120318\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) Was the gardener grafting the plants?\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_14\" type=\"radio\" value=\"494987_120318\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) Was the gardener grafting the plants?Passive Voice को Active Voice में बदलने के लिए (Subject + Auxiliary Verb + Verb + Object) का प्रयोग किया जाता है। Sentence ‘Were the plants being grafted by the gardener?’ को Active Voice में बदलते समय Subject ‘the gardener’ को sentence की शुरुआत में रखा जाता है। Passive Verb ‘were being grafted’ को Active Voice में बदलकर ‘was grafting’ किया जाता है, क्योंकि यह Past Continuous Tense का sentence है। Object ‘the plants’ को sentence के अंत में रखा जाता है। <br /> To convert Passive Voice into Active Voice in the Past Continuous Tense, the structure (Subject + Auxiliary Verb + Verb + Object) is used. In the sentence ‘Were the plants being grafted by the gardener?’, the subject ‘the gardener’ is placed at the beginning, and the passive verb ‘were being grafted’ is changed to ‘was grafting’. The object ‘the plants’ is placed at the end. Therefore, the correct answer is (Was the gardener grafting the plants?).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 16, "question_text": "<strong>Select the option that expresses the given sentence in active voice.</strong> <br /> By whom were you injured?", "options": ["1) Who had been injuring you?\n                                                    <input class=\"question_options0\" name=\"selected_option_15\" type=\"radio\" value=\"494989_120319\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Who has injured you?\n                                                    <input class=\"question_options1\" name=\"selected_option_15\" type=\"radio\" value=\"494990_120319\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Who had injured you?\n                                                    <input class=\"question_options2\" name=\"selected_option_15\" type=\"radio\" value=\"494991_120319\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Who injured you?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_15\" type=\"radio\" value=\"494992_120319\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) Who injured you?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_15\" type=\"radio\" value=\"494992_120319\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D)Who injured you?Passive Voice को Active Voice में बदलने के लिए (Question Word + Verb + Subject) का प्रयोग किया जाता है। sentence ‘By whom were you injured?’ को Active Voice में बदलते समय ‘By whom’ को ‘Who’ में बदल दिया जाता है, और Passive Verb ‘were injured’ को Active Voice में ‘injured’ किया जाता है। चूंकि यह Simple Past Tense का sentence है, Verb ‘injured’ को Past Simple में वैसा ही रखा जाता है। <br /> To convert Passive Voice into Active Voice for questions, the structure (Question Word + Verb + Subject) is used. In the sentence ‘By whom were you injured?’, ‘By whom’ is changed to ‘Who’, and the passive verb ‘were injured’ is changed to ‘injured’ in the Simple Past Tense. Therefore, the correct answer is (Who injured you?).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 17, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> Dipesh will send Rakesh away to college for certain reasons.", "options": ["1) Rakesh would be sent away to college for certain reasons by Dipesh.\n                                                    <input class=\"question_options0\" name=\"selected_option_16\" type=\"radio\" value=\"494997_120321\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Rakesh will have to be sent away to college for certain reasons by Dipesh.\n                                                    <input class=\"question_options1\" name=\"selected_option_16\" type=\"radio\" value=\"494998_120321\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Rakesh would have been sent away to college for certain reasons by Dipesh.\n                                                    <input class=\"question_options2\" name=\"selected_option_16\" type=\"radio\" value=\"494999_120321\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Rakesh will be sent away to college for certain reasons by Dipesh.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_16\" type=\"radio\" value=\"495000_120321\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) Rakesh will be sent away to college for certain reasons by Dipesh.\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_16\" type=\"radio\" value=\"495000_120321\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) Rakesh will be sent away to college for certain reasons by Dipesh. <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Past Participle + by + Subject) का प्रयोग किया जाता है। sentence ‘Dipesh will send Rakesh away to college for certain reasons’ को Passive Voice में बदलते समय Object ‘Rakesh’ को sentence की शुरुआत में रखा जाता है। Verb ‘will send’ को Passive Voice में बदलकर ‘will be sent’ किया जाता है। Subject ‘Dipesh’ को अंत में ‘by Dipesh’ के रूप में रखा जाता है। <br /> To convert Active Voice into Passive Voice, the structure (Object + Auxiliary Verb + Past Participle + by + Subject) is used. In the sentence ‘Dipesh will send Rakesh away to college for certain reasons’, the object ‘Rakesh’ is placed at the beginning, and the verb ‘will send’ is changed to ‘will be sent’. The subject ‘Dipesh’ is placed at the end as ‘by Dipesh’. Therefore, the correct answer is (Rakesh will be sent away to college for certain reasons by Dipesh).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 18, "question_text": "<strong>Select the option that expresses the given sentence in active voice.</strong> <br /> Why are you repeatedly called by her?", "options": ["1) Why had she called you repeatedly?\n                                                    <input class=\"question_options0\" name=\"selected_option_17\" type=\"radio\" value=\"495001_120322\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Why was she calling you repeatedly?\n                                                    <input class=\"question_options1\" name=\"selected_option_17\" type=\"radio\" value=\"495002_120322\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Why she calls you repeatedly?\n                                                    <input class=\"question_options2\" name=\"selected_option_17\" type=\"radio\" value=\"495003_120322\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) Why does she call you repeatedly?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_17\" type=\"radio\" value=\"495004_120322\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 4, "correct_option": "4) Why does she call you repeatedly?\n                                                    <input checked=\"checked\" class=\"question_options3\" name=\"selected_option_17\" type=\"radio\" value=\"495004_120322\"/>\n<span class=\"checkmark radio_check3\"></span>", "explanation": "D) Why does she call you repeatedly? <br /> Passive Voice को Active Voice में बदलने के लिए (Question Word + Auxiliary Verb + Subject + Base Form of Verb + Object) का प्रयोग किया जाता है। sentence ‘Why are you repeatedly called by her?’ को Active Voice में बदलते समय ‘you’ को Object के रूप में और ‘her’ को Subject के रूप में इस्तेमाल किया जाता है। Passive Verb ‘are called’ को Active Voice में बदलकर ‘does call’ किया जाता है, क्योंकि यह Present Simple Tense का वाक्य है और ‘repeatedly’ को वाक्य में उसी स्थान पर रखा जाता है। <br /> To convert Passive Voice into Active Voice, the structure (Question Word + Auxiliary Verb + Subject + Base Form of Verb + Object) is used. In the sentence ‘Why are you repeatedly called by her?’, ‘you’ becomes the object, and ‘her’ is changed to the subject ‘she’. The passive verb ‘are called’ is converted to ‘does call’ in the Present Simple Tense, with ‘repeatedly’ remaining in the same position. Therefore, the correct answer is (Why does she call you repeatedly?).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 19, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> The tutor was not teaching the student.", "options": ["1) The student was teaching the tutor.\n                                                    <input class=\"question_options0\" name=\"selected_option_18\" type=\"radio\" value=\"495017_120326\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) The student was not being taught by the tutor.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_18\" type=\"radio\" value=\"495018_120326\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) The student was not being teaching by the tutor.\n                                                    <input class=\"question_options2\" name=\"selected_option_18\" type=\"radio\" value=\"495019_120326\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) The student was not taught by the tutor\n                                                    <input class=\"question_options3\" name=\"selected_option_18\" type=\"radio\" value=\"495020_120326\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 2, "correct_option": "2) The student was not being taught by the tutor.\n                                                    <input checked=\"checked\" class=\"question_options1\" name=\"selected_option_18\" type=\"radio\" value=\"495018_120326\"/>\n<span class=\"checkmark radio_check1\"></span>", "explanation": "B) The student was not being taught by the tutor <br /> Active Voice को Passive Voice में बदलने के लिए (Object + Auxiliary Verb + Being + Past Participle + by + Subject) का प्रयोग किया जाता है, जब वाक्य Past Continuous Tense में हो। वाक्य ‘The tutor was not teaching the student’ को Passive Voice में बदलते समय Object ‘the student’ को वाक्य की शुरुआत में रखा जाता है। Verb ‘was not teaching’ को Passive Voice में बदलकर ‘was not being taught’ किया जाता है। Subject ‘the tutor’ को अंत में ‘by the tutor’ के रूप में रखा जाता है। <br /> To convert Active Voice into Passive Voice in the Past Continuous Tense, the structure (Object + Auxiliary Verb + Being + Past Participle + by + Subject) is used. In the sentence ‘The tutor was not teaching the student’, the object ‘the student’ is placed at the beginning, and the verb ‘was not teaching’ is changed to ‘was not being taught’. The subject ‘the tutor’ is placed at the end as ‘by the tutor’. Therefore, the correct answer is (The student was not being taught by the tutor).", "marks": {"positive": 2.0, "negative": 0.5}}, {"question_number": 20, "question_text": "<strong>Select the option that expresses the given sentence in passive voice.</strong> <br /> Can you compose an inspiring poem?", "options": ["1) Can an inspiring poem be composed?\n                                                    <input class=\"question_options0\" name=\"selected_option_19\" type=\"radio\" value=\"495021_120327\"/>\n<span class=\"checkmark radio_check0\"></span>", "2) Can an inspiring poem by you composed?\n                                                    <input class=\"question_options1\" name=\"selected_option_19\" type=\"radio\" value=\"495022_120327\"/>\n<span class=\"checkmark radio_check1\"></span>", "3) Can an inspiring poem be composed by you?\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_19\" type=\"radio\" value=\"495023_120327\"/>\n<span class=\"checkmark radio_check2\"></span>", "4) An inspiring poem can be composed by you.\n                                                    <input class=\"question_options3\" name=\"selected_option_19\" type=\"radio\" value=\"495024_120327\"/>\n<span class=\"checkmark radio_check3\"></span>"], "correct_answer": 3, "correct_option": "3) Can an inspiring poem be composed by you?\n                                                    <input checked=\"checked\" class=\"question_options2\" name=\"selected_option_19\" type=\"radio\" value=\"495023_120327\"/>\n<span class=\"checkmark radio_check2\"></span>", "explanation": "C) Can an inspiring poem be composed by you? <br /> Active Voice को Passive Voice में बदलने के लिए (Modal Verb + Object + Be + Past Participle + by + Subject) का use किया जाता है। sentence ‘Can you compose an inspiring poem?’ को Passive Voice में बदलते समय Object ‘an inspiring poem’ को वाक्य की शुरुआत में रखा जाता है। Modal Verb ‘Can’ को वैसा ही रखा जाता है, और Verb ‘compose’ को Passive Voice में बदलकर ‘be composed’ किया जाता है। अंत में, Subject ‘you’ को ‘by you’ के रूप में जोड़ा जाता है। <br /> To convert Active Voice into Passive Voice with a modal verb, the structure (Modal Verb + Object + Be + Past Participle + by + Subject) is used. In the sentence ‘Can you compose an inspiring poem?’, the object ‘an inspiring poem’ is placed at the beginning. The modal verb ‘Can’ remains the same, and the verb ‘compose’ is changed to ‘be composed’ in Passive Voice. The subject ‘you’ is added at the end as ‘by you’. Therefore, the correct answer is (Can an inspiring poem be composed by you?).", "marks": {"positive": 2.0, "negative": 0.5}}]};

        // Test state variables
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let bookmarkedQuestions = new Set();
        let timerInterval;
        let isDarkMode = false;
        let visitedQuestions = new Set();

        // Initialize the test
        function initializeTest() {
            // Set test title
            document.getElementById('test-title').textContent = testData.test_info.title;
            
            // Initialize user answers array
            userAnswers = Array(testData.questions.length).fill(null);
            
            // Setup question palette
            setupQuestionPalette();
            
            // Setup timer
            setupTimer();
            
            // Show first question
            showQuestion(0);
            
            // Setup event listeners
            setupEventListeners();
            
            // Make sure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function setupEventListeners() {
            document.getElementById('prev-btn').addEventListener('click', goToPreviousQuestion);
            document.getElementById('next-btn').addEventListener('click', goToNextQuestion);
            document.getElementById('submit-test').addEventListener('click', showReviewWarning);
            document.getElementById('bookmark-btn').addEventListener('click', toggleBookmark);
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

            // Question palette toggle functionality
            document.getElementById('palette-toggle').addEventListener('click', toggleQuestionPalette);

            // Add keyboard event listener to document
            document.addEventListener('keydown', handleKeyPress);

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterQuestions(e.target.dataset.filter);
                });
            });
        }

        function toggleQuestionPalette() {
            const palette = document.querySelector('.question-palette');
            const toggleBtn = document.getElementById('palette-toggle');
            
            if (palette.classList.contains('visible')) {
                // Hide palette with animation
                palette.style.transform = 'translateX(100%)';
                toggleBtn.classList.remove('active');
                setTimeout(() => {
                    palette.classList.remove('visible');
                }, 300);
            } else {
                // Show palette with animation
                palette.classList.add('visible');
                toggleBtn.classList.add('active');
                setTimeout(() => {
                    palette.style.transform = 'translateX(0)';
                }, 10);
            }
        }

        // Add display flex to palette toggle button when in mobile view
        function updatePaletteToggleDisplay() {
            const toggleBtn = document.getElementById('palette-toggle');
            if (window.innerWidth <= 768) {
                toggleBtn.style.display = 'flex';
            } else {
                toggleBtn.style.display = 'none';
            }
        }

        // Call on load and window resize
        window.addEventListener('load', updatePaletteToggleDisplay);
        window.addEventListener('resize', updatePaletteToggleDisplay);

        function handleKeyPress(event) {
            console.log('Key pressed:', event.key); // Add debug logging
            
            // Ignore keyboard shortcuts if user is typing in an input field
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }

            // Ignore keyboard shortcuts if test is submitted
            if (document.getElementById('result').style.display === 'block') {
                return;
            }

            // Prevent default behavior for arrow keys and numbers to avoid page scrolling
            if (['ArrowLeft', 'ArrowRight', '1', '2', '3', '4'].includes(event.key)) {
                event.preventDefault();
            }

            switch(event.key) {
                case 'ArrowLeft':
                    if (currentQuestionIndex > 0) {
                        goToPreviousQuestion();
                    }
                    break;
                case 'ArrowRight':
                    if (currentQuestionIndex < testData.questions.length - 1) {
                        goToNextQuestion();
                    }
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
                case 'Enter':
                    if (currentQuestionIndex === testData.questions.length - 1) {
                        showReviewWarning();
                    } else {
                        goToNextQuestion();
                    }
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                    const optionIndex = parseInt(event.key) - 1;
                    const options = document.querySelectorAll('.option');
                    if (options[optionIndex]) {
                        // Add visual feedback for option selection
                        options[optionIndex].classList.add('keyboard-selected');
                        
                        // Actually select the option
                        const radio = options[optionIndex].querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            userAnswers[currentQuestionIndex] = optionIndex + 1;
                            
                            // Update the option's visual state
                            options.forEach(opt => opt.classList.remove('selected'));
                            options[optionIndex].classList.add('selected');
                            
                            // Update the question palette
                            updateQuestionPalette();
                        }
                        
                        // Remove the selection effect after animation
                        setTimeout(() => {
                            options[optionIndex].classList.remove('keyboard-selected');
                        }, 200);
                    }
                    break;
            }
        }

        function setupQuestionPalette() {
            const palette = document.getElementById('question-palette');
            palette.innerHTML = '';
            
            for (let i = 0; i < testData.questions.length; i++) {
                const item = document.createElement('div');
                item.className = 'palette-item not-visited';
                item.textContent = i + 1;
                item.addEventListener('click', () => {
                    showQuestion(i);
                    // Close the palette if it's currently visible (for mobile view)
                    const paletteElement = document.querySelector('.question-palette');
                    if (paletteElement.classList.contains('visible')) {
                        toggleQuestionPalette();
                    }
                });
                palette.appendChild(item);
            }
            
            // Ensure palette toggle button is visible on mobile
            updatePaletteToggleDisplay();
        }

        function updateQuestionPalette() {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                item.className = 'palette-item';
                
                // Only add status classes if the question has been visited
                if (visitedQuestions.has(index)) {
                    if (bookmarkedQuestions.has(index)) {
                        item.classList.add('marked-review');
                    } else if (userAnswers[index] !== null) {
                        item.classList.add('answered');
                    } else {
                        item.classList.add('not-answered');
                    }
                } else {
                    item.classList.add('not-visited');
                }
                
                if (index === currentQuestionIndex) {
                    item.classList.add('active');
                }
            });
        }

        function filterQuestions(filter) {
            const items = document.querySelectorAll('.palette-item');
            items.forEach((item, index) => {
                const isMarkedReview = bookmarkedQuestions.has(index);
                const isAnswered = userAnswers[index] !== null;
                const isVisited = visitedQuestions.has(index);
                
                switch(filter) {
                    case 'answered':
                        item.style.display = isAnswered ? 'flex' : 'none';
                        break;
                    case 'not-answered':
                        item.style.display = (isVisited && !isAnswered) ? 'flex' : 'none';
                        break;
                    case 'marked-review':
                        item.style.display = isMarkedReview ? 'flex' : 'none';
                        break;
                    default:
                        item.style.display = 'flex';
                }
            });
        }
        
        function setupTimer() {
            const duration = parseFloat(testData.test_info.duration);
            let timeLeft = Math.floor(duration * 60);
            const timerElement = document.getElementById('timer');
            
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                if (timeLeft <= 300) { // 5 minutes warning
                    timerElement.classList.add('timer-warning');
                }
                
                timerElement.innerHTML = `
                    <i class="fas fa-clock"></i>
                    Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}
                `;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest();
                }
                
                timeLeft--;
            }, 1000);
        }
        
        function showQuestion(index) {
            currentQuestionIndex = index;
            // Mark question as visited when opened
            visitedQuestions.add(index);
            const question = testData.questions[index];
            const container = document.getElementById('current-question');
            
            // Add fade-out animation
            container.style.opacity = '0';
            container.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                container.innerHTML = `
                    <div class="question-container">
                        <div class="question-number">
                            <span>Question ${question.question_number} of ${testData.questions.length}</span>
                            <span class="marks-info">
                                <i class="fas fa-plus-circle"></i> ${question.marks.positive}
                                <i class="fas fa-minus-circle"></i> ${question.marks.negative}
                            </span>
                        </div>
                        <div class="question">${question.question_text}</div>
                        <div class="options">
                            ${question.options.map((option, optIndex) => `
                                <label class="option ${userAnswers[index] === optIndex + 1 ? 'selected' : ''}">
                                    <input type="radio" name="question${index}" value="${optIndex + 1}" 
                                        ${userAnswers[index] === optIndex + 1 ? 'checked' : ''}>
                                        <div class="option-content">
                                    <span class="option-number">${optIndex + 1}</span> ${option}
                                        </div>
                                </label>
                            `).join('')}
                        </div>
                        <div style="flex-grow: 1;"></div>
                    </div>
                `;
                
                // Update bookmark button
                const bookmarkBtn = document.getElementById('bookmark-btn');
                bookmarkBtn.classList.toggle('active', bookmarkedQuestions.has(index));
                bookmarkBtn.innerHTML = bookmarkedQuestions.has(index) 
                    ? '<i class="fas fa-flag"></i> Marked for Review'
                    : '<i class="far fa-flag"></i> Mark for Review <span class="shortcut-hint">(B)</span>';
                
                // Add event listeners to options
                const options = container.querySelectorAll('.option');
                    options.forEach((option, optIdx) => {
                    option.addEventListener('click', function() {
                        const radio = this.querySelector('input[type="radio"]');
                        radio.checked = true;
                        
                            options.forEach(opt => {
                                opt.classList.remove('selected');
                                opt.style.transform = 'translateX(0)';
                            });
                            
                            // Animate the selected option
                        this.classList.add('selected');
                            this.style.transform = 'translateX(10px)';
                        
                        userAnswers[index] = parseInt(radio.value);
                        updateQuestionPalette();

                            // Highlight the option number with a pulse animation
                        const optionNumber = this.querySelector('.option-number');
                        optionNumber.style.animation = 'pulse 0.5s ease';
                        setTimeout(() => {
                            optionNumber.style.animation = '';
                        }, 500);
                });

                        // Add a small delay to each option's appearance
                        option.style.opacity = '0';
                        option.style.transform = 'translateX(20px)';
                        setTimeout(() => {
                            option.style.opacity = '1';
                            option.style.transform = 'translateX(0)';
                        }, 100 + (optIdx * 50));
                    });
                    
                    // Fade in the content
                    setTimeout(() => {
                        container.style.opacity = '1';
                        container.style.transform = 'translateY(0)';
                    }, 50);
                
                // Update navigation buttons
                updateNavigationButtons();
                
                // Update question palette
                updateQuestionPalette();
                }, 150);
        }
        
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-test');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === testData.questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }
        
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        }
        
        function goToNextQuestion() {
            if (currentQuestionIndex < testData.questions.length - 1) {
                showQuestion(currentQuestionIndex + 1);
            }
        }

        function toggleBookmark() {
            const btn = document.getElementById('bookmark-btn');
            if (bookmarkedQuestions.has(currentQuestionIndex)) {
                bookmarkedQuestions.delete(currentQuestionIndex);
                btn.classList.remove('active');
                btn.innerHTML = `
                    <i class="far fa-flag"></i> 
                    Mark for Review <span class="shortcut-hint">(B)</span>
                `;
            } else {
                bookmarkedQuestions.add(currentQuestionIndex);
                btn.classList.add('active');
                btn.innerHTML = `
                    <i class="fas fa-flag"></i> 
                    Marked for Review
                `;
            }
            updateQuestionPalette();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.innerHTML = `<i class="fas fa-${isDarkMode ? 'sun' : 'moon'}"></i>`;
        }

        function showReviewWarning() {
            // Skip the warning and directly submit the test
            submitTest();
        }
        
        function submitTest() {
            // Add submission animation
            const testContainer = document.getElementById('test-container');
            const questionPalette = document.querySelector('.question-palette');
            const resultContainer = document.getElementById('result');
            
            // Animate test container sliding out
            testContainer.style.transition = 'all 0.5s var(--animation-bounce)';
            testContainer.style.transform = 'translateX(-50px)';
            testContainer.style.opacity = '0';
            
            // Animate question palette fading out
            questionPalette.style.transition = 'all 0.5s var(--animation-bounce)';
            questionPalette.style.transform = 'translateX(50px)';
            questionPalette.style.opacity = '0';
            
            // Clear the timer
            clearInterval(timerInterval);
            
            // Calculate results with a slight delay for animation
            setTimeout(() => {
            let score = 0;
            let correctCount = 0;
            let attemptedCount = 0;
            const reviewAnswers = [];
            
            // Calculate score and statistics
            testData.questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct_answer;
                
                if (userAnswer !== null) {
                    attemptedCount++;
                    if (isCorrect) {
                        score += question.marks.positive;
                        correctCount++;
                    } else {
                        score -= question.marks.negative;
                    }
                }
                
                reviewAnswers.push({
                    questionNumber: question.question_number,
                    questionText: question.question_text,
                    userChoice: userAnswer,
                    userChoiceText: userAnswer !== null ? question.options[userAnswer - 1] : 'Not answered',
                    correctAnswer: question.correct_answer,
                    correctAnswerText: question.correct_option,
                    isCorrect: isCorrect,
                    answered: userAnswer !== null
                });
            });
            
            // Update statistics
            document.getElementById('total-questions').textContent = testData.questions.length;
            document.getElementById('attempted-questions').textContent = attemptedCount;
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('accuracy').textContent = 
                `${Math.round((correctCount / (attemptedCount || 1)) * 100)}%`;
            
            // Display score
            document.getElementById('score').innerHTML = `
                <div style="font-size: 36px; color: var(--primary-color);">
                    ${score.toFixed(2)} / ${testData.questions.length * testData.questions[0].marks.positive}
                </div>
                <div style="color: var(--text-color); margin-top: 10px;">
                    Percentage: ${Math.round((score / (testData.questions.length * testData.questions[0].marks.positive)) * 100)}%
                </div>
            `;
            
            // Create performance chart
            const chartContainer = document.getElementById('performance-chart');
            chartContainer.innerHTML = ''; // Clear previous chart if any
            const ctx = document.createElement('canvas');
            chartContainer.appendChild(ctx);
                
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Correct', 'Incorrect', 'Not Attempted'],
                    datasets: [{
                        data: [
                            correctCount,
                            attemptedCount - correctCount,
                            testData.questions.length - attemptedCount
                        ],
                        backgroundColor: [
                                '#16a34a', // Fixed success green
                                '#dc2626', // Fixed error red
                                '#8b5cf6'  // Fixed purple for not attempted
                        ],
                            borderColor: 'var(--bg-color)',
                        borderWidth: 2,
                            hoverOffset: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'var(--bg-color)',
                                titleColor: 'var(--text-color)',
                                bodyColor: 'var(--text-color)',
                                borderColor: 'var(--border-color)',
                                borderWidth: 1,
                                padding: 12,
                                boxPadding: 6,
                                usePointStyle: true,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        let value = context.raw || 0;
                                        let total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        let percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            },
                            title: {
                                display: true,
                                text: 'Test Performance',
                                color: 'var(--text-color)',
                                font: {
                                    family: 'Inter, sans-serif',
                                    size: 16,
                                    weight: '600'
                                },
                                padding: {
                                    bottom: 15
                            }
                        }
                    },
                    cutout: '65%',
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                            duration: 1500,
                            easing: 'easeOutQuart'
                    }
                }
            });
                
                // Replace the chart's built-in legend with a custom one
                const customLegend = document.createElement('div');
                customLegend.className = 'custom-chart-legend';

                chartContainer.appendChild(customLegend);
            
            // Update the analytics container title
            document.querySelector('.analytics-container h3').innerHTML = 
                '<i class="fas fa-chart-pie"></i> Performance Analysis';
            
            // Add event listener to the download analysis buttons with a small delay to ensure UI is ready
            setTimeout(() => {
                const downloadBtn = document.getElementById('download-analysis');
                const bottomDownloadBtn = document.getElementById('bottom-download-analysis');
                if (downloadBtn) {
                    downloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
                if (bottomDownloadBtn) {
                    bottomDownloadBtn.addEventListener('click', function() {
                        downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount);
                    });
                }
            }, 500);
            
            // Fix any palette toggle issue
            if (window.innerWidth <= 768) {
                const paletteToggle = document.getElementById('palette-toggle');
                if (paletteToggle) {
                    paletteToggle.style.display = 'flex';
                }
                
                // Add close button to palette if not exists
                const palette = document.querySelector('.question-palette');
                if (palette && !document.querySelector('.palette-close-btn')) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'palette-close-btn';
                    closeBtn.innerHTML = '<i class="fas fa-times"></i>';
                    closeBtn.addEventListener('click', toggleQuestionPalette);
                    
                    const paletteHeader = palette.querySelector('.palette-header');
                    if (paletteHeader) {
                        paletteHeader.appendChild(closeBtn);
                    }
                }
            }
            
                // Display answer review with staggered animation
            const answersDiv = document.getElementById('answers');
            answersDiv.innerHTML = '<h3>Answer Review:</h3>';
            
                reviewAnswers.forEach((answer, idx) => {
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-review';
                    answerDiv.style.opacity = '0';
                    answerDiv.style.transform = 'translateY(20px)';
                
                answerDiv.innerHTML = `
                    <p><strong>Question ${answer.questionNumber}:</strong> ${answer.questionText}</p>
                    <p class="${answer.answered ? (answer.isCorrect ? 'correct' : 'incorrect') : ''}">
                        Your answer: ${answer.userChoiceText}
                        ${answer.isCorrect ? '<i class="fas fa-check"></i>' : 
                        (answer.answered ? '<i class="fas fa-times"></i>' : '')}
                    </p>
                    ${!answer.isCorrect ? `
                        <p class="correct">
                            Correct answer: ${answer.correctAnswerText}
                            <i class="fas fa-check"></i>
                        </p>
                    ` : ''}
                    ${testData.questions[idx].explanation ? `
                        <div class="explanation">
                            <p><strong>Explanation:</strong></p>
                            <p>${testData.questions[idx].explanation}</p>
                        </div>
                    ` : ''}
                `;
                
                answersDiv.appendChild(answerDiv);
                    
                    // Animate each answer review with a staggered delay
                    setTimeout(() => {
                        answerDiv.style.transition = 'all 0.5s var(--animation-bounce)';
                        answerDiv.style.opacity = '1';
                        answerDiv.style.transform = 'translateY(0)';
                    }, 200 + (idx * 100));
                });
                
                // Show results container with animation
                resultContainer.style.display = 'block';
                resultContainer.style.opacity = '0';
                resultContainer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultContainer.style.transition = 'all 0.6s var(--animation-bounce)';
                    resultContainer.style.opacity = '1';
                    resultContainer.style.transform = 'translateY(0)';
                }, 100);
                
                // Hide test components
                testContainer.style.display = 'none';
                questionPalette.style.display = 'none';
                document.getElementById('palette-toggle').style.display = 'none';
            }, 600);
        }
        
        // Initialize the test
        initializeTest();

        // Add CSS transitions to the current-question container
        document.addEventListener('DOMContentLoaded', function() {
            const currentQuestion = document.getElementById('current-question');
            currentQuestion.style.transition = 'opacity 0.3s ease, transform 0.3s var(--animation-bounce)';
        });

        // Add CSS for smooth palette transitions
        document.addEventListener('DOMContentLoaded', function() {
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .question-palette {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                #palette-toggle {
                    transition: transform 0.3s var(--animation-bounce);
                }
                
                @media (max-width: 768px) {
                    .question-container:hover {
                        transform: translateY(-2px);
                    }
                    
                    .score-card:hover {
                        transform: translateY(-4px);
                    }
                    
                    .option:hover {
                        transform: translateX(4px);
                    }
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Add this after the Chart.js script tag but before your testData declaration
        document.addEventListener('DOMContentLoaded', function() {
            // Add custom styling for chart legend
            const styleElement = document.createElement('style');
            styleElement.textContent = `
                .chart-legend-item {
                    display: flex;
                    align-items: center;
                    margin: 8px 0;
                    font-weight: 600;
                }
                
                .legend-color {
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    margin-right: 8px;
                    display: inline-block;
                }
                
                .legend-correct {
                    background-color: #16a34a;
                }
                
                .legend-incorrect {
                    background-color: #dc2626;
                }
                
                .legend-not-attempted {
                    background-color: #8b5cf6;
                }
                
                .custom-chart-legend {
                    display: flex;
                    justify-content: center;
                    gap: 15px;
                    margin-top: 15px;
                    flex-wrap: wrap;
                }
                
                [data-theme="dark"] .legend-text {
                    color: #f1f5f9;
                }
                
                .chart-container canvas {
                    margin-bottom: 10px;
                }
            `;
            document.head.appendChild(styleElement);
        });

        // Function to download test analysis as HTML file
        function downloadAnalysis(testData, reviewAnswers, score, correctCount, attemptedCount) {
            const maxScore = testData.questions.length * testData.questions[0].marks.positive;
            const percentage = Math.round((score / maxScore) * 100);

            // Create HTML content
            let htmlContent = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Test Analysis - ${testData.test_info.title}</title>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
                <style>
                    body {
                        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                        max-width: 900px;
                        margin: 0 auto;
                        padding: 20px;
                        color: #1e293b;
                        background-color: #f8fafc;
                        line-height: 1.6;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 15px;
                    }
                    .header h1 {
                        color: #4f46e5;
                        margin-bottom: 5px;
                    }
                    .header .date {
                        font-style: italic;
                        color: #64748b;
                    }
                    .summary {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                        gap: 20px;
                        margin-bottom: 30px;
                    }
                    .summary-card {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 15px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        text-align: center;
                        border: 1px solid #e2e8f0;
                    }
                    .summary-card h3 {
                        margin-top: 0;
                        margin-bottom: 10px;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .summary-card .value {
                        font-size: 24px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight {
                        background-color: #f3f4f6;
                        padding: 30px;
                        border-radius: 8px;
                        text-align: center;
                        margin-bottom: 30px;
                        border: 1px solid #e5e7eb;
                    }
                    .score-highlight .score {
                        font-size: 48px;
                        font-weight: bold;
                        color: #4f46e5;
                    }
                    .score-highlight .percentage {
                        font-size: 18px;
                        color: #64748b;
                    }
                    .question-review {
                        margin-bottom: 30px;
                    }
                    .question {
                        background-color: #ffffff;
                        border-radius: 8px;
                        padding: 20px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        margin-bottom: 15px;
                        border: 1px solid #e2e8f0;
                    }
                    .question-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 10px;
                        padding-bottom: 10px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .question-text {
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer {
                        margin-bottom: 5px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .user-answer.correct {
                        color: #16a34a;
                    }
                    .user-answer.incorrect {
                        color: #dc2626;
                    }
                    .correct-answer {
                        color: #16a34a;
                        margin-bottom: 15px;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation {
                        background-color: #f8fafc;
                        padding: 15px;
                        border-radius: 8px;
                        border-left: 4px solid #4f46e5;
                        word-break: break-word; /* Ensures text doesn't overflow */
                    }
                    .explanation-title {
                        font-weight: bold;
                        margin-bottom: 5px;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 40px;
                        padding-top: 20px;
                        border-top: 1px solid #e2e8f0;
                        color: #64748b;
                        font-size: 14px;
                    }
                    .unattempted {
                        color: #8b5cf6;
                    }
                    @media print {
                        body {
                            background-color: white;
                        }
                        .question, .summary-card, .score-highlight {
                            break-inside: avoid;
                        }
                    }
                    /* Responsive fixes */
                    @media (max-width: 768px) {
                        body {
                            padding: 10px;
                        }
                        .summary {
                            grid-template-columns: 1fr;
                        }
                        .score-highlight .score {
                            font-size: 36px;
                        }
                        .question-header {
                            flex-direction: column;
                            align-items: flex-start;
                        }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>${testData.test_info.title}</h1>
                    <div class="date">Generated on: ${new Date().toLocaleString()}</div>
                </div>
                
                <div class="score-highlight">
                    <div class="score">${score.toFixed(2)} / ${maxScore}</div>
                    <div class="percentage">Percentage: ${percentage}%</div>
                </div>
                
                <div class="summary">
                    <div class="summary-card">
                        <h3>Total Questions</h3>
                        <div class="value">${testData.questions.length}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Attempted</h3>
                        <div class="value">${attemptedCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Correct</h3>
                        <div class="value">${correctCount}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Accuracy</h3>
                        <div class="value">${Math.round((correctCount / (attemptedCount || 1)) * 100)}%</div>
                    </div>
                </div>
                
                <h2>Question Review</h2>
                <div class="question-review">
            `;

            // Add each question and answer to the HTML content
            reviewAnswers.forEach((answer, idx) => {
                const question = testData.questions[idx];
                htmlContent += `
                    <div class="question">
                        <div class="question-header">
                            <strong>Question ${answer.questionNumber}</strong>
                            <span>${answer.isCorrect ? '+' : (answer.answered ? '-' : '0')}${question.marks.positive} marks</span>
                        </div>
                        <div class="question-text">${answer.questionText}</div>
                        <div class="user-answer ${answer.isCorrect ? 'correct' : (answer.answered ? 'incorrect' : 'unattempted')}">
                            <strong>${answer.answered ? 'Your answer: ' : 'Not attempted'}</strong> 
                            ${answer.answered ? answer.userChoiceText : ''}
                            ${answer.isCorrect ? ' ✓' : (answer.answered ? ' ✗' : '')}
                        </div>
                        ${!answer.isCorrect ? `
                            <div class="correct-answer">
                                <strong>Correct answer:</strong> ${answer.correctAnswerText}
                            </div>
                        ` : ''}
                        ${question.explanation ? `
                            <div class="explanation">
                                <div class="explanation-title">Explanation:</div>
                                <div>${question.explanation}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            // Close HTML content
            htmlContent += `
                </div>
                
                <div class="footer">
                    <p>&copy; 2025 KUNAL Test Platform. All rights reserved.</p>
                    <p>Created by @finallygotnirvana</p>
                </div>
            </body>
            </html>
            `;

            // Create a download link
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            
            // Format date for filename
            const date = new Date();
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            
            downloadLink.download = `Test_Analysis_${formattedDate}.html`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }

        document.addEventListener('keydown', function(e) {
            // Prevent default behavior for arrow keys
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight' || e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
            }

            switch(e.key) {
                case 'ArrowLeft':
                    goToPreviousQuestion();
                    break;
                case 'ArrowRight':
                    goToNextQuestion();
                    break;
                case 'ArrowUp':
                case 'ArrowDown':
                    // Get all options for the current question
                    const options = document.querySelectorAll('.option');
                    if (options.length === 0) return;

                    // Find currently selected option
                    let currentIndex = Array.from(options).findIndex(opt => opt.classList.contains('selected'));
                    
                    // Calculate new index
                    if (e.key === 'ArrowUp') {
                        currentIndex = currentIndex <= 0 ? options.length - 1 : currentIndex - 1;
                    } else {
                        currentIndex = currentIndex >= options.length - 1 ? 0 : currentIndex + 1;
                    }

                    // Select the new option
                    options.forEach(opt => opt.classList.remove('selected'));
                    options[currentIndex].classList.add('selected');
                    options[currentIndex].querySelector('input[type="radio"]').checked = true;
                    
                    // Update user answer
                    userAnswers[currentQuestionIndex] = currentIndex + 1;
                    updateQuestionPalette();
                    break;
                case 'b':
                case 'B':
                    toggleBookmark();
                    break;
            }
        });
    </script>
</body>
</html>
